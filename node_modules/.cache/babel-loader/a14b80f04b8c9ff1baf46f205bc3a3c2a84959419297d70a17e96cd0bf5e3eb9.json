{"ast":null,"code":"/*!\n * FilePondPluginImageTransform 3.8.7\n * Licensed under MIT, https://opensource.org/licenses/MIT/\n * Please visit https://pqina.nl/filepond/ for details.\n */\n\n/* eslint-disable */\n\n(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() : typeof define === 'function' && define.amd ? define(factory) : (global = global || self, global.FilePondPluginImageTransform = factory());\n})(this, function () {\n  'use strict';\n\n  // test if file is of type image\n  var isImage = function isImage(file) {\n    return /^image/.test(file.type);\n  };\n  var getFilenameWithoutExtension = function getFilenameWithoutExtension(name) {\n    return name.substr(0, name.lastIndexOf('.')) || name;\n  };\n\n  // only handles image/jpg, image/jpeg, image/png, and image/svg+xml for now\n  var ExtensionMap = {\n    jpeg: 'jpg',\n    'svg+xml': 'svg'\n  };\n  var renameFileToMatchMimeType = function renameFileToMatchMimeType(filename, mimeType) {\n    var name = getFilenameWithoutExtension(filename);\n    var type = mimeType.split('/')[1];\n    var extension = ExtensionMap[type] || type;\n    return ''.concat(name, '.').concat(extension);\n  };\n\n  // returns all the valid output formats we can encode towards\n  var getValidOutputMimeType = function getValidOutputMimeType(type) {\n    return /jpeg|png|svg\\+xml/.test(type) ? type : 'image/jpeg';\n  };\n\n  // test if file is of type image\n  var isImage$1 = function isImage(file) {\n    return /^image/.test(file.type);\n  };\n  var MATRICES = {\n    1: function _() {\n      return [1, 0, 0, 1, 0, 0];\n    },\n    2: function _(width) {\n      return [-1, 0, 0, 1, width, 0];\n    },\n    3: function _(width, height) {\n      return [-1, 0, 0, -1, width, height];\n    },\n    4: function _(width, height) {\n      return [1, 0, 0, -1, 0, height];\n    },\n    5: function _() {\n      return [0, 1, 1, 0, 0, 0];\n    },\n    6: function _(width, height) {\n      return [0, 1, -1, 0, height, 0];\n    },\n    7: function _(width, height) {\n      return [0, -1, -1, 0, height, width];\n    },\n    8: function _(width) {\n      return [0, -1, 1, 0, 0, width];\n    }\n  };\n  var getImageOrientationMatrix = function getImageOrientationMatrix(width, height, orientation) {\n    if (orientation === -1) {\n      orientation = 1;\n    }\n    return MATRICES[orientation](width, height);\n  };\n  var createVector = function createVector(x, y) {\n    return {\n      x: x,\n      y: y\n    };\n  };\n  var vectorDot = function vectorDot(a, b) {\n    return a.x * b.x + a.y * b.y;\n  };\n  var vectorSubtract = function vectorSubtract(a, b) {\n    return createVector(a.x - b.x, a.y - b.y);\n  };\n  var vectorDistanceSquared = function vectorDistanceSquared(a, b) {\n    return vectorDot(vectorSubtract(a, b), vectorSubtract(a, b));\n  };\n  var vectorDistance = function vectorDistance(a, b) {\n    return Math.sqrt(vectorDistanceSquared(a, b));\n  };\n  var getOffsetPointOnEdge = function getOffsetPointOnEdge(length, rotation) {\n    var a = length;\n    var A = 1.5707963267948966;\n    var B = rotation;\n    var C = 1.5707963267948966 - rotation;\n    var sinA = Math.sin(A);\n    var sinB = Math.sin(B);\n    var sinC = Math.sin(C);\n    var cosC = Math.cos(C);\n    var ratio = a / sinA;\n    var b = ratio * sinB;\n    var c = ratio * sinC;\n    return createVector(cosC * b, cosC * c);\n  };\n  var getRotatedRectSize = function getRotatedRectSize(rect, rotation) {\n    var w = rect.width;\n    var h = rect.height;\n    var hor = getOffsetPointOnEdge(w, rotation);\n    var ver = getOffsetPointOnEdge(h, rotation);\n    var tl = createVector(rect.x + Math.abs(hor.x), rect.y - Math.abs(hor.y));\n    var tr = createVector(rect.x + rect.width + Math.abs(ver.y), rect.y + Math.abs(ver.x));\n    var bl = createVector(rect.x - Math.abs(ver.y), rect.y + rect.height - Math.abs(ver.x));\n    return {\n      width: vectorDistance(tl, tr),\n      height: vectorDistance(tl, bl)\n    };\n  };\n  var getImageRectZoomFactor = function getImageRectZoomFactor(imageRect, cropRect) {\n    var rotation = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n    var center = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {\n      x: 0.5,\n      y: 0.5\n    };\n\n    // calculate available space round image center position\n    var cx = center.x > 0.5 ? 1 - center.x : center.x;\n    var cy = center.y > 0.5 ? 1 - center.y : center.y;\n    var imageWidth = cx * 2 * imageRect.width;\n    var imageHeight = cy * 2 * imageRect.height;\n\n    // calculate rotated crop rectangle size\n    var rotatedCropSize = getRotatedRectSize(cropRect, rotation);\n    return Math.max(rotatedCropSize.width / imageWidth, rotatedCropSize.height / imageHeight);\n  };\n  var getCenteredCropRect = function getCenteredCropRect(container, aspectRatio) {\n    var width = container.width;\n    var height = width * aspectRatio;\n    if (height > container.height) {\n      height = container.height;\n      width = height / aspectRatio;\n    }\n    var x = (container.width - width) * 0.5;\n    var y = (container.height - height) * 0.5;\n    return {\n      x: x,\n      y: y,\n      width: width,\n      height: height\n    };\n  };\n  var calculateCanvasSize = function calculateCanvasSize(image, canvasAspectRatio) {\n    var zoom = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 1;\n    var imageAspectRatio = image.height / image.width;\n\n    // determine actual pixels on x and y axis\n    var canvasWidth = 1;\n    var canvasHeight = canvasAspectRatio;\n    var imgWidth = 1;\n    var imgHeight = imageAspectRatio;\n    if (imgHeight > canvasHeight) {\n      imgHeight = canvasHeight;\n      imgWidth = imgHeight / imageAspectRatio;\n    }\n    var scalar = Math.max(canvasWidth / imgWidth, canvasHeight / imgHeight);\n    var width = image.width / (zoom * scalar * imgWidth);\n    var height = width * canvasAspectRatio;\n    return {\n      width: width,\n      height: height\n    };\n  };\n  var canvasRelease = function canvasRelease(canvas) {\n    canvas.width = 1;\n    canvas.height = 1;\n    var ctx = canvas.getContext('2d');\n    ctx.clearRect(0, 0, 1, 1);\n  };\n  var isFlipped = function isFlipped(flip) {\n    return flip && (flip.horizontal || flip.vertical);\n  };\n  var getBitmap = function getBitmap(image, orientation, flip) {\n    if (orientation <= 1 && !isFlipped(flip)) {\n      image.width = image.naturalWidth;\n      image.height = image.naturalHeight;\n      return image;\n    }\n    var canvas = document.createElement('canvas');\n    var width = image.naturalWidth;\n    var height = image.naturalHeight;\n\n    // if is rotated incorrectly swap width and height\n    var swapped = orientation >= 5 && orientation <= 8;\n    if (swapped) {\n      canvas.width = height;\n      canvas.height = width;\n    } else {\n      canvas.width = width;\n      canvas.height = height;\n    }\n\n    // draw the image but first fix orientation and set correct flip\n    var ctx = canvas.getContext('2d');\n\n    // get base transformation matrix\n    if (orientation) {\n      ctx.transform.apply(ctx, getImageOrientationMatrix(width, height, orientation));\n    }\n    if (isFlipped(flip)) {\n      // flip horizontal\n      // [-1, 0, 0, 1, width, 0]\n      var matrix = [1, 0, 0, 1, 0, 0];\n      if (!swapped && flip.horizontal || swapped & flip.vertical) {\n        matrix[0] = -1;\n        matrix[4] = width;\n      }\n\n      // flip vertical\n      // [1, 0, 0, -1, 0, height]\n      if (!swapped && flip.vertical || swapped && flip.horizontal) {\n        matrix[3] = -1;\n        matrix[5] = height;\n      }\n      ctx.transform.apply(ctx, matrix);\n    }\n    ctx.drawImage(image, 0, 0, width, height);\n    return canvas;\n  };\n  var imageToImageData = function imageToImageData(imageElement, orientation) {\n    var crop = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n    var canvasMemoryLimit = options.canvasMemoryLimit,\n      _options$background = options.background,\n      background = _options$background === void 0 ? null : _options$background;\n    var zoom = crop.zoom || 1;\n\n    // fixes possible image orientation problems by drawing the image on the correct canvas\n    var bitmap = getBitmap(imageElement, orientation, crop.flip);\n    var imageSize = {\n      width: bitmap.width,\n      height: bitmap.height\n    };\n    var aspectRatio = crop.aspectRatio || imageSize.height / imageSize.width;\n    var canvasSize = calculateCanvasSize(imageSize, aspectRatio, zoom);\n    if (canvasMemoryLimit) {\n      var requiredMemory = canvasSize.width * canvasSize.height;\n      if (requiredMemory > canvasMemoryLimit) {\n        var scalar = Math.sqrt(canvasMemoryLimit) / Math.sqrt(requiredMemory);\n        imageSize.width = Math.floor(imageSize.width * scalar);\n        imageSize.height = Math.floor(imageSize.height * scalar);\n        canvasSize = calculateCanvasSize(imageSize, aspectRatio, zoom);\n      }\n    }\n    var canvas = document.createElement('canvas');\n    var canvasCenter = {\n      x: canvasSize.width * 0.5,\n      y: canvasSize.height * 0.5\n    };\n    var stage = {\n      x: 0,\n      y: 0,\n      width: canvasSize.width,\n      height: canvasSize.height,\n      center: canvasCenter\n    };\n    var shouldLimit = typeof crop.scaleToFit === 'undefined' || crop.scaleToFit;\n    var scale = zoom * getImageRectZoomFactor(imageSize, getCenteredCropRect(stage, aspectRatio), crop.rotation, shouldLimit ? crop.center : {\n      x: 0.5,\n      y: 0.5\n    });\n\n    // start drawing\n    canvas.width = Math.round(canvasSize.width / scale);\n    canvas.height = Math.round(canvasSize.height / scale);\n    canvasCenter.x /= scale;\n    canvasCenter.y /= scale;\n    var imageOffset = {\n      x: canvasCenter.x - imageSize.width * (crop.center ? crop.center.x : 0.5),\n      y: canvasCenter.y - imageSize.height * (crop.center ? crop.center.y : 0.5)\n    };\n    var ctx = canvas.getContext('2d');\n    if (background) {\n      ctx.fillStyle = background;\n      ctx.fillRect(0, 0, canvas.width, canvas.height);\n    }\n\n    // move to draw offset\n    ctx.translate(canvasCenter.x, canvasCenter.y);\n    ctx.rotate(crop.rotation || 0);\n\n    // draw the image\n    ctx.drawImage(bitmap, imageOffset.x - canvasCenter.x, imageOffset.y - canvasCenter.y, imageSize.width, imageSize.height);\n\n    // get data from canvas\n    var imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);\n\n    // release canvas\n    canvasRelease(canvas);\n\n    // return data\n    return imageData;\n  };\n\n  /**\n   * Polyfill toBlob for Edge\n   */\n  var IS_BROWSER = function () {\n    return typeof window !== 'undefined' && typeof window.document !== 'undefined';\n  }();\n  if (IS_BROWSER) {\n    if (!HTMLCanvasElement.prototype.toBlob) {\n      Object.defineProperty(HTMLCanvasElement.prototype, 'toBlob', {\n        value: function value(callback, type, quality) {\n          var dataURL = this.toDataURL(type, quality).split(',')[1];\n          setTimeout(function () {\n            var binStr = atob(dataURL);\n            var len = binStr.length;\n            var arr = new Uint8Array(len);\n            for (var i = 0; i < len; i++) {\n              arr[i] = binStr.charCodeAt(i);\n            }\n            callback(new Blob([arr], {\n              type: type || 'image/png'\n            }));\n          });\n        }\n      });\n    }\n  }\n  var canvasToBlob = function canvasToBlob(canvas, options) {\n    var beforeCreateBlob = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n    return new Promise(function (resolve) {\n      var promisedImage = beforeCreateBlob ? beforeCreateBlob(canvas) : canvas;\n      Promise.resolve(promisedImage).then(function (canvas) {\n        canvas.toBlob(resolve, options.type, options.quality);\n      });\n    });\n  };\n  var vectorMultiply = function vectorMultiply(v, amount) {\n    return createVector$1(v.x * amount, v.y * amount);\n  };\n  var vectorAdd = function vectorAdd(a, b) {\n    return createVector$1(a.x + b.x, a.y + b.y);\n  };\n  var vectorNormalize = function vectorNormalize(v) {\n    var l = Math.sqrt(v.x * v.x + v.y * v.y);\n    if (l === 0) {\n      return {\n        x: 0,\n        y: 0\n      };\n    }\n    return createVector$1(v.x / l, v.y / l);\n  };\n  var vectorRotate = function vectorRotate(v, radians, origin) {\n    var cos = Math.cos(radians);\n    var sin = Math.sin(radians);\n    var t = createVector$1(v.x - origin.x, v.y - origin.y);\n    return createVector$1(origin.x + cos * t.x - sin * t.y, origin.y + sin * t.x + cos * t.y);\n  };\n  var createVector$1 = function createVector() {\n    var x = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n    var y = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n    return {\n      x: x,\n      y: y\n    };\n  };\n  var getMarkupValue = function getMarkupValue(value, size) {\n    var scalar = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 1;\n    var axis = arguments.length > 3 ? arguments[3] : undefined;\n    if (typeof value === 'string') {\n      return parseFloat(value) * scalar;\n    }\n    if (typeof value === 'number') {\n      return value * (axis ? size[axis] : Math.min(size.width, size.height));\n    }\n    return;\n  };\n  var getMarkupStyles = function getMarkupStyles(markup, size, scale) {\n    var lineStyle = markup.borderStyle || markup.lineStyle || 'solid';\n    var fill = markup.backgroundColor || markup.fontColor || 'transparent';\n    var stroke = markup.borderColor || markup.lineColor || 'transparent';\n    var strokeWidth = getMarkupValue(markup.borderWidth || markup.lineWidth, size, scale);\n    var lineCap = markup.lineCap || 'round';\n    var lineJoin = markup.lineJoin || 'round';\n    var dashes = typeof lineStyle === 'string' ? '' : lineStyle.map(function (v) {\n      return getMarkupValue(v, size, scale);\n    }).join(',');\n    var opacity = markup.opacity || 1;\n    return {\n      'stroke-linecap': lineCap,\n      'stroke-linejoin': lineJoin,\n      'stroke-width': strokeWidth || 0,\n      'stroke-dasharray': dashes,\n      stroke: stroke,\n      fill: fill,\n      opacity: opacity\n    };\n  };\n  var isDefined = function isDefined(value) {\n    return value != null;\n  };\n  var getMarkupRect = function getMarkupRect(rect, size) {\n    var scalar = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 1;\n    var left = getMarkupValue(rect.x, size, scalar, 'width') || getMarkupValue(rect.left, size, scalar, 'width');\n    var top = getMarkupValue(rect.y, size, scalar, 'height') || getMarkupValue(rect.top, size, scalar, 'height');\n    var width = getMarkupValue(rect.width, size, scalar, 'width');\n    var height = getMarkupValue(rect.height, size, scalar, 'height');\n    var right = getMarkupValue(rect.right, size, scalar, 'width');\n    var bottom = getMarkupValue(rect.bottom, size, scalar, 'height');\n    if (!isDefined(top)) {\n      if (isDefined(height) && isDefined(bottom)) {\n        top = size.height - height - bottom;\n      } else {\n        top = bottom;\n      }\n    }\n    if (!isDefined(left)) {\n      if (isDefined(width) && isDefined(right)) {\n        left = size.width - width - right;\n      } else {\n        left = right;\n      }\n    }\n    if (!isDefined(width)) {\n      if (isDefined(left) && isDefined(right)) {\n        width = size.width - left - right;\n      } else {\n        width = 0;\n      }\n    }\n    if (!isDefined(height)) {\n      if (isDefined(top) && isDefined(bottom)) {\n        height = size.height - top - bottom;\n      } else {\n        height = 0;\n      }\n    }\n    return {\n      x: left || 0,\n      y: top || 0,\n      width: width || 0,\n      height: height || 0\n    };\n  };\n  var pointsToPathShape = function pointsToPathShape(points) {\n    return points.map(function (point, index) {\n      return ''.concat(index === 0 ? 'M' : 'L', ' ').concat(point.x, ' ').concat(point.y);\n    }).join(' ');\n  };\n  var setAttributes = function setAttributes(element, attr) {\n    return Object.keys(attr).forEach(function (key) {\n      return element.setAttribute(key, attr[key]);\n    });\n  };\n  var ns = 'http://www.w3.org/2000/svg';\n  var svg = function svg(tag, attr) {\n    var element = document.createElementNS(ns, tag);\n    if (attr) {\n      setAttributes(element, attr);\n    }\n    return element;\n  };\n  var updateRect = function updateRect(element) {\n    return setAttributes(element, Object.assign({}, element.rect, element.styles));\n  };\n  var updateEllipse = function updateEllipse(element) {\n    var cx = element.rect.x + element.rect.width * 0.5;\n    var cy = element.rect.y + element.rect.height * 0.5;\n    var rx = element.rect.width * 0.5;\n    var ry = element.rect.height * 0.5;\n    return setAttributes(element, Object.assign({\n      cx: cx,\n      cy: cy,\n      rx: rx,\n      ry: ry\n    }, element.styles));\n  };\n  var IMAGE_FIT_STYLE = {\n    contain: 'xMidYMid meet',\n    cover: 'xMidYMid slice'\n  };\n  var updateImage = function updateImage(element, markup) {\n    setAttributes(element, Object.assign({}, element.rect, element.styles, {\n      preserveAspectRatio: IMAGE_FIT_STYLE[markup.fit] || 'none'\n    }));\n  };\n  var TEXT_ANCHOR = {\n    left: 'start',\n    center: 'middle',\n    right: 'end'\n  };\n  var updateText = function updateText(element, markup, size, scale) {\n    var fontSize = getMarkupValue(markup.fontSize, size, scale);\n    var fontFamily = markup.fontFamily || 'sans-serif';\n    var fontWeight = markup.fontWeight || 'normal';\n    var textAlign = TEXT_ANCHOR[markup.textAlign] || 'start';\n    setAttributes(element, Object.assign({}, element.rect, element.styles, {\n      'stroke-width': 0,\n      'font-weight': fontWeight,\n      'font-size': fontSize,\n      'font-family': fontFamily,\n      'text-anchor': textAlign\n    }));\n\n    // update text\n    if (element.text !== markup.text) {\n      element.text = markup.text;\n      element.textContent = markup.text.length ? markup.text : ' ';\n    }\n  };\n  var updateLine = function updateLine(element, markup, size, scale) {\n    setAttributes(element, Object.assign({}, element.rect, element.styles, {\n      fill: 'none'\n    }));\n    var line = element.childNodes[0];\n    var begin = element.childNodes[1];\n    var end = element.childNodes[2];\n    var origin = element.rect;\n    var target = {\n      x: element.rect.x + element.rect.width,\n      y: element.rect.y + element.rect.height\n    };\n    setAttributes(line, {\n      x1: origin.x,\n      y1: origin.y,\n      x2: target.x,\n      y2: target.y\n    });\n    if (!markup.lineDecoration) return;\n    begin.style.display = 'none';\n    end.style.display = 'none';\n    var v = vectorNormalize({\n      x: target.x - origin.x,\n      y: target.y - origin.y\n    });\n    var l = getMarkupValue(0.05, size, scale);\n    if (markup.lineDecoration.indexOf('arrow-begin') !== -1) {\n      var arrowBeginRotationPoint = vectorMultiply(v, l);\n      var arrowBeginCenter = vectorAdd(origin, arrowBeginRotationPoint);\n      var arrowBeginA = vectorRotate(origin, 2, arrowBeginCenter);\n      var arrowBeginB = vectorRotate(origin, -2, arrowBeginCenter);\n      setAttributes(begin, {\n        style: 'display:block;',\n        d: 'M'.concat(arrowBeginA.x, ',').concat(arrowBeginA.y, ' L').concat(origin.x, ',').concat(origin.y, ' L').concat(arrowBeginB.x, ',').concat(arrowBeginB.y)\n      });\n    }\n    if (markup.lineDecoration.indexOf('arrow-end') !== -1) {\n      var arrowEndRotationPoint = vectorMultiply(v, -l);\n      var arrowEndCenter = vectorAdd(target, arrowEndRotationPoint);\n      var arrowEndA = vectorRotate(target, 2, arrowEndCenter);\n      var arrowEndB = vectorRotate(target, -2, arrowEndCenter);\n      setAttributes(end, {\n        style: 'display:block;',\n        d: 'M'.concat(arrowEndA.x, ',').concat(arrowEndA.y, ' L').concat(target.x, ',').concat(target.y, ' L').concat(arrowEndB.x, ',').concat(arrowEndB.y)\n      });\n    }\n  };\n  var updatePath = function updatePath(element, markup, size, scale) {\n    setAttributes(element, Object.assign({}, element.styles, {\n      fill: 'none',\n      d: pointsToPathShape(markup.points.map(function (point) {\n        return {\n          x: getMarkupValue(point.x, size, scale, 'width'),\n          y: getMarkupValue(point.y, size, scale, 'height')\n        };\n      }))\n    }));\n  };\n  var createShape = function createShape(node) {\n    return function (markup) {\n      return svg(node, {\n        id: markup.id\n      });\n    };\n  };\n  var createImage = function createImage(markup) {\n    var shape = svg('image', {\n      id: markup.id,\n      'stroke-linecap': 'round',\n      'stroke-linejoin': 'round',\n      opacity: '0'\n    });\n    shape.onload = function () {\n      shape.setAttribute('opacity', markup.opacity || 1);\n    };\n    shape.setAttributeNS('http://www.w3.org/1999/xlink', 'xlink:href', markup.src);\n    return shape;\n  };\n  var createLine = function createLine(markup) {\n    var shape = svg('g', {\n      id: markup.id,\n      'stroke-linecap': 'round',\n      'stroke-linejoin': 'round'\n    });\n    var line = svg('line');\n    shape.appendChild(line);\n    var begin = svg('path');\n    shape.appendChild(begin);\n    var end = svg('path');\n    shape.appendChild(end);\n    return shape;\n  };\n  var CREATE_TYPE_ROUTES = {\n    image: createImage,\n    rect: createShape('rect'),\n    ellipse: createShape('ellipse'),\n    text: createShape('text'),\n    path: createShape('path'),\n    line: createLine\n  };\n  var UPDATE_TYPE_ROUTES = {\n    rect: updateRect,\n    ellipse: updateEllipse,\n    image: updateImage,\n    text: updateText,\n    path: updatePath,\n    line: updateLine\n  };\n  var createMarkupByType = function createMarkupByType(type, markup) {\n    return CREATE_TYPE_ROUTES[type](markup);\n  };\n  var updateMarkupByType = function updateMarkupByType(element, type, markup, size, scale) {\n    if (type !== 'path') {\n      element.rect = getMarkupRect(markup, size, scale);\n    }\n    element.styles = getMarkupStyles(markup, size, scale);\n    UPDATE_TYPE_ROUTES[type](element, markup, size, scale);\n  };\n  var sortMarkupByZIndex = function sortMarkupByZIndex(a, b) {\n    if (a[1].zIndex > b[1].zIndex) {\n      return 1;\n    }\n    if (a[1].zIndex < b[1].zIndex) {\n      return -1;\n    }\n    return 0;\n  };\n  var cropSVG = function cropSVG(blob) {\n    var crop = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var markup = arguments.length > 2 ? arguments[2] : undefined;\n    var options = arguments.length > 3 ? arguments[3] : undefined;\n    return new Promise(function (resolve) {\n      var _options$background = options.background,\n        background = _options$background === void 0 ? null : _options$background;\n\n      // load blob contents and wrap in crop svg\n      var fr = new FileReader();\n      fr.onloadend = function () {\n        // get svg text\n        var text = fr.result;\n\n        // create element with svg and get size\n        var original = document.createElement('div');\n        original.style.cssText = 'position:absolute;pointer-events:none;width:0;height:0;visibility:hidden;';\n        original.innerHTML = text;\n        var originalNode = original.querySelector('svg');\n        document.body.appendChild(original);\n\n        // request bounding box dimensions\n        var bBox = originalNode.getBBox();\n        original.parentNode.removeChild(original);\n\n        // get title\n        var titleNode = original.querySelector('title');\n\n        // calculate new heights and widths\n        var viewBoxAttribute = originalNode.getAttribute('viewBox') || '';\n        var widthAttribute = originalNode.getAttribute('width') || '';\n        var heightAttribute = originalNode.getAttribute('height') || '';\n        var width = parseFloat(widthAttribute) || null;\n        var height = parseFloat(heightAttribute) || null;\n        var widthUnits = (widthAttribute.match(/[a-z]+/) || [])[0] || '';\n        var heightUnits = (heightAttribute.match(/[a-z]+/) || [])[0] || '';\n\n        // create new size\n        var viewBoxList = viewBoxAttribute.split(' ').map(parseFloat);\n        var viewBox = viewBoxList.length ? {\n          x: viewBoxList[0],\n          y: viewBoxList[1],\n          width: viewBoxList[2],\n          height: viewBoxList[3]\n        } : bBox;\n        var imageWidth = width != null ? width : viewBox.width;\n        var imageHeight = height != null ? height : viewBox.height;\n        originalNode.style.overflow = 'visible';\n        originalNode.setAttribute('width', imageWidth);\n        originalNode.setAttribute('height', imageHeight);\n\n        // markup\n        var markupSVG = '';\n        if (markup && markup.length) {\n          var size = {\n            width: imageWidth,\n            height: imageHeight\n          };\n          markupSVG = markup.sort(sortMarkupByZIndex).reduce(function (prev, shape) {\n            var el = createMarkupByType(shape[0], shape[1]);\n            updateMarkupByType(el, shape[0], shape[1], size);\n            el.removeAttribute('id');\n            if (el.getAttribute('opacity') === 1) {\n              el.removeAttribute('opacity');\n            }\n            return prev + '\\n' + el.outerHTML + '\\n';\n          }, '');\n          markupSVG = '\\n\\n<g>'.concat(markupSVG.replace(/&nbsp;/g, ' '), '</g>\\n\\n');\n        }\n        var aspectRatio = crop.aspectRatio || imageHeight / imageWidth;\n        var canvasWidth = imageWidth;\n        var canvasHeight = canvasWidth * aspectRatio;\n        var shouldLimit = typeof crop.scaleToFit === 'undefined' || crop.scaleToFit;\n        var cropCenterX = crop.center ? crop.center.x : 0.5;\n        var cropCenterY = crop.center ? crop.center.y : 0.5;\n        var canvasZoomFactor = getImageRectZoomFactor({\n          width: imageWidth,\n          height: imageHeight\n        }, getCenteredCropRect({\n          width: canvasWidth,\n          height: canvasHeight\n        }, aspectRatio), crop.rotation, shouldLimit ? {\n          x: cropCenterX,\n          y: cropCenterY\n        } : {\n          x: 0.5,\n          y: 0.5\n        });\n        var scale = crop.zoom * canvasZoomFactor;\n        var rotation = crop.rotation * (180 / Math.PI);\n        var canvasCenter = {\n          x: canvasWidth * 0.5,\n          y: canvasHeight * 0.5\n        };\n        var imageOffset = {\n          x: canvasCenter.x - imageWidth * cropCenterX,\n          y: canvasCenter.y - imageHeight * cropCenterY\n        };\n        var cropTransforms = [\n        // rotate\n        'rotate('.concat(rotation, ' ').concat(canvasCenter.x, ' ').concat(canvasCenter.y, ')'),\n        // scale\n        'translate('.concat(canvasCenter.x, ' ').concat(canvasCenter.y, ')'), 'scale('.concat(scale, ')'), 'translate('.concat(-canvasCenter.x, ' ').concat(-canvasCenter.y, ')'),\n        // offset\n        'translate('.concat(imageOffset.x, ' ').concat(imageOffset.y, ')')];\n        var cropFlipHorizontal = crop.flip && crop.flip.horizontal;\n        var cropFlipVertical = crop.flip && crop.flip.vertical;\n        var flipTransforms = ['scale('.concat(cropFlipHorizontal ? -1 : 1, ' ').concat(cropFlipVertical ? -1 : 1, ')'), 'translate('.concat(cropFlipHorizontal ? -imageWidth : 0, ' ').concat(cropFlipVertical ? -imageHeight : 0, ')')];\n\n        // crop\n        var transformed = '<?xml version=\"1.0\" encoding=\"UTF-8\"?>\\n<svg width=\"'.concat(canvasWidth).concat(widthUnits, '\" height=\"').concat(canvasHeight).concat(heightUnits, '\" \\nviewBox=\"0 0 ').concat(canvasWidth, ' ').concat(canvasHeight, '\" ').concat(background ? 'style=\"background:' + background + '\" ' : '', '\\npreserveAspectRatio=\"xMinYMin\"\\nxmlns:xlink=\"http://www.w3.org/1999/xlink\"\\nxmlns=\"http://www.w3.org/2000/svg\">\\n<!-- Generated by PQINA - https://pqina.nl/ -->\\n<title>').concat(titleNode ? titleNode.textContent : '', '</title>\\n<g transform=\"').concat(cropTransforms.join(' '), '\">\\n<g transform=\"').concat(flipTransforms.join(' '), '\">\\n').concat(originalNode.outerHTML).concat(markupSVG, '\\n</g>\\n</g>\\n</svg>');\n\n        // create new svg file\n        resolve(transformed);\n      };\n      fr.readAsText(blob);\n    });\n  };\n  var objectToImageData = function objectToImageData(obj) {\n    var imageData;\n    try {\n      imageData = new ImageData(obj.width, obj.height);\n    } catch (e) {\n      // IE + Old EDGE (tested on 12)\n      var canvas = document.createElement('canvas');\n      imageData = canvas.getContext('2d').createImageData(obj.width, obj.height);\n    }\n    imageData.data.set(obj.data);\n    return imageData;\n  };\n\n  /* javascript-obfuscator:disable */\n  var TransformWorker = function TransformWorker() {\n    // maps transform types to transform functions\n    var TRANSFORMS = {\n      resize: resize,\n      filter: filter\n    };\n\n    // applies all image transforms to the image data array\n    var applyTransforms = function applyTransforms(transforms, imageData) {\n      transforms.forEach(function (transform) {\n        imageData = TRANSFORMS[transform.type](imageData, transform.data);\n      });\n      return imageData;\n    };\n\n    // transform image hub\n    var transform = function transform(data, cb) {\n      var transforms = data.transforms;\n\n      // if has filter and has resize, move filter to resize operation\n      var filterTransform = null;\n      transforms.forEach(function (transform) {\n        if (transform.type === 'filter') {\n          filterTransform = transform;\n        }\n      });\n      if (filterTransform) {\n        // find resize\n        var resizeTransform = null;\n        transforms.forEach(function (transform) {\n          if (transform.type === 'resize') {\n            resizeTransform = transform;\n          }\n        });\n        if (resizeTransform) {\n          // update resize operation\n          resizeTransform.data.matrix = filterTransform.data;\n\n          // remove filter\n          transforms = transforms.filter(function (transform) {\n            return transform.type !== 'filter';\n          });\n        }\n      }\n      cb(applyTransforms(transforms, data.imageData));\n    };\n\n    // eslint-disable-next-line no-restricted-globals\n    self.onmessage = function (e) {\n      transform(e.data.message, function (response) {\n        // eslint-disable-next-line no-restricted-globals\n        self.postMessage({\n          id: e.data.id,\n          message: response\n        }, [response.data.buffer]);\n      });\n    };\n    var br = 1.0;\n    var bg = 1.0;\n    var bb = 1.0;\n    function applyFilterMatrix(index, data, m) {\n      var ir = data[index] / 255;\n      var ig = data[index + 1] / 255;\n      var ib = data[index + 2] / 255;\n      var ia = data[index + 3] / 255;\n      var mr = ir * m[0] + ig * m[1] + ib * m[2] + ia * m[3] + m[4];\n      var mg = ir * m[5] + ig * m[6] + ib * m[7] + ia * m[8] + m[9];\n      var mb = ir * m[10] + ig * m[11] + ib * m[12] + ia * m[13] + m[14];\n      var ma = ir * m[15] + ig * m[16] + ib * m[17] + ia * m[18] + m[19];\n      var or = Math.max(0, mr * ma) + br * (1.0 - ma);\n      var og = Math.max(0, mg * ma) + bg * (1.0 - ma);\n      var ob = Math.max(0, mb * ma) + bb * (1.0 - ma);\n      data[index] = Math.max(0.0, Math.min(1.0, or)) * 255;\n      data[index + 1] = Math.max(0.0, Math.min(1.0, og)) * 255;\n      data[index + 2] = Math.max(0.0, Math.min(1.0, ob)) * 255;\n    }\n    var identityMatrix = self.JSON.stringify([1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0]);\n    function isIdentityMatrix(filter) {\n      return self.JSON.stringify(filter || []) === identityMatrix;\n    }\n    function filter(imageData, matrix) {\n      if (!matrix || isIdentityMatrix(matrix)) return imageData;\n      var data = imageData.data;\n      var l = data.length;\n      var m11 = matrix[0];\n      var m12 = matrix[1];\n      var m13 = matrix[2];\n      var m14 = matrix[3];\n      var m15 = matrix[4];\n      var m21 = matrix[5];\n      var m22 = matrix[6];\n      var m23 = matrix[7];\n      var m24 = matrix[8];\n      var m25 = matrix[9];\n      var m31 = matrix[10];\n      var m32 = matrix[11];\n      var m33 = matrix[12];\n      var m34 = matrix[13];\n      var m35 = matrix[14];\n      var m41 = matrix[15];\n      var m42 = matrix[16];\n      var m43 = matrix[17];\n      var m44 = matrix[18];\n      var m45 = matrix[19];\n      var index = 0,\n        r = 0.0,\n        g = 0.0,\n        b = 0.0,\n        a = 0.0,\n        mr = 0.0,\n        mg = 0.0,\n        mb = 0.0,\n        ma = 0.0,\n        or = 0.0,\n        og = 0.0,\n        ob = 0.0;\n      for (; index < l; index += 4) {\n        r = data[index] / 255;\n        g = data[index + 1] / 255;\n        b = data[index + 2] / 255;\n        a = data[index + 3] / 255;\n        mr = r * m11 + g * m12 + b * m13 + a * m14 + m15;\n        mg = r * m21 + g * m22 + b * m23 + a * m24 + m25;\n        mb = r * m31 + g * m32 + b * m33 + a * m34 + m35;\n        ma = r * m41 + g * m42 + b * m43 + a * m44 + m45;\n        or = Math.max(0, mr * ma) + br * (1.0 - ma);\n        og = Math.max(0, mg * ma) + bg * (1.0 - ma);\n        ob = Math.max(0, mb * ma) + bb * (1.0 - ma);\n        data[index] = Math.max(0.0, Math.min(1.0, or)) * 255;\n        data[index + 1] = Math.max(0.0, Math.min(1.0, og)) * 255;\n        data[index + 2] = Math.max(0.0, Math.min(1.0, ob)) * 255;\n        // don't update alpha value\n      }\n\n      return imageData;\n    }\n    function resize(imageData, data) {\n      var _data$mode = data.mode,\n        mode = _data$mode === void 0 ? 'contain' : _data$mode,\n        _data$upscale = data.upscale,\n        upscale = _data$upscale === void 0 ? false : _data$upscale,\n        width = data.width,\n        height = data.height,\n        matrix = data.matrix;\n\n      // test if is identity matrix\n      matrix = !matrix || isIdentityMatrix(matrix) ? null : matrix;\n\n      // need at least a width or a height\n      // also 0 is not a valid width or height\n      if (!width && !height) {\n        return filter(imageData, matrix);\n      }\n\n      // make sure all bounds are set\n      if (width === null) {\n        width = height;\n      } else if (height === null) {\n        height = width;\n      }\n      if (mode !== 'force') {\n        var scalarWidth = width / imageData.width;\n        var scalarHeight = height / imageData.height;\n        var scalar = 1;\n        if (mode === 'cover') {\n          scalar = Math.max(scalarWidth, scalarHeight);\n        } else if (mode === 'contain') {\n          scalar = Math.min(scalarWidth, scalarHeight);\n        }\n\n        // if image is too small, exit here with original image\n        if (scalar > 1 && upscale === false) {\n          return filter(imageData, matrix);\n        }\n        width = imageData.width * scalar;\n        height = imageData.height * scalar;\n      }\n      var originWidth = imageData.width;\n      var originHeight = imageData.height;\n      var targetWidth = Math.round(width);\n      var targetHeight = Math.round(height);\n      var inputData = imageData.data;\n      var outputData = new Uint8ClampedArray(targetWidth * targetHeight * 4);\n      var ratioWidth = originWidth / targetWidth;\n      var ratioHeight = originHeight / targetHeight;\n      var ratioWidthHalf = Math.ceil(ratioWidth * 0.5);\n      var ratioHeightHalf = Math.ceil(ratioHeight * 0.5);\n      for (var j = 0; j < targetHeight; j++) {\n        for (var i = 0; i < targetWidth; i++) {\n          var x2 = (i + j * targetWidth) * 4;\n          var weight = 0;\n          var weights = 0;\n          var weightsAlpha = 0;\n          var r = 0;\n          var g = 0;\n          var b = 0;\n          var a = 0;\n          var centerY = (j + 0.5) * ratioHeight;\n          for (var yy = Math.floor(j * ratioHeight); yy < (j + 1) * ratioHeight; yy++) {\n            var dy = Math.abs(centerY - (yy + 0.5)) / ratioHeightHalf;\n            var centerX = (i + 0.5) * ratioWidth;\n            var w0 = dy * dy;\n            for (var xx = Math.floor(i * ratioWidth); xx < (i + 1) * ratioWidth; xx++) {\n              var dx = Math.abs(centerX - (xx + 0.5)) / ratioWidthHalf;\n              var w = Math.sqrt(w0 + dx * dx);\n              if (w >= -1 && w <= 1) {\n                weight = 2 * w * w * w - 3 * w * w + 1;\n                if (weight > 0) {\n                  dx = 4 * (xx + yy * originWidth);\n                  var ref = inputData[dx + 3];\n                  a += weight * ref;\n                  weightsAlpha += weight;\n                  if (ref < 255) {\n                    weight = weight * ref / 250;\n                  }\n                  r += weight * inputData[dx];\n                  g += weight * inputData[dx + 1];\n                  b += weight * inputData[dx + 2];\n                  weights += weight;\n                }\n              }\n            }\n          }\n          outputData[x2] = r / weights;\n          outputData[x2 + 1] = g / weights;\n          outputData[x2 + 2] = b / weights;\n          outputData[x2 + 3] = a / weightsAlpha;\n          matrix && applyFilterMatrix(x2, outputData, matrix);\n        }\n      }\n      return {\n        data: outputData,\n        width: targetWidth,\n        height: targetHeight\n      };\n    }\n  };\n  /* javascript-obfuscator:enable */\n\n  var correctOrientation = function correctOrientation(view, offset) {\n    // Missing 0x45786966 Marker? No Exif Header, stop here\n    if (view.getUint32(offset + 4, false) !== 0x45786966) return;\n\n    // next byte!\n    offset += 4;\n\n    // First 2bytes defines byte align of TIFF data.\n    // If it is 0x4949=\"I I\", it means \"Intel\" type byte align\n    var intelByteAligned = view.getUint16(offset += 6, false) === 0x4949;\n    offset += view.getUint32(offset + 4, intelByteAligned);\n    var tags = view.getUint16(offset, intelByteAligned);\n    offset += 2;\n\n    // find Orientation tag\n    for (var i = 0; i < tags; i++) {\n      if (view.getUint16(offset + i * 12, intelByteAligned) === 0x0112) {\n        view.setUint16(offset + i * 12 + 8, 1, intelByteAligned);\n        return true;\n      }\n    }\n    return false;\n  };\n  var readData = function readData(data) {\n    var view = new DataView(data);\n\n    // Every JPEG file starts from binary value '0xFFD8'\n    // If it's not present, exit here\n    if (view.getUint16(0) !== 0xffd8) return null;\n    var offset = 2; // Start at 2 as we skipped two bytes (FFD8)\n    var marker;\n    var markerLength;\n    var orientationCorrected = false;\n    while (offset < view.byteLength) {\n      marker = view.getUint16(offset, false);\n      markerLength = view.getUint16(offset + 2, false) + 2;\n\n      // Test if is APP and COM markers\n      var isData = marker >= 0xffe0 && marker <= 0xffef || marker === 0xfffe;\n      if (!isData) {\n        break;\n      }\n      if (!orientationCorrected) {\n        orientationCorrected = correctOrientation(view, offset, markerLength);\n      }\n      if (offset + markerLength > view.byteLength) {\n        break;\n      }\n      offset += markerLength;\n    }\n    return data.slice(0, offset);\n  };\n  var getImageHead = function getImageHead(file) {\n    return new Promise(function (resolve) {\n      var reader = new FileReader();\n      reader.onload = function () {\n        return resolve(readData(reader.result) || null);\n      };\n      reader.readAsArrayBuffer(file.slice(0, 256 * 1024));\n    });\n  };\n  var getBlobBuilder = function getBlobBuilder() {\n    return window.BlobBuilder = window.BlobBuilder || window.WebKitBlobBuilder || window.MozBlobBuilder || window.MSBlobBuilder;\n  };\n  var createBlob = function createBlob(arrayBuffer, mimeType) {\n    var BB = getBlobBuilder();\n    if (BB) {\n      var bb = new BB();\n      bb.append(arrayBuffer);\n      return bb.getBlob(mimeType);\n    }\n    return new Blob([arrayBuffer], {\n      type: mimeType\n    });\n  };\n  var getUniqueId = function getUniqueId() {\n    return Math.random().toString(36).substr(2, 9);\n  };\n  var createWorker = function createWorker(fn) {\n    var workerBlob = new Blob(['(', fn.toString(), ')()'], {\n      type: 'application/javascript'\n    });\n    var workerURL = URL.createObjectURL(workerBlob);\n    var worker = new Worker(workerURL);\n    var trips = [];\n    return {\n      transfer: function transfer() {},\n      // (message, cb) => {}\n      post: function post(message, cb, transferList) {\n        var id = getUniqueId();\n        trips[id] = cb;\n        worker.onmessage = function (e) {\n          var cb = trips[e.data.id];\n          if (!cb) return;\n          cb(e.data.message);\n          delete trips[e.data.id];\n        };\n        worker.postMessage({\n          id: id,\n          message: message\n        }, transferList);\n      },\n      terminate: function terminate() {\n        worker.terminate();\n        URL.revokeObjectURL(workerURL);\n      }\n    };\n  };\n  var loadImage = function loadImage(url) {\n    return new Promise(function (resolve, reject) {\n      var img = new Image();\n      img.onload = function () {\n        resolve(img);\n      };\n      img.onerror = function (e) {\n        reject(e);\n      };\n      img.src = url;\n    });\n  };\n  var chain = function chain(funcs) {\n    return funcs.reduce(function (promise, func) {\n      return promise.then(function (result) {\n        return func().then(Array.prototype.concat.bind(result));\n      });\n    }, Promise.resolve([]));\n  };\n  var canvasApplyMarkup = function canvasApplyMarkup(canvas, markup) {\n    return new Promise(function (resolve) {\n      var size = {\n        width: canvas.width,\n        height: canvas.height\n      };\n      var ctx = canvas.getContext('2d');\n      var drawers = markup.sort(sortMarkupByZIndex).map(function (item) {\n        return function () {\n          return new Promise(function (resolve) {\n            var result = TYPE_DRAW_ROUTES[item[0]](ctx, size, item[1], resolve);\n            if (result) resolve();\n          });\n        };\n      });\n      chain(drawers).then(function () {\n        return resolve(canvas);\n      });\n    });\n  };\n  var applyMarkupStyles = function applyMarkupStyles(ctx, styles) {\n    ctx.beginPath();\n    ctx.lineCap = styles['stroke-linecap'];\n    ctx.lineJoin = styles['stroke-linejoin'];\n    ctx.lineWidth = styles['stroke-width'];\n    if (styles['stroke-dasharray'].length) {\n      ctx.setLineDash(styles['stroke-dasharray'].split(','));\n    }\n    ctx.fillStyle = styles['fill'];\n    ctx.strokeStyle = styles['stroke'];\n    ctx.globalAlpha = styles.opacity || 1;\n  };\n  var drawMarkupStyles = function drawMarkupStyles(ctx) {\n    ctx.fill();\n    ctx.stroke();\n    ctx.globalAlpha = 1;\n  };\n  var drawRect = function drawRect(ctx, size, markup) {\n    var rect = getMarkupRect(markup, size);\n    var styles = getMarkupStyles(markup, size);\n    applyMarkupStyles(ctx, styles);\n    ctx.rect(rect.x, rect.y, rect.width, rect.height);\n    drawMarkupStyles(ctx, styles);\n    return true;\n  };\n  var drawEllipse = function drawEllipse(ctx, size, markup) {\n    var rect = getMarkupRect(markup, size);\n    var styles = getMarkupStyles(markup, size);\n    applyMarkupStyles(ctx, styles);\n    var x = rect.x,\n      y = rect.y,\n      w = rect.width,\n      h = rect.height,\n      kappa = 0.5522848,\n      ox = w / 2 * kappa,\n      oy = h / 2 * kappa,\n      xe = x + w,\n      ye = y + h,\n      xm = x + w / 2,\n      ym = y + h / 2;\n    ctx.moveTo(x, ym);\n    ctx.bezierCurveTo(x, ym - oy, xm - ox, y, xm, y);\n    ctx.bezierCurveTo(xm + ox, y, xe, ym - oy, xe, ym);\n    ctx.bezierCurveTo(xe, ym + oy, xm + ox, ye, xm, ye);\n    ctx.bezierCurveTo(xm - ox, ye, x, ym + oy, x, ym);\n    drawMarkupStyles(ctx, styles);\n    return true;\n  };\n  var drawImage = function drawImage(ctx, size, markup, done) {\n    var rect = getMarkupRect(markup, size);\n    var styles = getMarkupStyles(markup, size);\n    applyMarkupStyles(ctx, styles);\n    var image = new Image();\n\n    // if is cross origin image add cross origin attribute\n    var isCrossOriginImage = new URL(markup.src, window.location.href).origin !== window.location.origin;\n    if (isCrossOriginImage) image.crossOrigin = '';\n    image.onload = function () {\n      if (markup.fit === 'cover') {\n        var ar = rect.width / rect.height;\n        var width = ar > 1 ? image.width : image.height * ar;\n        var height = ar > 1 ? image.width / ar : image.height;\n        var x = image.width * 0.5 - width * 0.5;\n        var y = image.height * 0.5 - height * 0.5;\n        ctx.drawImage(image, x, y, width, height, rect.x, rect.y, rect.width, rect.height);\n      } else if (markup.fit === 'contain') {\n        var scalar = Math.min(rect.width / image.width, rect.height / image.height);\n        var _width = scalar * image.width;\n        var _height = scalar * image.height;\n        var _x = rect.x + rect.width * 0.5 - _width * 0.5;\n        var _y = rect.y + rect.height * 0.5 - _height * 0.5;\n        ctx.drawImage(image, 0, 0, image.width, image.height, _x, _y, _width, _height);\n      } else {\n        ctx.drawImage(image, 0, 0, image.width, image.height, rect.x, rect.y, rect.width, rect.height);\n      }\n      drawMarkupStyles(ctx, styles);\n      done();\n    };\n    image.src = markup.src;\n  };\n  var drawText = function drawText(ctx, size, markup) {\n    var rect = getMarkupRect(markup, size);\n    var styles = getMarkupStyles(markup, size);\n    applyMarkupStyles(ctx, styles);\n    var fontSize = getMarkupValue(markup.fontSize, size);\n    var fontFamily = markup.fontFamily || 'sans-serif';\n    var fontWeight = markup.fontWeight || 'normal';\n    var textAlign = markup.textAlign || 'left';\n    ctx.font = ''.concat(fontWeight, ' ').concat(fontSize, 'px ').concat(fontFamily);\n    ctx.textAlign = textAlign;\n    ctx.fillText(markup.text, rect.x, rect.y);\n    drawMarkupStyles(ctx, styles);\n    return true;\n  };\n  var drawPath = function drawPath(ctx, size, markup) {\n    var styles = getMarkupStyles(markup, size);\n    applyMarkupStyles(ctx, styles);\n    ctx.beginPath();\n    var points = markup.points.map(function (point) {\n      return {\n        x: getMarkupValue(point.x, size, 1, 'width'),\n        y: getMarkupValue(point.y, size, 1, 'height')\n      };\n    });\n    ctx.moveTo(points[0].x, points[0].y);\n    var l = points.length;\n    for (var i = 1; i < l; i++) {\n      ctx.lineTo(points[i].x, points[i].y);\n    }\n    drawMarkupStyles(ctx, styles);\n    return true;\n  };\n  var drawLine = function drawLine(ctx, size, markup) {\n    var rect = getMarkupRect(markup, size);\n    var styles = getMarkupStyles(markup, size);\n    applyMarkupStyles(ctx, styles);\n    ctx.beginPath();\n    var origin = {\n      x: rect.x,\n      y: rect.y\n    };\n    var target = {\n      x: rect.x + rect.width,\n      y: rect.y + rect.height\n    };\n    ctx.moveTo(origin.x, origin.y);\n    ctx.lineTo(target.x, target.y);\n    var v = vectorNormalize({\n      x: target.x - origin.x,\n      y: target.y - origin.y\n    });\n    var l = 0.04 * Math.min(size.width, size.height);\n    if (markup.lineDecoration.indexOf('arrow-begin') !== -1) {\n      var arrowBeginRotationPoint = vectorMultiply(v, l);\n      var arrowBeginCenter = vectorAdd(origin, arrowBeginRotationPoint);\n      var arrowBeginA = vectorRotate(origin, 2, arrowBeginCenter);\n      var arrowBeginB = vectorRotate(origin, -2, arrowBeginCenter);\n      ctx.moveTo(arrowBeginA.x, arrowBeginA.y);\n      ctx.lineTo(origin.x, origin.y);\n      ctx.lineTo(arrowBeginB.x, arrowBeginB.y);\n    }\n    if (markup.lineDecoration.indexOf('arrow-end') !== -1) {\n      var arrowEndRotationPoint = vectorMultiply(v, -l);\n      var arrowEndCenter = vectorAdd(target, arrowEndRotationPoint);\n      var arrowEndA = vectorRotate(target, 2, arrowEndCenter);\n      var arrowEndB = vectorRotate(target, -2, arrowEndCenter);\n      ctx.moveTo(arrowEndA.x, arrowEndA.y);\n      ctx.lineTo(target.x, target.y);\n      ctx.lineTo(arrowEndB.x, arrowEndB.y);\n    }\n    drawMarkupStyles(ctx, styles);\n    return true;\n  };\n  var TYPE_DRAW_ROUTES = {\n    rect: drawRect,\n    ellipse: drawEllipse,\n    image: drawImage,\n    text: drawText,\n    line: drawLine,\n    path: drawPath\n  };\n  var imageDataToCanvas = function imageDataToCanvas(imageData) {\n    var image = document.createElement('canvas');\n    image.width = imageData.width;\n    image.height = imageData.height;\n    var ctx = image.getContext('2d');\n    ctx.putImageData(imageData, 0, 0);\n    return image;\n  };\n  var transformImage = function transformImage(file, instructions) {\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    return new Promise(function (resolve, reject) {\n      // if the file is not an image we do not have any business transforming it\n      if (!file || !isImage$1(file)) return reject({\n        status: 'not an image file',\n        file: file\n      });\n\n      // get separate options for easier use\n      var stripImageHead = options.stripImageHead,\n        beforeCreateBlob = options.beforeCreateBlob,\n        afterCreateBlob = options.afterCreateBlob,\n        canvasMemoryLimit = options.canvasMemoryLimit;\n\n      // get crop\n      var crop = instructions.crop,\n        size = instructions.size,\n        filter = instructions.filter,\n        markup = instructions.markup,\n        output = instructions.output;\n\n      // get exif orientation\n      var orientation = instructions.image && instructions.image.orientation ? Math.max(1, Math.min(8, instructions.image.orientation)) : null;\n\n      // compression quality 0 => 100\n      var qualityAsPercentage = output && output.quality;\n      var quality = qualityAsPercentage === null ? null : qualityAsPercentage / 100;\n\n      // output format\n      var type = output && output.type || null;\n\n      // background color\n      var background = output && output.background || null;\n\n      // get transforms\n      var transforms = [];\n\n      // add resize transforms if set\n      if (size && (typeof size.width === 'number' || typeof size.height === 'number')) {\n        transforms.push({\n          type: 'resize',\n          data: size\n        });\n      }\n\n      // add filters\n      if (filter && filter.length === 20) {\n        transforms.push({\n          type: 'filter',\n          data: filter\n        });\n      }\n\n      // resolves with supplied blob\n      var resolveWithBlob = function resolveWithBlob(blob) {\n        var promisedBlob = afterCreateBlob ? afterCreateBlob(blob) : blob;\n        Promise.resolve(promisedBlob).then(resolve);\n      };\n\n      // done\n      var toBlob = function toBlob(imageData, options) {\n        var canvas = imageDataToCanvas(imageData);\n        var promisedCanvas = markup.length ? canvasApplyMarkup(canvas, markup) : canvas;\n        Promise.resolve(promisedCanvas).then(function (canvas) {\n          canvasToBlob(canvas, options, beforeCreateBlob).then(function (blob) {\n            // force release of canvas memory\n            canvasRelease(canvas);\n\n            // remove image head (default)\n            if (stripImageHead) return resolveWithBlob(blob);\n\n            // try to copy image head from original file to generated blob\n            getImageHead(file).then(function (imageHead) {\n              // re-inject image head in case of JPEG, as the image head is removed by canvas export\n              if (imageHead !== null) {\n                blob = new Blob([imageHead, blob.slice(20)], {\n                  type: blob.type\n                });\n              }\n\n              // done!\n              resolveWithBlob(blob);\n            });\n          }).catch(reject);\n        });\n      };\n\n      // if this is an svg and we want it to stay an svg\n      if (/svg/.test(file.type) && type === null) {\n        return cropSVG(file, crop, markup, {\n          background: background\n        }).then(function (text) {\n          resolve(createBlob(text, 'image/svg+xml'));\n        });\n      }\n\n      // get file url\n      var url = URL.createObjectURL(file);\n\n      // turn the file into an image\n      loadImage(url).then(function (image) {\n        // url is no longer needed\n        URL.revokeObjectURL(url);\n\n        // draw to canvas and start transform chain\n        var imageData = imageToImageData(image, orientation, crop, {\n          canvasMemoryLimit: canvasMemoryLimit,\n          background: background\n        });\n\n        // determine the format of the blob that we will output\n        var outputFormat = {\n          quality: quality,\n          type: type || file.type\n        };\n\n        // no transforms necessary, we done!\n        if (!transforms.length) {\n          return toBlob(imageData, outputFormat);\n        }\n\n        // send to the transform worker to transform the blob on a separate thread\n        var worker = createWorker(TransformWorker);\n        worker.post({\n          transforms: transforms,\n          imageData: imageData\n        }, function (response) {\n          // finish up\n          toBlob(objectToImageData(response), outputFormat);\n\n          // stop worker\n          worker.terminate();\n        }, [imageData.data.buffer]);\n      }).catch(reject);\n    });\n  };\n  function _typeof(obj) {\n    if (typeof Symbol === 'function' && typeof Symbol.iterator === 'symbol') {\n      _typeof = function (obj) {\n        return typeof obj;\n      };\n    } else {\n      _typeof = function (obj) {\n        return obj && typeof Symbol === 'function' && obj.constructor === Symbol && obj !== Symbol.prototype ? 'symbol' : typeof obj;\n      };\n    }\n    return _typeof(obj);\n  }\n  var REACT_ELEMENT_TYPE;\n  function _jsx(type, props, key, children) {\n    if (!REACT_ELEMENT_TYPE) {\n      REACT_ELEMENT_TYPE = typeof Symbol === 'function' && Symbol.for && Symbol.for('react.element') || 0xeac7;\n    }\n    var defaultProps = type && type.defaultProps;\n    var childrenLength = arguments.length - 3;\n    if (!props && childrenLength !== 0) {\n      props = {\n        children: void 0\n      };\n    }\n    if (props && defaultProps) {\n      for (var propName in defaultProps) {\n        if (props[propName] === void 0) {\n          props[propName] = defaultProps[propName];\n        }\n      }\n    } else if (!props) {\n      props = defaultProps || {};\n    }\n    if (childrenLength === 1) {\n      props.children = children;\n    } else if (childrenLength > 1) {\n      var childArray = new Array(childrenLength);\n      for (var i = 0; i < childrenLength; i++) {\n        childArray[i] = arguments[i + 3];\n      }\n      props.children = childArray;\n    }\n    return {\n      $$typeof: REACT_ELEMENT_TYPE,\n      type: type,\n      key: key === undefined ? null : '' + key,\n      ref: null,\n      props: props,\n      _owner: null\n    };\n  }\n  function _asyncIterator(iterable) {\n    var method;\n    if (typeof Symbol === 'function') {\n      if (Symbol.asyncIterator) {\n        method = iterable[Symbol.asyncIterator];\n        if (method != null) return method.call(iterable);\n      }\n      if (Symbol.iterator) {\n        method = iterable[Symbol.iterator];\n        if (method != null) return method.call(iterable);\n      }\n    }\n    throw new TypeError('Object is not async iterable');\n  }\n  function _AwaitValue(value) {\n    this.wrapped = value;\n  }\n  function _AsyncGenerator(gen) {\n    var front, back;\n    function send(key, arg) {\n      return new Promise(function (resolve, reject) {\n        var request = {\n          key: key,\n          arg: arg,\n          resolve: resolve,\n          reject: reject,\n          next: null\n        };\n        if (back) {\n          back = back.next = request;\n        } else {\n          front = back = request;\n          resume(key, arg);\n        }\n      });\n    }\n    function resume(key, arg) {\n      try {\n        var result = gen[key](arg);\n        var value = result.value;\n        var wrappedAwait = value instanceof _AwaitValue;\n        Promise.resolve(wrappedAwait ? value.wrapped : value).then(function (arg) {\n          if (wrappedAwait) {\n            resume('next', arg);\n            return;\n          }\n          settle(result.done ? 'return' : 'normal', arg);\n        }, function (err) {\n          resume('throw', err);\n        });\n      } catch (err) {\n        settle('throw', err);\n      }\n    }\n    function settle(type, value) {\n      switch (type) {\n        case 'return':\n          front.resolve({\n            value: value,\n            done: true\n          });\n          break;\n        case 'throw':\n          front.reject(value);\n          break;\n        default:\n          front.resolve({\n            value: value,\n            done: false\n          });\n          break;\n      }\n      front = front.next;\n      if (front) {\n        resume(front.key, front.arg);\n      } else {\n        back = null;\n      }\n    }\n    this._invoke = send;\n    if (typeof gen.return !== 'function') {\n      this.return = undefined;\n    }\n  }\n  if (typeof Symbol === 'function' && Symbol.asyncIterator) {\n    _AsyncGenerator.prototype[Symbol.asyncIterator] = function () {\n      return this;\n    };\n  }\n  _AsyncGenerator.prototype.next = function (arg) {\n    return this._invoke('next', arg);\n  };\n  _AsyncGenerator.prototype.throw = function (arg) {\n    return this._invoke('throw', arg);\n  };\n  _AsyncGenerator.prototype.return = function (arg) {\n    return this._invoke('return', arg);\n  };\n  function _wrapAsyncGenerator(fn) {\n    return function () {\n      return new _AsyncGenerator(fn.apply(this, arguments));\n    };\n  }\n  function _awaitAsyncGenerator(value) {\n    return new _AwaitValue(value);\n  }\n  function _asyncGeneratorDelegate(inner, awaitWrap) {\n    var iter = {},\n      waiting = false;\n    function pump(key, value) {\n      waiting = true;\n      value = new Promise(function (resolve) {\n        resolve(inner[key](value));\n      });\n      return {\n        done: false,\n        value: awaitWrap(value)\n      };\n    }\n    if (typeof Symbol === 'function' && Symbol.iterator) {\n      iter[Symbol.iterator] = function () {\n        return this;\n      };\n    }\n    iter.next = function (value) {\n      if (waiting) {\n        waiting = false;\n        return value;\n      }\n      return pump('next', value);\n    };\n    if (typeof inner.throw === 'function') {\n      iter.throw = function (value) {\n        if (waiting) {\n          waiting = false;\n          throw value;\n        }\n        return pump('throw', value);\n      };\n    }\n    if (typeof inner.return === 'function') {\n      iter.return = function (value) {\n        return pump('return', value);\n      };\n    }\n    return iter;\n  }\n  function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n    try {\n      var info = gen[key](arg);\n      var value = info.value;\n    } catch (error) {\n      reject(error);\n      return;\n    }\n    if (info.done) {\n      resolve(value);\n    } else {\n      Promise.resolve(value).then(_next, _throw);\n    }\n  }\n  function _asyncToGenerator(fn) {\n    return function () {\n      var self = this,\n        args = arguments;\n      return new Promise(function (resolve, reject) {\n        var gen = fn.apply(self, args);\n        function _next(value) {\n          asyncGeneratorStep(gen, resolve, reject, _next, _throw, 'next', value);\n        }\n        function _throw(err) {\n          asyncGeneratorStep(gen, resolve, reject, _next, _throw, 'throw', err);\n        }\n        _next(undefined);\n      });\n    };\n  }\n  function _classCallCheck(instance, Constructor) {\n    if (!(instance instanceof Constructor)) {\n      throw new TypeError('Cannot call a class as a function');\n    }\n  }\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if ('value' in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n  function _createClass(Constructor, protoProps, staticProps) {\n    if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) _defineProperties(Constructor, staticProps);\n    return Constructor;\n  }\n  function _defineEnumerableProperties(obj, descs) {\n    for (var key in descs) {\n      var desc = descs[key];\n      desc.configurable = desc.enumerable = true;\n      if ('value' in desc) desc.writable = true;\n      Object.defineProperty(obj, key, desc);\n    }\n    if (Object.getOwnPropertySymbols) {\n      var objectSymbols = Object.getOwnPropertySymbols(descs);\n      for (var i = 0; i < objectSymbols.length; i++) {\n        var sym = objectSymbols[i];\n        var desc = descs[sym];\n        desc.configurable = desc.enumerable = true;\n        if ('value' in desc) desc.writable = true;\n        Object.defineProperty(obj, sym, desc);\n      }\n    }\n    return obj;\n  }\n  function _defaults(obj, defaults) {\n    var keys = Object.getOwnPropertyNames(defaults);\n    for (var i = 0; i < keys.length; i++) {\n      var key = keys[i];\n      var value = Object.getOwnPropertyDescriptor(defaults, key);\n      if (value && value.configurable && obj[key] === undefined) {\n        Object.defineProperty(obj, key, value);\n      }\n    }\n    return obj;\n  }\n  function _defineProperty(obj, key, value) {\n    if (key in obj) {\n      Object.defineProperty(obj, key, {\n        value: value,\n        enumerable: true,\n        configurable: true,\n        writable: true\n      });\n    } else {\n      obj[key] = value;\n    }\n    return obj;\n  }\n  function _extends() {\n    _extends = Object.assign || function (target) {\n      for (var i = 1; i < arguments.length; i++) {\n        var source = arguments[i];\n        for (var key in source) {\n          if (Object.prototype.hasOwnProperty.call(source, key)) {\n            target[key] = source[key];\n          }\n        }\n      }\n      return target;\n    };\n    return _extends.apply(this, arguments);\n  }\n  function _objectSpread(target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i] != null ? arguments[i] : {};\n      var ownKeys = Object.keys(source);\n      if (typeof Object.getOwnPropertySymbols === 'function') {\n        ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) {\n          return Object.getOwnPropertyDescriptor(source, sym).enumerable;\n        }));\n      }\n      ownKeys.forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    }\n    return target;\n  }\n  function _inherits(subClass, superClass) {\n    if (typeof superClass !== 'function' && superClass !== null) {\n      throw new TypeError('Super expression must either be null or a function');\n    }\n    subClass.prototype = Object.create(superClass && superClass.prototype, {\n      constructor: {\n        value: subClass,\n        writable: true,\n        configurable: true\n      }\n    });\n    if (superClass) _setPrototypeOf(subClass, superClass);\n  }\n  function _inheritsLoose(subClass, superClass) {\n    subClass.prototype = Object.create(superClass.prototype);\n    subClass.prototype.constructor = subClass;\n    subClass.__proto__ = superClass;\n  }\n  function _getPrototypeOf(o) {\n    _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n      return o.__proto__ || Object.getPrototypeOf(o);\n    };\n    return _getPrototypeOf(o);\n  }\n  function _setPrototypeOf(o, p) {\n    _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n      o.__proto__ = p;\n      return o;\n    };\n    return _setPrototypeOf(o, p);\n  }\n  function isNativeReflectConstruct() {\n    if (typeof Reflect === 'undefined' || !Reflect.construct) return false;\n    if (Reflect.construct.sham) return false;\n    if (typeof Proxy === 'function') return true;\n    try {\n      Date.prototype.toString.call(Reflect.construct(Date, [], function () {}));\n      return true;\n    } catch (e) {\n      return false;\n    }\n  }\n  function _construct(Parent, args, Class) {\n    if (isNativeReflectConstruct()) {\n      _construct = Reflect.construct;\n    } else {\n      _construct = function _construct(Parent, args, Class) {\n        var a = [null];\n        a.push.apply(a, args);\n        var Constructor = Function.bind.apply(Parent, a);\n        var instance = new Constructor();\n        if (Class) _setPrototypeOf(instance, Class.prototype);\n        return instance;\n      };\n    }\n    return _construct.apply(null, arguments);\n  }\n  function _isNativeFunction(fn) {\n    return Function.toString.call(fn).indexOf('[native code]') !== -1;\n  }\n  function _wrapNativeSuper(Class) {\n    var _cache = typeof Map === 'function' ? new Map() : undefined;\n    _wrapNativeSuper = function _wrapNativeSuper(Class) {\n      if (Class === null || !_isNativeFunction(Class)) return Class;\n      if (typeof Class !== 'function') {\n        throw new TypeError('Super expression must either be null or a function');\n      }\n      if (typeof _cache !== 'undefined') {\n        if (_cache.has(Class)) return _cache.get(Class);\n        _cache.set(Class, Wrapper);\n      }\n      function Wrapper() {\n        return _construct(Class, arguments, _getPrototypeOf(this).constructor);\n      }\n      Wrapper.prototype = Object.create(Class.prototype, {\n        constructor: {\n          value: Wrapper,\n          enumerable: false,\n          writable: true,\n          configurable: true\n        }\n      });\n      return _setPrototypeOf(Wrapper, Class);\n    };\n    return _wrapNativeSuper(Class);\n  }\n  function _instanceof(left, right) {\n    if (right != null && typeof Symbol !== 'undefined' && right[Symbol.hasInstance]) {\n      return right[Symbol.hasInstance](left);\n    } else {\n      return left instanceof right;\n    }\n  }\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  }\n  function _interopRequireWildcard(obj) {\n    if (obj && obj.__esModule) {\n      return obj;\n    } else {\n      var newObj = {};\n      if (obj != null) {\n        for (var key in obj) {\n          if (Object.prototype.hasOwnProperty.call(obj, key)) {\n            var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {};\n            if (desc.get || desc.set) {\n              Object.defineProperty(newObj, key, desc);\n            } else {\n              newObj[key] = obj[key];\n            }\n          }\n        }\n      }\n      newObj.default = obj;\n      return newObj;\n    }\n  }\n  function _newArrowCheck(innerThis, boundThis) {\n    if (innerThis !== boundThis) {\n      throw new TypeError('Cannot instantiate an arrow function');\n    }\n  }\n  function _objectDestructuringEmpty(obj) {\n    if (obj == null) throw new TypeError('Cannot destructure undefined');\n  }\n  function _objectWithoutPropertiesLoose(source, excluded) {\n    if (source == null) return {};\n    var target = {};\n    var sourceKeys = Object.keys(source);\n    var key, i;\n    for (i = 0; i < sourceKeys.length; i++) {\n      key = sourceKeys[i];\n      if (excluded.indexOf(key) >= 0) continue;\n      target[key] = source[key];\n    }\n    return target;\n  }\n  function _objectWithoutProperties(source, excluded) {\n    if (source == null) return {};\n    var target = _objectWithoutPropertiesLoose(source, excluded);\n    var key, i;\n    if (Object.getOwnPropertySymbols) {\n      var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n      for (i = 0; i < sourceSymbolKeys.length; i++) {\n        key = sourceSymbolKeys[i];\n        if (excluded.indexOf(key) >= 0) continue;\n        if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n        target[key] = source[key];\n      }\n    }\n    return target;\n  }\n  function _assertThisInitialized(self) {\n    if (self === void 0) {\n      throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n    }\n    return self;\n  }\n  function _possibleConstructorReturn(self, call) {\n    if (call && (typeof call === 'object' || typeof call === 'function')) {\n      return call;\n    }\n    return _assertThisInitialized(self);\n  }\n  function _superPropBase(object, property) {\n    while (!Object.prototype.hasOwnProperty.call(object, property)) {\n      object = _getPrototypeOf(object);\n      if (object === null) break;\n    }\n    return object;\n  }\n  function _get(target, property, receiver) {\n    if (typeof Reflect !== 'undefined' && Reflect.get) {\n      _get = Reflect.get;\n    } else {\n      _get = function _get(target, property, receiver) {\n        var base = _superPropBase(target, property);\n        if (!base) return;\n        var desc = Object.getOwnPropertyDescriptor(base, property);\n        if (desc.get) {\n          return desc.get.call(receiver);\n        }\n        return desc.value;\n      };\n    }\n    return _get(target, property, receiver || target);\n  }\n  function set(target, property, value, receiver) {\n    if (typeof Reflect !== 'undefined' && Reflect.set) {\n      set = Reflect.set;\n    } else {\n      set = function set(target, property, value, receiver) {\n        var base = _superPropBase(target, property);\n        var desc;\n        if (base) {\n          desc = Object.getOwnPropertyDescriptor(base, property);\n          if (desc.set) {\n            desc.set.call(receiver, value);\n            return true;\n          } else if (!desc.writable) {\n            return false;\n          }\n        }\n        desc = Object.getOwnPropertyDescriptor(receiver, property);\n        if (desc) {\n          if (!desc.writable) {\n            return false;\n          }\n          desc.value = value;\n          Object.defineProperty(receiver, property, desc);\n        } else {\n          _defineProperty(receiver, property, value);\n        }\n        return true;\n      };\n    }\n    return set(target, property, value, receiver);\n  }\n  function _set(target, property, value, receiver, isStrict) {\n    var s = set(target, property, value, receiver || target);\n    if (!s && isStrict) {\n      throw new Error('failed to set property');\n    }\n    return value;\n  }\n  function _taggedTemplateLiteral(strings, raw) {\n    if (!raw) {\n      raw = strings.slice(0);\n    }\n    return Object.freeze(Object.defineProperties(strings, {\n      raw: {\n        value: Object.freeze(raw)\n      }\n    }));\n  }\n  function _taggedTemplateLiteralLoose(strings, raw) {\n    if (!raw) {\n      raw = strings.slice(0);\n    }\n    strings.raw = raw;\n    return strings;\n  }\n  function _temporalRef(val, name) {\n    if (val === _temporalUndefined) {\n      throw new ReferenceError(name + ' is not defined - temporal dead zone');\n    } else {\n      return val;\n    }\n  }\n  function _readOnlyError(name) {\n    throw new Error('\"' + name + '\" is read-only');\n  }\n  function _classNameTDZError(name) {\n    throw new Error('Class \"' + name + '\" cannot be referenced in computed property keys.');\n  }\n  var _temporalUndefined = {};\n  function _slicedToArray(arr, i) {\n    return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _nonIterableRest();\n  }\n  function _slicedToArrayLoose(arr, i) {\n    return _arrayWithHoles(arr) || _iterableToArrayLimitLoose(arr, i) || _nonIterableRest();\n  }\n  function _toArray(arr) {\n    return _arrayWithHoles(arr) || _iterableToArray(arr) || _nonIterableRest();\n  }\n  function _toConsumableArray(arr) {\n    return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread();\n  }\n  function _arrayWithoutHoles(arr) {\n    if (Array.isArray(arr)) {\n      for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) arr2[i] = arr[i];\n      return arr2;\n    }\n  }\n  function _arrayWithHoles(arr) {\n    if (Array.isArray(arr)) return arr;\n  }\n  function _iterableToArray(iter) {\n    if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === '[object Arguments]') return Array.from(iter);\n  }\n  function _iterableToArrayLimit(arr, i) {\n    var _arr = [];\n    var _n = true;\n    var _d = false;\n    var _e = undefined;\n    try {\n      for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n        _arr.push(_s.value);\n        if (i && _arr.length === i) break;\n      }\n    } catch (err) {\n      _d = true;\n      _e = err;\n    } finally {\n      try {\n        if (!_n && _i['return'] != null) _i['return']();\n      } finally {\n        if (_d) throw _e;\n      }\n    }\n    return _arr;\n  }\n  function _iterableToArrayLimitLoose(arr, i) {\n    var _arr = [];\n    for (var _iterator = arr[Symbol.iterator](), _step; !(_step = _iterator.next()).done;) {\n      _arr.push(_step.value);\n      if (i && _arr.length === i) break;\n    }\n    return _arr;\n  }\n  function _nonIterableSpread() {\n    throw new TypeError('Invalid attempt to spread non-iterable instance');\n  }\n  function _nonIterableRest() {\n    throw new TypeError('Invalid attempt to destructure non-iterable instance');\n  }\n  function _skipFirstGeneratorNext(fn) {\n    return function () {\n      var it = fn.apply(this, arguments);\n      it.next();\n      return it;\n    };\n  }\n  function _toPrimitive(input, hint) {\n    if (typeof input !== 'object' || input === null) return input;\n    var prim = input[Symbol.toPrimitive];\n    if (prim !== undefined) {\n      var res = prim.call(input, hint || 'default');\n      if (typeof res !== 'object') return res;\n      throw new TypeError('@@toPrimitive must return a primitive value.');\n    }\n    return (hint === 'string' ? String : Number)(input);\n  }\n  function _toPropertyKey(arg) {\n    var key = _toPrimitive(arg, 'string');\n    return typeof key === 'symbol' ? key : String(key);\n  }\n  function _initializerWarningHelper(descriptor, context) {\n    throw new Error('Decorating class property failed. Please ensure that ' + 'proposal-class-properties is enabled and set to use loose mode. ' + 'To use proposal-class-properties in spec mode with decorators, wait for ' + 'the next major version of decorators in stage 2.');\n  }\n  function _initializerDefineProperty(target, property, descriptor, context) {\n    if (!descriptor) return;\n    Object.defineProperty(target, property, {\n      enumerable: descriptor.enumerable,\n      configurable: descriptor.configurable,\n      writable: descriptor.writable,\n      value: descriptor.initializer ? descriptor.initializer.call(context) : void 0\n    });\n  }\n  function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) {\n    var desc = {};\n    Object.keys(descriptor).forEach(function (key) {\n      desc[key] = descriptor[key];\n    });\n    desc.enumerable = !!desc.enumerable;\n    desc.configurable = !!desc.configurable;\n    if ('value' in desc || desc.initializer) {\n      desc.writable = true;\n    }\n    desc = decorators.slice().reverse().reduce(function (desc, decorator) {\n      return decorator(target, property, desc) || desc;\n    }, desc);\n    if (context && desc.initializer !== void 0) {\n      desc.value = desc.initializer ? desc.initializer.call(context) : void 0;\n      desc.initializer = undefined;\n    }\n    if (desc.initializer === void 0) {\n      Object.defineProperty(target, property, desc);\n      desc = null;\n    }\n    return desc;\n  }\n  var id = 0;\n  function _classPrivateFieldLooseKey(name) {\n    return '__private_' + id++ + '_' + name;\n  }\n  function _classPrivateFieldLooseBase(receiver, privateKey) {\n    if (!Object.prototype.hasOwnProperty.call(receiver, privateKey)) {\n      throw new TypeError('attempted to use private field on non-instance');\n    }\n    return receiver;\n  }\n  function _classPrivateFieldGet(receiver, privateMap) {\n    if (!privateMap.has(receiver)) {\n      throw new TypeError('attempted to get private field on non-instance');\n    }\n    var descriptor = privateMap.get(receiver);\n    if (descriptor.get) {\n      return descriptor.get.call(receiver);\n    }\n    return descriptor.value;\n  }\n  function _classPrivateFieldSet(receiver, privateMap, value) {\n    if (!privateMap.has(receiver)) {\n      throw new TypeError('attempted to set private field on non-instance');\n    }\n    var descriptor = privateMap.get(receiver);\n    if (descriptor.set) {\n      descriptor.set.call(receiver, value);\n    } else {\n      if (!descriptor.writable) {\n        throw new TypeError('attempted to set read only private field');\n      }\n      descriptor.value = value;\n    }\n    return value;\n  }\n  function _classStaticPrivateFieldSpecGet(receiver, classConstructor, descriptor) {\n    if (receiver !== classConstructor) {\n      throw new TypeError('Private static access of wrong provenance');\n    }\n    return descriptor.value;\n  }\n  function _classStaticPrivateFieldSpecSet(receiver, classConstructor, descriptor, value) {\n    if (receiver !== classConstructor) {\n      throw new TypeError('Private static access of wrong provenance');\n    }\n    if (!descriptor.writable) {\n      throw new TypeError('attempted to set read only private field');\n    }\n    descriptor.value = value;\n    return value;\n  }\n  function _classStaticPrivateMethodGet(receiver, classConstructor, method) {\n    if (receiver !== classConstructor) {\n      throw new TypeError('Private static access of wrong provenance');\n    }\n    return method;\n  }\n  function _classStaticPrivateMethodSet() {\n    throw new TypeError('attempted to set read only static private field');\n  }\n  function _decorate(decorators, factory, superClass, mixins) {\n    var api = _getDecoratorsApi();\n    if (mixins) {\n      for (var i = 0; i < mixins.length; i++) {\n        api = mixins[i](api);\n      }\n    }\n    var r = factory(function initialize(O) {\n      api.initializeInstanceElements(O, decorated.elements);\n    }, superClass);\n    var decorated = api.decorateClass(_coalesceClassElements(r.d.map(_createElementDescriptor)), decorators);\n    api.initializeClassElements(r.F, decorated.elements);\n    return api.runClassFinishers(r.F, decorated.finishers);\n  }\n  function _getDecoratorsApi() {\n    _getDecoratorsApi = function () {\n      return api;\n    };\n    var api = {\n      elementsDefinitionOrder: [['method'], ['field']],\n      initializeInstanceElements: function (O, elements) {\n        ['method', 'field'].forEach(function (kind) {\n          elements.forEach(function (element) {\n            if (element.kind === kind && element.placement === 'own') {\n              this.defineClassElement(O, element);\n            }\n          }, this);\n        }, this);\n      },\n      initializeClassElements: function (F, elements) {\n        var proto = F.prototype;\n        ['method', 'field'].forEach(function (kind) {\n          elements.forEach(function (element) {\n            var placement = element.placement;\n            if (element.kind === kind && (placement === 'static' || placement === 'prototype')) {\n              var receiver = placement === 'static' ? F : proto;\n              this.defineClassElement(receiver, element);\n            }\n          }, this);\n        }, this);\n      },\n      defineClassElement: function (receiver, element) {\n        var descriptor = element.descriptor;\n        if (element.kind === 'field') {\n          var initializer = element.initializer;\n          descriptor = {\n            enumerable: descriptor.enumerable,\n            writable: descriptor.writable,\n            configurable: descriptor.configurable,\n            value: initializer === void 0 ? void 0 : initializer.call(receiver)\n          };\n        }\n        Object.defineProperty(receiver, element.key, descriptor);\n      },\n      decorateClass: function (elements, decorators) {\n        var newElements = [];\n        var finishers = [];\n        var placements = {\n          static: [],\n          prototype: [],\n          own: []\n        };\n        elements.forEach(function (element) {\n          this.addElementPlacement(element, placements);\n        }, this);\n        elements.forEach(function (element) {\n          if (!_hasDecorators(element)) return newElements.push(element);\n          var elementFinishersExtras = this.decorateElement(element, placements);\n          newElements.push(elementFinishersExtras.element);\n          newElements.push.apply(newElements, elementFinishersExtras.extras);\n          finishers.push.apply(finishers, elementFinishersExtras.finishers);\n        }, this);\n        if (!decorators) {\n          return {\n            elements: newElements,\n            finishers: finishers\n          };\n        }\n        var result = this.decorateConstructor(newElements, decorators);\n        finishers.push.apply(finishers, result.finishers);\n        result.finishers = finishers;\n        return result;\n      },\n      addElementPlacement: function (element, placements, silent) {\n        var keys = placements[element.placement];\n        if (!silent && keys.indexOf(element.key) !== -1) {\n          throw new TypeError('Duplicated element (' + element.key + ')');\n        }\n        keys.push(element.key);\n      },\n      decorateElement: function (element, placements) {\n        var extras = [];\n        var finishers = [];\n        for (var decorators = element.decorators, i = decorators.length - 1; i >= 0; i--) {\n          var keys = placements[element.placement];\n          keys.splice(keys.indexOf(element.key), 1);\n          var elementObject = this.fromElementDescriptor(element);\n          var elementFinisherExtras = this.toElementFinisherExtras((0, decorators[i])(elementObject) || elementObject);\n          element = elementFinisherExtras.element;\n          this.addElementPlacement(element, placements);\n          if (elementFinisherExtras.finisher) {\n            finishers.push(elementFinisherExtras.finisher);\n          }\n          var newExtras = elementFinisherExtras.extras;\n          if (newExtras) {\n            for (var j = 0; j < newExtras.length; j++) {\n              this.addElementPlacement(newExtras[j], placements);\n            }\n            extras.push.apply(extras, newExtras);\n          }\n        }\n        return {\n          element: element,\n          finishers: finishers,\n          extras: extras\n        };\n      },\n      decorateConstructor: function (elements, decorators) {\n        var finishers = [];\n        for (var i = decorators.length - 1; i >= 0; i--) {\n          var obj = this.fromClassDescriptor(elements);\n          var elementsAndFinisher = this.toClassDescriptor((0, decorators[i])(obj) || obj);\n          if (elementsAndFinisher.finisher !== undefined) {\n            finishers.push(elementsAndFinisher.finisher);\n          }\n          if (elementsAndFinisher.elements !== undefined) {\n            elements = elementsAndFinisher.elements;\n            for (var j = 0; j < elements.length - 1; j++) {\n              for (var k = j + 1; k < elements.length; k++) {\n                if (elements[j].key === elements[k].key && elements[j].placement === elements[k].placement) {\n                  throw new TypeError('Duplicated element (' + elements[j].key + ')');\n                }\n              }\n            }\n          }\n        }\n        return {\n          elements: elements,\n          finishers: finishers\n        };\n      },\n      fromElementDescriptor: function (element) {\n        var obj = {\n          kind: element.kind,\n          key: element.key,\n          placement: element.placement,\n          descriptor: element.descriptor\n        };\n        var desc = {\n          value: 'Descriptor',\n          configurable: true\n        };\n        Object.defineProperty(obj, Symbol.toStringTag, desc);\n        if (element.kind === 'field') obj.initializer = element.initializer;\n        return obj;\n      },\n      toElementDescriptors: function (elementObjects) {\n        if (elementObjects === undefined) return;\n        return _toArray(elementObjects).map(function (elementObject) {\n          var element = this.toElementDescriptor(elementObject);\n          this.disallowProperty(elementObject, 'finisher', 'An element descriptor');\n          this.disallowProperty(elementObject, 'extras', 'An element descriptor');\n          return element;\n        }, this);\n      },\n      toElementDescriptor: function (elementObject) {\n        var kind = String(elementObject.kind);\n        if (kind !== 'method' && kind !== 'field') {\n          throw new TypeError('An element descriptor\\'s .kind property must be either \"method\" or' + ' \"field\", but a decorator created an element descriptor with' + ' .kind \"' + kind + '\"');\n        }\n        var key = _toPropertyKey(elementObject.key);\n        var placement = String(elementObject.placement);\n        if (placement !== 'static' && placement !== 'prototype' && placement !== 'own') {\n          throw new TypeError('An element descriptor\\'s .placement property must be one of \"static\",' + ' \"prototype\" or \"own\", but a decorator created an element descriptor' + ' with .placement \"' + placement + '\"');\n        }\n        var descriptor = elementObject.descriptor;\n        this.disallowProperty(elementObject, 'elements', 'An element descriptor');\n        var element = {\n          kind: kind,\n          key: key,\n          placement: placement,\n          descriptor: Object.assign({}, descriptor)\n        };\n        if (kind !== 'field') {\n          this.disallowProperty(elementObject, 'initializer', 'A method descriptor');\n        } else {\n          this.disallowProperty(descriptor, 'get', 'The property descriptor of a field descriptor');\n          this.disallowProperty(descriptor, 'set', 'The property descriptor of a field descriptor');\n          this.disallowProperty(descriptor, 'value', 'The property descriptor of a field descriptor');\n          element.initializer = elementObject.initializer;\n        }\n        return element;\n      },\n      toElementFinisherExtras: function (elementObject) {\n        var element = this.toElementDescriptor(elementObject);\n        var finisher = _optionalCallableProperty(elementObject, 'finisher');\n        var extras = this.toElementDescriptors(elementObject.extras);\n        return {\n          element: element,\n          finisher: finisher,\n          extras: extras\n        };\n      },\n      fromClassDescriptor: function (elements) {\n        var obj = {\n          kind: 'class',\n          elements: elements.map(this.fromElementDescriptor, this)\n        };\n        var desc = {\n          value: 'Descriptor',\n          configurable: true\n        };\n        Object.defineProperty(obj, Symbol.toStringTag, desc);\n        return obj;\n      },\n      toClassDescriptor: function (obj) {\n        var kind = String(obj.kind);\n        if (kind !== 'class') {\n          throw new TypeError('A class descriptor\\'s .kind property must be \"class\", but a decorator' + ' created a class descriptor with .kind \"' + kind + '\"');\n        }\n        this.disallowProperty(obj, 'key', 'A class descriptor');\n        this.disallowProperty(obj, 'placement', 'A class descriptor');\n        this.disallowProperty(obj, 'descriptor', 'A class descriptor');\n        this.disallowProperty(obj, 'initializer', 'A class descriptor');\n        this.disallowProperty(obj, 'extras', 'A class descriptor');\n        var finisher = _optionalCallableProperty(obj, 'finisher');\n        var elements = this.toElementDescriptors(obj.elements);\n        return {\n          elements: elements,\n          finisher: finisher\n        };\n      },\n      runClassFinishers: function (constructor, finishers) {\n        for (var i = 0; i < finishers.length; i++) {\n          var newConstructor = (0, finishers[i])(constructor);\n          if (newConstructor !== undefined) {\n            if (typeof newConstructor !== 'function') {\n              throw new TypeError('Finishers must return a constructor.');\n            }\n            constructor = newConstructor;\n          }\n        }\n        return constructor;\n      },\n      disallowProperty: function (obj, name, objectType) {\n        if (obj[name] !== undefined) {\n          throw new TypeError(objectType + \" can't have a .\" + name + ' property.');\n        }\n      }\n    };\n    return api;\n  }\n  function _createElementDescriptor(def) {\n    var key = _toPropertyKey(def.key);\n    var descriptor;\n    if (def.kind === 'method') {\n      descriptor = {\n        value: def.value,\n        writable: true,\n        configurable: true,\n        enumerable: false\n      };\n    } else if (def.kind === 'get') {\n      descriptor = {\n        get: def.value,\n        configurable: true,\n        enumerable: false\n      };\n    } else if (def.kind === 'set') {\n      descriptor = {\n        set: def.value,\n        configurable: true,\n        enumerable: false\n      };\n    } else if (def.kind === 'field') {\n      descriptor = {\n        configurable: true,\n        writable: true,\n        enumerable: true\n      };\n    }\n    var element = {\n      kind: def.kind === 'field' ? 'field' : 'method',\n      key: key,\n      placement: def.static ? 'static' : def.kind === 'field' ? 'own' : 'prototype',\n      descriptor: descriptor\n    };\n    if (def.decorators) element.decorators = def.decorators;\n    if (def.kind === 'field') element.initializer = def.value;\n    return element;\n  }\n  function _coalesceGetterSetter(element, other) {\n    if (element.descriptor.get !== undefined) {\n      other.descriptor.get = element.descriptor.get;\n    } else {\n      other.descriptor.set = element.descriptor.set;\n    }\n  }\n  function _coalesceClassElements(elements) {\n    var newElements = [];\n    var isSameElement = function (other) {\n      return other.kind === 'method' && other.key === element.key && other.placement === element.placement;\n    };\n    for (var i = 0; i < elements.length; i++) {\n      var element = elements[i];\n      var other;\n      if (element.kind === 'method' && (other = newElements.find(isSameElement))) {\n        if (_isDataDescriptor(element.descriptor) || _isDataDescriptor(other.descriptor)) {\n          if (_hasDecorators(element) || _hasDecorators(other)) {\n            throw new ReferenceError('Duplicated methods (' + element.key + \") can't be decorated.\");\n          }\n          other.descriptor = element.descriptor;\n        } else {\n          if (_hasDecorators(element)) {\n            if (_hasDecorators(other)) {\n              throw new ReferenceError(\"Decorators can't be placed on different accessors with for \" + 'the same property (' + element.key + ').');\n            }\n            other.decorators = element.decorators;\n          }\n          _coalesceGetterSetter(element, other);\n        }\n      } else {\n        newElements.push(element);\n      }\n    }\n    return newElements;\n  }\n  function _hasDecorators(element) {\n    return element.decorators && element.decorators.length;\n  }\n  function _isDataDescriptor(desc) {\n    return desc !== undefined && !(desc.value === undefined && desc.writable === undefined);\n  }\n  function _optionalCallableProperty(obj, name) {\n    var value = obj[name];\n    if (value !== undefined && typeof value !== 'function') {\n      throw new TypeError(\"Expected '\" + name + \"' to be a function\");\n    }\n    return value;\n  }\n  function _classPrivateMethodGet(receiver, privateSet, fn) {\n    if (!privateSet.has(receiver)) {\n      throw new TypeError('attempted to get private field on non-instance');\n    }\n    return fn;\n  }\n  function _classPrivateMethodSet() {\n    throw new TypeError('attempted to reassign private method');\n  }\n  function _wrapRegExp(re, groups) {\n    _wrapRegExp = function (re, groups) {\n      return new BabelRegExp(re, groups);\n    };\n    var _RegExp = _wrapNativeSuper(RegExp);\n    var _super = RegExp.prototype;\n    var _groups = new WeakMap();\n    function BabelRegExp(re, groups) {\n      var _this = _RegExp.call(this, re);\n      _groups.set(_this, groups);\n      return _this;\n    }\n    _inherits(BabelRegExp, _RegExp);\n    BabelRegExp.prototype.exec = function (str) {\n      var result = _super.exec.call(this, str);\n      if (result) result.groups = buildGroups(result, this);\n      return result;\n    };\n    BabelRegExp.prototype[Symbol.replace] = function (str, substitution) {\n      if (typeof substitution === 'string') {\n        var groups = _groups.get(this);\n        return _super[Symbol.replace].call(this, str, substitution.replace(/\\$<([^>]+)>/g, function (_, name) {\n          return '$' + groups[name];\n        }));\n      } else if (typeof substitution === 'function') {\n        var _this = this;\n        return _super[Symbol.replace].call(this, str, function () {\n          var args = [];\n          args.push.apply(args, arguments);\n          if (typeof args[args.length - 1] !== 'object') {\n            args.push(buildGroups(args, _this));\n          }\n          return substitution.apply(this, args);\n        });\n      } else {\n        return _super[Symbol.replace].call(this, str, substitution);\n      }\n    };\n    function buildGroups(result, re) {\n      var g = _groups.get(re);\n      return Object.keys(g).reduce(function (groups, name) {\n        groups[name] = result[g[name]];\n        return groups;\n      }, Object.create(null));\n    }\n    return _wrapRegExp.apply(this, arguments);\n  }\n  var MARKUP_RECT = ['x', 'y', 'left', 'top', 'right', 'bottom', 'width', 'height'];\n  var toOptionalFraction = function toOptionalFraction(value) {\n    return typeof value === 'string' && /%/.test(value) ? parseFloat(value) / 100 : value;\n  };\n\n  // adds default markup properties, clones markup\n  var prepareMarkup = function prepareMarkup(markup) {\n    var _markup = _slicedToArray(markup, 2),\n      type = _markup[0],\n      props = _markup[1];\n    var rect = props.points ? {} : MARKUP_RECT.reduce(function (prev, curr) {\n      prev[curr] = toOptionalFraction(props[curr]);\n      return prev;\n    }, {});\n    return [type, Object.assign({\n      zIndex: 0\n    }, props, rect)];\n  };\n  var getImageSize = function getImageSize(file) {\n    return new Promise(function (resolve, reject) {\n      var imageElement = new Image();\n      imageElement.src = URL.createObjectURL(file);\n\n      // start testing size\n      var measure = function measure() {\n        var width = imageElement.naturalWidth;\n        var height = imageElement.naturalHeight;\n        var hasSize = width && height;\n        if (!hasSize) return;\n        URL.revokeObjectURL(imageElement.src);\n        clearInterval(intervalId);\n        resolve({\n          width: width,\n          height: height\n        });\n      };\n      imageElement.onerror = function (err) {\n        URL.revokeObjectURL(imageElement.src);\n        clearInterval(intervalId);\n        reject(err);\n      };\n      var intervalId = setInterval(measure, 1);\n      measure();\n    });\n  };\n\n  /**\n   * Polyfill Edge and IE when in Browser\n   */\n  if (typeof window !== 'undefined' && typeof window.document !== 'undefined') {\n    if (!HTMLCanvasElement.prototype.toBlob) {\n      Object.defineProperty(HTMLCanvasElement.prototype, 'toBlob', {\n        value: function value(cb, type, quality) {\n          var canvas = this;\n          setTimeout(function () {\n            var dataURL = canvas.toDataURL(type, quality).split(',')[1];\n            var binStr = atob(dataURL);\n            var index = binStr.length;\n            var data = new Uint8Array(index);\n            while (index--) {\n              data[index] = binStr.charCodeAt(index);\n            }\n            cb(new Blob([data], {\n              type: type || 'image/png'\n            }));\n          });\n        }\n      });\n    }\n  }\n  var isBrowser = typeof window !== 'undefined' && typeof window.document !== 'undefined';\n  var isIOS = isBrowser && /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;\n\n  /**\n   * Image Transform Plugin\n   */\n  var plugin = function plugin(_ref) {\n    var addFilter = _ref.addFilter,\n      utils = _ref.utils;\n    var Type = utils.Type,\n      forin = utils.forin,\n      getFileFromBlob = utils.getFileFromBlob,\n      isFile = utils.isFile;\n\n    /**\n     * Helper functions\n     */\n\n    // valid transforms (in correct order)\n    var TRANSFORM_LIST = ['crop', 'resize', 'filter', 'markup', 'output'];\n    var createVariantCreator = function createVariantCreator(updateMetadata) {\n      return function (transform, file, metadata) {\n        return transform(file, updateMetadata ? updateMetadata(metadata) : metadata);\n      };\n    };\n    var isDefaultCrop = function isDefaultCrop(crop) {\n      return crop.aspectRatio === null && crop.rotation === 0 && crop.zoom === 1 && crop.center && crop.center.x === 0.5 && crop.center.y === 0.5 && crop.flip && crop.flip.horizontal === false && crop.flip.vertical === false;\n    };\n\n    /**\n     * Filters\n     */\n    addFilter('SHOULD_PREPARE_OUTPUT', function (shouldPrepareOutput, _ref2) {\n      var query = _ref2.query;\n      return new Promise(function (resolve) {\n        // If is not async should prepare now\n        resolve(!query('IS_ASYNC'));\n      });\n    });\n    var shouldTransformFile = function shouldTransformFile(query, file, item) {\n      return new Promise(function (resolve) {\n        if (!query('GET_ALLOW_IMAGE_TRANSFORM') || item.archived || !isFile(file) || !isImage(file)) {\n          return resolve(false);\n        }\n\n        // if size can't be read this browser doesn't support image\n        getImageSize(file).then(function () {\n          var fn = query('GET_IMAGE_TRANSFORM_IMAGE_FILTER');\n          if (fn) {\n            var filterResult = fn(file);\n            if (filterResult == null) {\n              // undefined or null\n              return handleRevert(true);\n            }\n            if (typeof filterResult === 'boolean') {\n              return resolve(filterResult);\n            }\n            if (typeof filterResult.then === 'function') {\n              return filterResult.then(resolve);\n            }\n          }\n          resolve(true);\n        }).catch(function (err) {\n          resolve(false);\n        });\n      });\n    };\n    addFilter('DID_CREATE_ITEM', function (item, _ref3) {\n      var query = _ref3.query,\n        dispatch = _ref3.dispatch;\n      if (!query('GET_ALLOW_IMAGE_TRANSFORM')) return;\n      item.extend('requestPrepare', function () {\n        return new Promise(function (resolve, reject) {\n          dispatch('REQUEST_PREPARE_OUTPUT', {\n            query: item.id,\n            item: item,\n            success: resolve,\n            failure: reject\n          }, true);\n        });\n      });\n    });\n\n    // subscribe to file transformations\n    addFilter('PREPARE_OUTPUT', function (file, _ref4) {\n      var query = _ref4.query,\n        item = _ref4.item;\n      return new Promise(function (resolve) {\n        shouldTransformFile(query, file, item).then(function (shouldTransform) {\n          // no need to transform, exit\n          if (!shouldTransform) return resolve(file);\n\n          // get variants\n          var variants = [];\n\n          // add original file\n          if (query('GET_IMAGE_TRANSFORM_VARIANTS_INCLUDE_ORIGINAL')) {\n            variants.push(function () {\n              return new Promise(function (resolve) {\n                resolve({\n                  name: query('GET_IMAGE_TRANSFORM_VARIANTS_ORIGINAL_NAME'),\n                  file: file\n                });\n              });\n            });\n          }\n\n          // add default output version if output default set to true or if no variants defined\n          if (query('GET_IMAGE_TRANSFORM_VARIANTS_INCLUDE_DEFAULT')) {\n            variants.push(function (transform, file, metadata) {\n              return new Promise(function (resolve) {\n                transform(file, metadata).then(function (file) {\n                  return resolve({\n                    name: query('GET_IMAGE_TRANSFORM_VARIANTS_DEFAULT_NAME'),\n                    file: file\n                  });\n                });\n              });\n            });\n          }\n\n          // get other variants\n          var variantsDefinition = query('GET_IMAGE_TRANSFORM_VARIANTS') || {};\n          forin(variantsDefinition, function (key, fn) {\n            var createVariant = createVariantCreator(fn);\n            variants.push(function (transform, file, metadata) {\n              return new Promise(function (resolve) {\n                createVariant(transform, file, metadata).then(function (file) {\n                  return resolve({\n                    name: key,\n                    file: file\n                  });\n                });\n              });\n            });\n          });\n\n          // output format (quality 0 => 100)\n          var qualityAsPercentage = query('GET_IMAGE_TRANSFORM_OUTPUT_QUALITY');\n          var qualityMode = query('GET_IMAGE_TRANSFORM_OUTPUT_QUALITY_MODE');\n          var quality = qualityAsPercentage === null ? null : qualityAsPercentage / 100;\n          var type = query('GET_IMAGE_TRANSFORM_OUTPUT_MIME_TYPE');\n          var clientTransforms = query('GET_IMAGE_TRANSFORM_CLIENT_TRANSFORMS') || TRANSFORM_LIST;\n\n          // update transform metadata object\n          item.setMetadata('output', {\n            type: type,\n            quality: quality,\n            client: clientTransforms\n          }, true);\n\n          // the function that is used to apply the file transformations\n          var transform = function transform(file, metadata) {\n            return new Promise(function (resolve, reject) {\n              var filteredMetadata = Object.assign({}, metadata);\n              Object.keys(filteredMetadata).filter(function (instruction) {\n                return instruction !== 'exif';\n              }).forEach(function (instruction) {\n                // if not in list, remove from object, the instruction will be handled by the server\n                if (clientTransforms.indexOf(instruction) === -1) {\n                  delete filteredMetadata[instruction];\n                }\n              });\n              var resize = filteredMetadata.resize,\n                exif = filteredMetadata.exif,\n                output = filteredMetadata.output,\n                crop = filteredMetadata.crop,\n                filter = filteredMetadata.filter,\n                markup = filteredMetadata.markup;\n              var instructions = {\n                image: {\n                  orientation: exif ? exif.orientation : null\n                },\n                output: output && (output.type || typeof output.quality === 'number' || output.background) ? {\n                  type: output.type,\n                  quality: typeof output.quality === 'number' ? output.quality * 100 : null,\n                  background: output.background || query('GET_IMAGE_TRANSFORM_CANVAS_BACKGROUND_COLOR') || null\n                } : undefined,\n                size: resize && (resize.size.width || resize.size.height) ? Object.assign({\n                  mode: resize.mode,\n                  upscale: resize.upscale\n                }, resize.size) : undefined,\n                crop: crop && !isDefaultCrop(crop) ? Object.assign({}, crop) : undefined,\n                markup: markup && markup.length ? markup.map(prepareMarkup) : [],\n                filter: filter\n              };\n              if (instructions.output) {\n                // determine if file type will change\n                var willChangeType = output.type ?\n                // type set\n                output.type !== file.type :\n                // type not set\n                false;\n                var canChangeQuality = /\\/jpe?g$/.test(file.type);\n                var willChangeQuality = output.quality !== null ?\n                // quality set\n                canChangeQuality && qualityMode === 'always' :\n                // quality not set\n                false;\n\n                // determine if file data will be modified\n                var willModifyImageData = !!(instructions.size || instructions.crop || instructions.filter || willChangeType || willChangeQuality);\n\n                // if we're not modifying the image data then we don't have to modify the output\n                if (!willModifyImageData) return resolve(file);\n              }\n              var options = {\n                beforeCreateBlob: query('GET_IMAGE_TRANSFORM_BEFORE_CREATE_BLOB'),\n                afterCreateBlob: query('GET_IMAGE_TRANSFORM_AFTER_CREATE_BLOB'),\n                canvasMemoryLimit: query('GET_IMAGE_TRANSFORM_CANVAS_MEMORY_LIMIT'),\n                stripImageHead: query('GET_IMAGE_TRANSFORM_OUTPUT_STRIP_IMAGE_HEAD')\n              };\n              transformImage(file, instructions, options).then(function (blob) {\n                // set file object\n                var out = getFileFromBlob(blob,\n                // rename the original filename to match the mime type of the output image\n                renameFileToMatchMimeType(file.name, getValidOutputMimeType(blob.type)));\n                resolve(out);\n              }).catch(reject);\n            });\n          };\n\n          // start creating variants\n          var variantPromises = variants.map(function (create) {\n            return create(transform, file, item.getMetadata());\n          });\n\n          // wait for results\n          Promise.all(variantPromises).then(function (files) {\n            // if single file object in array, return the single file object else, return array of\n            resolve(files.length === 1 && files[0].name === null ?\n            // return the File object\n            files[0].file :\n            // return an array of files { name:'name', file:File }\n            files);\n          });\n        });\n      });\n    });\n\n    // Expose plugin options\n    return {\n      options: {\n        allowImageTransform: [true, Type.BOOLEAN],\n        // filter images to transform\n        imageTransformImageFilter: [null, Type.FUNCTION],\n        // null, 'image/jpeg', 'image/png'\n        imageTransformOutputMimeType: [null, Type.STRING],\n        // null, 0 - 100\n        imageTransformOutputQuality: [null, Type.INT],\n        // set to false to copy image exif data to output\n        imageTransformOutputStripImageHead: [true, Type.BOOLEAN],\n        // only apply transforms in this list\n        imageTransformClientTransforms: [null, Type.ARRAY],\n        // only apply output quality when a transform is required\n        imageTransformOutputQualityMode: ['always', Type.STRING],\n        // 'always'\n        // 'optional'\n        // 'mismatch' (future feature, only applied if quality differs from input)\n\n        // get image transform variants\n        imageTransformVariants: [null, Type.OBJECT],\n        // should we post the default transformed file\n        imageTransformVariantsIncludeDefault: [true, Type.BOOLEAN],\n        // which name to prefix the default transformed file with\n        imageTransformVariantsDefaultName: [null, Type.STRING],\n        // should we post the original file\n        imageTransformVariantsIncludeOriginal: [false, Type.BOOLEAN],\n        // which name to prefix the original file with\n        imageTransformVariantsOriginalName: ['original_', Type.STRING],\n        // called before creating the blob, receives canvas, expects promise resolve with canvas\n        imageTransformBeforeCreateBlob: [null, Type.FUNCTION],\n        // expects promise resolved with blob\n        imageTransformAfterCreateBlob: [null, Type.FUNCTION],\n        // canvas memory limit\n        imageTransformCanvasMemoryLimit: [isBrowser && isIOS ? 4096 * 4096 : null, Type.INT],\n        // background image of the output canvas\n        imageTransformCanvasBackgroundColor: [null, Type.STRING]\n      }\n    };\n  };\n\n  // fire pluginloaded event if running in browser, this allows registering the plugin when using async script tags\n  if (isBrowser) {\n    document.dispatchEvent(new CustomEvent('FilePond:pluginloaded', {\n      detail: plugin\n    }));\n  }\n  return plugin;\n});","map":{"version":3,"names":["global","factory","exports","module","define","amd","self","FilePondPluginImageTransform","isImage","file","test","type","getFilenameWithoutExtension","name","substr","lastIndexOf","ExtensionMap","jpeg","renameFileToMatchMimeType","filename","mimeType","split","extension","concat","getValidOutputMimeType","isImage$1","MATRICES","_","width","height","getImageOrientationMatrix","orientation","createVector","x","y","vectorDot","a","b","vectorSubtract","vectorDistanceSquared","vectorDistance","Math","sqrt","getOffsetPointOnEdge","length","rotation","A","B","C","sinA","sin","sinB","sinC","cosC","cos","ratio","c","getRotatedRectSize","rect","w","h","hor","ver","tl","abs","tr","bl","getImageRectZoomFactor","imageRect","cropRect","arguments","undefined","center","cx","cy","imageWidth","imageHeight","rotatedCropSize","max","getCenteredCropRect","container","aspectRatio","calculateCanvasSize","image","canvasAspectRatio","zoom","imageAspectRatio","canvasWidth","canvasHeight","imgWidth","imgHeight","scalar","canvasRelease","canvas","ctx","getContext","clearRect","isFlipped","flip","horizontal","vertical","getBitmap","naturalWidth","naturalHeight","document","createElement","swapped","transform","apply","matrix","drawImage","imageToImageData","imageElement","crop","options","canvasMemoryLimit","_options$background","background","bitmap","imageSize","canvasSize","requiredMemory","floor","canvasCenter","stage","shouldLimit","scaleToFit","scale","round","imageOffset","fillStyle","fillRect","translate","rotate","imageData","getImageData","IS_BROWSER","window","HTMLCanvasElement","prototype","toBlob","Object","defineProperty","value","callback","quality","dataURL","toDataURL","setTimeout","binStr","atob","len","arr","Uint8Array","i","charCodeAt","Blob","canvasToBlob","beforeCreateBlob","Promise","resolve","promisedImage","then","vectorMultiply","v","amount","createVector$1","vectorAdd","vectorNormalize","l","vectorRotate","radians","origin","t","getMarkupValue","size","axis","parseFloat","min","getMarkupStyles","markup","lineStyle","borderStyle","fill","backgroundColor","fontColor","stroke","borderColor","lineColor","strokeWidth","borderWidth","lineWidth","lineCap","lineJoin","dashes","map","join","opacity","isDefined","getMarkupRect","left","top","right","bottom","pointsToPathShape","points","point","index","setAttributes","element","attr","keys","forEach","key","setAttribute","ns","svg","tag","createElementNS","updateRect","assign","styles","updateEllipse","rx","ry","IMAGE_FIT_STYLE","contain","cover","updateImage","preserveAspectRatio","fit","TEXT_ANCHOR","updateText","fontSize","fontFamily","fontWeight","textAlign","text","textContent","updateLine","line","childNodes","begin","end","target","x1","y1","x2","y2","lineDecoration","style","display","indexOf","arrowBeginRotationPoint","arrowBeginCenter","arrowBeginA","arrowBeginB","d","arrowEndRotationPoint","arrowEndCenter","arrowEndA","arrowEndB","updatePath","createShape","node","id","createImage","shape","onload","setAttributeNS","src","createLine","appendChild","CREATE_TYPE_ROUTES","ellipse","path","UPDATE_TYPE_ROUTES","createMarkupByType","updateMarkupByType","sortMarkupByZIndex","zIndex","cropSVG","blob","fr","FileReader","onloadend","result","original","cssText","innerHTML","originalNode","querySelector","body","bBox","getBBox","parentNode","removeChild","titleNode","viewBoxAttribute","getAttribute","widthAttribute","heightAttribute","widthUnits","match","heightUnits","viewBoxList","viewBox","overflow","markupSVG","sort","reduce","prev","el","removeAttribute","outerHTML","replace","cropCenterX","cropCenterY","canvasZoomFactor","PI","cropTransforms","cropFlipHorizontal","cropFlipVertical","flipTransforms","transformed","readAsText","objectToImageData","obj","ImageData","e","createImageData","data","set","TransformWorker","TRANSFORMS","resize","filter","applyTransforms","transforms","cb","filterTransform","resizeTransform","onmessage","message","response","postMessage","buffer","br","bg","bb","applyFilterMatrix","m","ir","ig","ib","ia","mr","mg","mb","ma","or","og","ob","identityMatrix","JSON","stringify","isIdentityMatrix","m11","m12","m13","m14","m15","m21","m22","m23","m24","m25","m31","m32","m33","m34","m35","m41","m42","m43","m44","m45","r","g","_data$mode","mode","_data$upscale","upscale","scalarWidth","scalarHeight","originWidth","originHeight","targetWidth","targetHeight","inputData","outputData","Uint8ClampedArray","ratioWidth","ratioHeight","ratioWidthHalf","ceil","ratioHeightHalf","j","weight","weights","weightsAlpha","centerY","yy","dy","centerX","w0","xx","dx","ref","correctOrientation","view","offset","getUint32","intelByteAligned","getUint16","tags","setUint16","readData","DataView","marker","markerLength","orientationCorrected","byteLength","isData","slice","getImageHead","reader","readAsArrayBuffer","getBlobBuilder","BlobBuilder","WebKitBlobBuilder","MozBlobBuilder","MSBlobBuilder","createBlob","arrayBuffer","BB","append","getBlob","getUniqueId","random","toString","createWorker","fn","workerBlob","workerURL","URL","createObjectURL","worker","Worker","trips","transfer","post","transferList","terminate","revokeObjectURL","loadImage","url","reject","img","Image","onerror","chain","funcs","promise","func","Array","bind","canvasApplyMarkup","drawers","item","TYPE_DRAW_ROUTES","applyMarkupStyles","beginPath","setLineDash","strokeStyle","globalAlpha","drawMarkupStyles","drawRect","drawEllipse","kappa","ox","oy","xe","ye","xm","ym","moveTo","bezierCurveTo","done","isCrossOriginImage","location","href","crossOrigin","ar","_width","_height","_x","_y","drawText","font","fillText","drawPath","lineTo","drawLine","imageDataToCanvas","putImageData","transformImage","instructions","status","stripImageHead","afterCreateBlob","output","qualityAsPercentage","push","resolveWithBlob","promisedBlob","promisedCanvas","imageHead","catch","outputFormat","_typeof","Symbol","iterator","constructor","REACT_ELEMENT_TYPE","_jsx","props","children","for","defaultProps","childrenLength","propName","childArray","$$typeof","_owner","_asyncIterator","iterable","method","asyncIterator","call","TypeError","_AwaitValue","wrapped","_AsyncGenerator","gen","front","back","send","arg","request","next","resume","wrappedAwait","settle","err","_invoke","return","throw","_wrapAsyncGenerator","_awaitAsyncGenerator","_asyncGeneratorDelegate","inner","awaitWrap","iter","waiting","pump","asyncGeneratorStep","_next","_throw","info","error","_asyncToGenerator","args","_classCallCheck","instance","Constructor","_defineProperties","descriptor","enumerable","configurable","writable","_createClass","protoProps","staticProps","_defineEnumerableProperties","descs","desc","getOwnPropertySymbols","objectSymbols","sym","_defaults","defaults","getOwnPropertyNames","getOwnPropertyDescriptor","_defineProperty","_extends","source","hasOwnProperty","_objectSpread","ownKeys","_inherits","subClass","superClass","create","_setPrototypeOf","_inheritsLoose","__proto__","_getPrototypeOf","o","setPrototypeOf","getPrototypeOf","p","isNativeReflectConstruct","Reflect","construct","sham","Proxy","Date","_construct","Parent","Class","Function","_isNativeFunction","_wrapNativeSuper","_cache","Map","has","get","Wrapper","_instanceof","hasInstance","_interopRequireDefault","__esModule","default","_interopRequireWildcard","newObj","_newArrowCheck","innerThis","boundThis","_objectDestructuringEmpty","_objectWithoutPropertiesLoose","excluded","sourceKeys","_objectWithoutProperties","sourceSymbolKeys","propertyIsEnumerable","_assertThisInitialized","ReferenceError","_possibleConstructorReturn","_superPropBase","object","property","_get","receiver","base","_set","isStrict","s","Error","_taggedTemplateLiteral","strings","raw","freeze","defineProperties","_taggedTemplateLiteralLoose","_temporalRef","val","_temporalUndefined","_readOnlyError","_classNameTDZError","_slicedToArray","_arrayWithHoles","_iterableToArrayLimit","_nonIterableRest","_slicedToArrayLoose","_iterableToArrayLimitLoose","_toArray","_iterableToArray","_toConsumableArray","_arrayWithoutHoles","_nonIterableSpread","isArray","arr2","from","_arr","_n","_d","_e","_i","_s","_iterator","_step","_skipFirstGeneratorNext","it","_toPrimitive","input","hint","prim","toPrimitive","res","String","Number","_toPropertyKey","_initializerWarningHelper","context","_initializerDefineProperty","initializer","_applyDecoratedDescriptor","decorators","reverse","decorator","_classPrivateFieldLooseKey","_classPrivateFieldLooseBase","privateKey","_classPrivateFieldGet","privateMap","_classPrivateFieldSet","_classStaticPrivateFieldSpecGet","classConstructor","_classStaticPrivateFieldSpecSet","_classStaticPrivateMethodGet","_classStaticPrivateMethodSet","_decorate","mixins","api","_getDecoratorsApi","initialize","O","initializeInstanceElements","decorated","elements","decorateClass","_coalesceClassElements","_createElementDescriptor","initializeClassElements","F","runClassFinishers","finishers","elementsDefinitionOrder","kind","placement","defineClassElement","proto","newElements","placements","static","own","addElementPlacement","_hasDecorators","elementFinishersExtras","decorateElement","extras","decorateConstructor","silent","splice","elementObject","fromElementDescriptor","elementFinisherExtras","toElementFinisherExtras","finisher","newExtras","fromClassDescriptor","elementsAndFinisher","toClassDescriptor","k","toStringTag","toElementDescriptors","elementObjects","toElementDescriptor","disallowProperty","_optionalCallableProperty","newConstructor","objectType","def","_coalesceGetterSetter","other","isSameElement","find","_isDataDescriptor","_classPrivateMethodGet","privateSet","_classPrivateMethodSet","_wrapRegExp","re","groups","BabelRegExp","_RegExp","RegExp","_super","_groups","WeakMap","_this","exec","str","buildGroups","substitution","MARKUP_RECT","toOptionalFraction","prepareMarkup","_markup","curr","getImageSize","measure","hasSize","clearInterval","intervalId","setInterval","isBrowser","isIOS","navigator","userAgent","MSStream","plugin","_ref","addFilter","utils","Type","forin","getFileFromBlob","isFile","TRANSFORM_LIST","createVariantCreator","updateMetadata","metadata","isDefaultCrop","shouldPrepareOutput","_ref2","query","shouldTransformFile","archived","filterResult","handleRevert","_ref3","dispatch","extend","success","failure","_ref4","shouldTransform","variants","variantsDefinition","createVariant","qualityMode","clientTransforms","setMetadata","client","filteredMetadata","instruction","exif","willChangeType","canChangeQuality","willChangeQuality","willModifyImageData","out","variantPromises","getMetadata","all","files","allowImageTransform","BOOLEAN","imageTransformImageFilter","FUNCTION","imageTransformOutputMimeType","STRING","imageTransformOutputQuality","INT","imageTransformOutputStripImageHead","imageTransformClientTransforms","ARRAY","imageTransformOutputQualityMode","imageTransformVariants","OBJECT","imageTransformVariantsIncludeDefault","imageTransformVariantsDefaultName","imageTransformVariantsIncludeOriginal","imageTransformVariantsOriginalName","imageTransformBeforeCreateBlob","imageTransformAfterCreateBlob","imageTransformCanvasMemoryLimit","imageTransformCanvasBackgroundColor","dispatchEvent","CustomEvent","detail"],"sources":["/Users/marija/Documents/GitHub/marija_cv_website/node_modules/filepond-plugin-image-transform/dist/filepond-plugin-image-transform.js"],"sourcesContent":["/*!\n * FilePondPluginImageTransform 3.8.7\n * Licensed under MIT, https://opensource.org/licenses/MIT/\n * Please visit https://pqina.nl/filepond/ for details.\n */\n\n/* eslint-disable */\n\n(function(global, factory) {\n    typeof exports === 'object' && typeof module !== 'undefined'\n        ? (module.exports = factory())\n        : typeof define === 'function' && define.amd\n        ? define(factory)\n        : ((global = global || self), (global.FilePondPluginImageTransform = factory()));\n})(this, function() {\n    'use strict';\n\n    // test if file is of type image\n    var isImage = function isImage(file) {\n        return /^image/.test(file.type);\n    };\n\n    var getFilenameWithoutExtension = function getFilenameWithoutExtension(name) {\n        return name.substr(0, name.lastIndexOf('.')) || name;\n    };\n\n    // only handles image/jpg, image/jpeg, image/png, and image/svg+xml for now\n    var ExtensionMap = {\n        jpeg: 'jpg',\n        'svg+xml': 'svg',\n    };\n\n    var renameFileToMatchMimeType = function renameFileToMatchMimeType(filename, mimeType) {\n        var name = getFilenameWithoutExtension(filename);\n        var type = mimeType.split('/')[1];\n        var extension = ExtensionMap[type] || type;\n        return ''.concat(name, '.').concat(extension);\n    };\n\n    // returns all the valid output formats we can encode towards\n    var getValidOutputMimeType = function getValidOutputMimeType(type) {\n        return /jpeg|png|svg\\+xml/.test(type) ? type : 'image/jpeg';\n    };\n\n    // test if file is of type image\n    var isImage$1 = function isImage(file) {\n        return /^image/.test(file.type);\n    };\n\n    var MATRICES = {\n        1: function _() {\n            return [1, 0, 0, 1, 0, 0];\n        },\n        2: function _(width) {\n            return [-1, 0, 0, 1, width, 0];\n        },\n        3: function _(width, height) {\n            return [-1, 0, 0, -1, width, height];\n        },\n        4: function _(width, height) {\n            return [1, 0, 0, -1, 0, height];\n        },\n        5: function _() {\n            return [0, 1, 1, 0, 0, 0];\n        },\n        6: function _(width, height) {\n            return [0, 1, -1, 0, height, 0];\n        },\n        7: function _(width, height) {\n            return [0, -1, -1, 0, height, width];\n        },\n        8: function _(width) {\n            return [0, -1, 1, 0, 0, width];\n        },\n    };\n\n    var getImageOrientationMatrix = function getImageOrientationMatrix(width, height, orientation) {\n        if (orientation === -1) {\n            orientation = 1;\n        }\n        return MATRICES[orientation](width, height);\n    };\n\n    var createVector = function createVector(x, y) {\n        return { x: x, y: y };\n    };\n\n    var vectorDot = function vectorDot(a, b) {\n        return a.x * b.x + a.y * b.y;\n    };\n\n    var vectorSubtract = function vectorSubtract(a, b) {\n        return createVector(a.x - b.x, a.y - b.y);\n    };\n\n    var vectorDistanceSquared = function vectorDistanceSquared(a, b) {\n        return vectorDot(vectorSubtract(a, b), vectorSubtract(a, b));\n    };\n\n    var vectorDistance = function vectorDistance(a, b) {\n        return Math.sqrt(vectorDistanceSquared(a, b));\n    };\n\n    var getOffsetPointOnEdge = function getOffsetPointOnEdge(length, rotation) {\n        var a = length;\n\n        var A = 1.5707963267948966;\n        var B = rotation;\n        var C = 1.5707963267948966 - rotation;\n\n        var sinA = Math.sin(A);\n        var sinB = Math.sin(B);\n        var sinC = Math.sin(C);\n        var cosC = Math.cos(C);\n        var ratio = a / sinA;\n        var b = ratio * sinB;\n        var c = ratio * sinC;\n\n        return createVector(cosC * b, cosC * c);\n    };\n\n    var getRotatedRectSize = function getRotatedRectSize(rect, rotation) {\n        var w = rect.width;\n        var h = rect.height;\n\n        var hor = getOffsetPointOnEdge(w, rotation);\n        var ver = getOffsetPointOnEdge(h, rotation);\n\n        var tl = createVector(rect.x + Math.abs(hor.x), rect.y - Math.abs(hor.y));\n\n        var tr = createVector(rect.x + rect.width + Math.abs(ver.y), rect.y + Math.abs(ver.x));\n\n        var bl = createVector(rect.x - Math.abs(ver.y), rect.y + rect.height - Math.abs(ver.x));\n\n        return {\n            width: vectorDistance(tl, tr),\n            height: vectorDistance(tl, bl),\n        };\n    };\n\n    var getImageRectZoomFactor = function getImageRectZoomFactor(imageRect, cropRect) {\n        var rotation = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n        var center =\n            arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : { x: 0.5, y: 0.5 };\n\n        // calculate available space round image center position\n        var cx = center.x > 0.5 ? 1 - center.x : center.x;\n        var cy = center.y > 0.5 ? 1 - center.y : center.y;\n        var imageWidth = cx * 2 * imageRect.width;\n        var imageHeight = cy * 2 * imageRect.height;\n\n        // calculate rotated crop rectangle size\n        var rotatedCropSize = getRotatedRectSize(cropRect, rotation);\n\n        return Math.max(rotatedCropSize.width / imageWidth, rotatedCropSize.height / imageHeight);\n    };\n\n    var getCenteredCropRect = function getCenteredCropRect(container, aspectRatio) {\n        var width = container.width;\n        var height = width * aspectRatio;\n        if (height > container.height) {\n            height = container.height;\n            width = height / aspectRatio;\n        }\n        var x = (container.width - width) * 0.5;\n        var y = (container.height - height) * 0.5;\n\n        return {\n            x: x,\n            y: y,\n            width: width,\n            height: height,\n        };\n    };\n\n    var calculateCanvasSize = function calculateCanvasSize(image, canvasAspectRatio) {\n        var zoom = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 1;\n\n        var imageAspectRatio = image.height / image.width;\n\n        // determine actual pixels on x and y axis\n        var canvasWidth = 1;\n        var canvasHeight = canvasAspectRatio;\n        var imgWidth = 1;\n        var imgHeight = imageAspectRatio;\n        if (imgHeight > canvasHeight) {\n            imgHeight = canvasHeight;\n            imgWidth = imgHeight / imageAspectRatio;\n        }\n\n        var scalar = Math.max(canvasWidth / imgWidth, canvasHeight / imgHeight);\n        var width = image.width / (zoom * scalar * imgWidth);\n        var height = width * canvasAspectRatio;\n\n        return {\n            width: width,\n            height: height,\n        };\n    };\n\n    var canvasRelease = function canvasRelease(canvas) {\n        canvas.width = 1;\n        canvas.height = 1;\n        var ctx = canvas.getContext('2d');\n        ctx.clearRect(0, 0, 1, 1);\n    };\n\n    var isFlipped = function isFlipped(flip) {\n        return flip && (flip.horizontal || flip.vertical);\n    };\n\n    var getBitmap = function getBitmap(image, orientation, flip) {\n        if (orientation <= 1 && !isFlipped(flip)) {\n            image.width = image.naturalWidth;\n            image.height = image.naturalHeight;\n            return image;\n        }\n\n        var canvas = document.createElement('canvas');\n        var width = image.naturalWidth;\n        var height = image.naturalHeight;\n\n        // if is rotated incorrectly swap width and height\n        var swapped = orientation >= 5 && orientation <= 8;\n        if (swapped) {\n            canvas.width = height;\n            canvas.height = width;\n        } else {\n            canvas.width = width;\n            canvas.height = height;\n        }\n\n        // draw the image but first fix orientation and set correct flip\n        var ctx = canvas.getContext('2d');\n\n        // get base transformation matrix\n        if (orientation) {\n            ctx.transform.apply(ctx, getImageOrientationMatrix(width, height, orientation));\n        }\n\n        if (isFlipped(flip)) {\n            // flip horizontal\n            // [-1, 0, 0, 1, width, 0]\n            var matrix = [1, 0, 0, 1, 0, 0];\n            if ((!swapped && flip.horizontal) || swapped & flip.vertical) {\n                matrix[0] = -1;\n                matrix[4] = width;\n            }\n\n            // flip vertical\n            // [1, 0, 0, -1, 0, height]\n            if ((!swapped && flip.vertical) || (swapped && flip.horizontal)) {\n                matrix[3] = -1;\n                matrix[5] = height;\n            }\n\n            ctx.transform.apply(ctx, matrix);\n        }\n\n        ctx.drawImage(image, 0, 0, width, height);\n\n        return canvas;\n    };\n\n    var imageToImageData = function imageToImageData(imageElement, orientation) {\n        var crop = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n        var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n        var canvasMemoryLimit = options.canvasMemoryLimit,\n            _options$background = options.background,\n            background = _options$background === void 0 ? null : _options$background;\n\n        var zoom = crop.zoom || 1;\n\n        // fixes possible image orientation problems by drawing the image on the correct canvas\n        var bitmap = getBitmap(imageElement, orientation, crop.flip);\n        var imageSize = {\n            width: bitmap.width,\n            height: bitmap.height,\n        };\n\n        var aspectRatio = crop.aspectRatio || imageSize.height / imageSize.width;\n\n        var canvasSize = calculateCanvasSize(imageSize, aspectRatio, zoom);\n\n        if (canvasMemoryLimit) {\n            var requiredMemory = canvasSize.width * canvasSize.height;\n            if (requiredMemory > canvasMemoryLimit) {\n                var scalar = Math.sqrt(canvasMemoryLimit) / Math.sqrt(requiredMemory);\n                imageSize.width = Math.floor(imageSize.width * scalar);\n                imageSize.height = Math.floor(imageSize.height * scalar);\n                canvasSize = calculateCanvasSize(imageSize, aspectRatio, zoom);\n            }\n        }\n\n        var canvas = document.createElement('canvas');\n\n        var canvasCenter = {\n            x: canvasSize.width * 0.5,\n            y: canvasSize.height * 0.5,\n        };\n\n        var stage = {\n            x: 0,\n            y: 0,\n            width: canvasSize.width,\n            height: canvasSize.height,\n            center: canvasCenter,\n        };\n\n        var shouldLimit = typeof crop.scaleToFit === 'undefined' || crop.scaleToFit;\n\n        var scale =\n            zoom *\n            getImageRectZoomFactor(\n                imageSize,\n                getCenteredCropRect(stage, aspectRatio),\n                crop.rotation,\n                shouldLimit ? crop.center : { x: 0.5, y: 0.5 }\n            );\n\n        // start drawing\n        canvas.width = Math.round(canvasSize.width / scale);\n        canvas.height = Math.round(canvasSize.height / scale);\n\n        canvasCenter.x /= scale;\n        canvasCenter.y /= scale;\n\n        var imageOffset = {\n            x: canvasCenter.x - imageSize.width * (crop.center ? crop.center.x : 0.5),\n            y: canvasCenter.y - imageSize.height * (crop.center ? crop.center.y : 0.5),\n        };\n\n        var ctx = canvas.getContext('2d');\n        if (background) {\n            ctx.fillStyle = background;\n            ctx.fillRect(0, 0, canvas.width, canvas.height);\n        }\n\n        // move to draw offset\n        ctx.translate(canvasCenter.x, canvasCenter.y);\n        ctx.rotate(crop.rotation || 0);\n\n        // draw the image\n        ctx.drawImage(\n            bitmap,\n            imageOffset.x - canvasCenter.x,\n            imageOffset.y - canvasCenter.y,\n            imageSize.width,\n            imageSize.height\n        );\n\n        // get data from canvas\n        var imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);\n\n        // release canvas\n        canvasRelease(canvas);\n\n        // return data\n        return imageData;\n    };\n\n    /**\n     * Polyfill toBlob for Edge\n     */\n    var IS_BROWSER = (function() {\n        return typeof window !== 'undefined' && typeof window.document !== 'undefined';\n    })();\n    if (IS_BROWSER) {\n        if (!HTMLCanvasElement.prototype.toBlob) {\n            Object.defineProperty(HTMLCanvasElement.prototype, 'toBlob', {\n                value: function value(callback, type, quality) {\n                    var dataURL = this.toDataURL(type, quality).split(',')[1];\n                    setTimeout(function() {\n                        var binStr = atob(dataURL);\n                        var len = binStr.length;\n                        var arr = new Uint8Array(len);\n                        for (var i = 0; i < len; i++) {\n                            arr[i] = binStr.charCodeAt(i);\n                        }\n                        callback(new Blob([arr], { type: type || 'image/png' }));\n                    });\n                },\n            });\n        }\n    }\n\n    var canvasToBlob = function canvasToBlob(canvas, options) {\n        var beforeCreateBlob =\n            arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n        return new Promise(function(resolve) {\n            var promisedImage = beforeCreateBlob ? beforeCreateBlob(canvas) : canvas;\n            Promise.resolve(promisedImage).then(function(canvas) {\n                canvas.toBlob(resolve, options.type, options.quality);\n            });\n        });\n    };\n\n    var vectorMultiply = function vectorMultiply(v, amount) {\n        return createVector$1(v.x * amount, v.y * amount);\n    };\n\n    var vectorAdd = function vectorAdd(a, b) {\n        return createVector$1(a.x + b.x, a.y + b.y);\n    };\n\n    var vectorNormalize = function vectorNormalize(v) {\n        var l = Math.sqrt(v.x * v.x + v.y * v.y);\n        if (l === 0) {\n            return {\n                x: 0,\n                y: 0,\n            };\n        }\n        return createVector$1(v.x / l, v.y / l);\n    };\n\n    var vectorRotate = function vectorRotate(v, radians, origin) {\n        var cos = Math.cos(radians);\n        var sin = Math.sin(radians);\n        var t = createVector$1(v.x - origin.x, v.y - origin.y);\n        return createVector$1(origin.x + cos * t.x - sin * t.y, origin.y + sin * t.x + cos * t.y);\n    };\n\n    var createVector$1 = function createVector() {\n        var x = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n        var y = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n        return { x: x, y: y };\n    };\n\n    var getMarkupValue = function getMarkupValue(value, size) {\n        var scalar = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 1;\n        var axis = arguments.length > 3 ? arguments[3] : undefined;\n        if (typeof value === 'string') {\n            return parseFloat(value) * scalar;\n        }\n        if (typeof value === 'number') {\n            return value * (axis ? size[axis] : Math.min(size.width, size.height));\n        }\n        return;\n    };\n\n    var getMarkupStyles = function getMarkupStyles(markup, size, scale) {\n        var lineStyle = markup.borderStyle || markup.lineStyle || 'solid';\n        var fill = markup.backgroundColor || markup.fontColor || 'transparent';\n        var stroke = markup.borderColor || markup.lineColor || 'transparent';\n        var strokeWidth = getMarkupValue(markup.borderWidth || markup.lineWidth, size, scale);\n        var lineCap = markup.lineCap || 'round';\n        var lineJoin = markup.lineJoin || 'round';\n        var dashes =\n            typeof lineStyle === 'string'\n                ? ''\n                : lineStyle\n                      .map(function(v) {\n                          return getMarkupValue(v, size, scale);\n                      })\n                      .join(',');\n        var opacity = markup.opacity || 1;\n        return {\n            'stroke-linecap': lineCap,\n            'stroke-linejoin': lineJoin,\n            'stroke-width': strokeWidth || 0,\n            'stroke-dasharray': dashes,\n            stroke: stroke,\n            fill: fill,\n            opacity: opacity,\n        };\n    };\n\n    var isDefined = function isDefined(value) {\n        return value != null;\n    };\n\n    var getMarkupRect = function getMarkupRect(rect, size) {\n        var scalar = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 1;\n\n        var left =\n            getMarkupValue(rect.x, size, scalar, 'width') ||\n            getMarkupValue(rect.left, size, scalar, 'width');\n        var top =\n            getMarkupValue(rect.y, size, scalar, 'height') ||\n            getMarkupValue(rect.top, size, scalar, 'height');\n        var width = getMarkupValue(rect.width, size, scalar, 'width');\n        var height = getMarkupValue(rect.height, size, scalar, 'height');\n        var right = getMarkupValue(rect.right, size, scalar, 'width');\n        var bottom = getMarkupValue(rect.bottom, size, scalar, 'height');\n\n        if (!isDefined(top)) {\n            if (isDefined(height) && isDefined(bottom)) {\n                top = size.height - height - bottom;\n            } else {\n                top = bottom;\n            }\n        }\n\n        if (!isDefined(left)) {\n            if (isDefined(width) && isDefined(right)) {\n                left = size.width - width - right;\n            } else {\n                left = right;\n            }\n        }\n\n        if (!isDefined(width)) {\n            if (isDefined(left) && isDefined(right)) {\n                width = size.width - left - right;\n            } else {\n                width = 0;\n            }\n        }\n\n        if (!isDefined(height)) {\n            if (isDefined(top) && isDefined(bottom)) {\n                height = size.height - top - bottom;\n            } else {\n                height = 0;\n            }\n        }\n\n        return {\n            x: left || 0,\n            y: top || 0,\n            width: width || 0,\n            height: height || 0,\n        };\n    };\n\n    var pointsToPathShape = function pointsToPathShape(points) {\n        return points\n            .map(function(point, index) {\n                return ''\n                    .concat(index === 0 ? 'M' : 'L', ' ')\n                    .concat(point.x, ' ')\n                    .concat(point.y);\n            })\n            .join(' ');\n    };\n\n    var setAttributes = function setAttributes(element, attr) {\n        return Object.keys(attr).forEach(function(key) {\n            return element.setAttribute(key, attr[key]);\n        });\n    };\n\n    var ns = 'http://www.w3.org/2000/svg';\n    var svg = function svg(tag, attr) {\n        var element = document.createElementNS(ns, tag);\n        if (attr) {\n            setAttributes(element, attr);\n        }\n        return element;\n    };\n\n    var updateRect = function updateRect(element) {\n        return setAttributes(element, Object.assign({}, element.rect, element.styles));\n    };\n\n    var updateEllipse = function updateEllipse(element) {\n        var cx = element.rect.x + element.rect.width * 0.5;\n        var cy = element.rect.y + element.rect.height * 0.5;\n        var rx = element.rect.width * 0.5;\n        var ry = element.rect.height * 0.5;\n        return setAttributes(\n            element,\n            Object.assign(\n                {\n                    cx: cx,\n                    cy: cy,\n                    rx: rx,\n                    ry: ry,\n                },\n                element.styles\n            )\n        );\n    };\n\n    var IMAGE_FIT_STYLE = {\n        contain: 'xMidYMid meet',\n        cover: 'xMidYMid slice',\n    };\n\n    var updateImage = function updateImage(element, markup) {\n        setAttributes(\n            element,\n            Object.assign({}, element.rect, element.styles, {\n                preserveAspectRatio: IMAGE_FIT_STYLE[markup.fit] || 'none',\n            })\n        );\n    };\n\n    var TEXT_ANCHOR = {\n        left: 'start',\n        center: 'middle',\n        right: 'end',\n    };\n\n    var updateText = function updateText(element, markup, size, scale) {\n        var fontSize = getMarkupValue(markup.fontSize, size, scale);\n        var fontFamily = markup.fontFamily || 'sans-serif';\n        var fontWeight = markup.fontWeight || 'normal';\n        var textAlign = TEXT_ANCHOR[markup.textAlign] || 'start';\n\n        setAttributes(\n            element,\n            Object.assign({}, element.rect, element.styles, {\n                'stroke-width': 0,\n                'font-weight': fontWeight,\n                'font-size': fontSize,\n                'font-family': fontFamily,\n                'text-anchor': textAlign,\n            })\n        );\n\n        // update text\n        if (element.text !== markup.text) {\n            element.text = markup.text;\n            element.textContent = markup.text.length ? markup.text : ' ';\n        }\n    };\n\n    var updateLine = function updateLine(element, markup, size, scale) {\n        setAttributes(\n            element,\n            Object.assign({}, element.rect, element.styles, {\n                fill: 'none',\n            })\n        );\n\n        var line = element.childNodes[0];\n        var begin = element.childNodes[1];\n        var end = element.childNodes[2];\n\n        var origin = element.rect;\n\n        var target = {\n            x: element.rect.x + element.rect.width,\n            y: element.rect.y + element.rect.height,\n        };\n\n        setAttributes(line, {\n            x1: origin.x,\n            y1: origin.y,\n            x2: target.x,\n            y2: target.y,\n        });\n\n        if (!markup.lineDecoration) return;\n\n        begin.style.display = 'none';\n        end.style.display = 'none';\n\n        var v = vectorNormalize({\n            x: target.x - origin.x,\n            y: target.y - origin.y,\n        });\n\n        var l = getMarkupValue(0.05, size, scale);\n\n        if (markup.lineDecoration.indexOf('arrow-begin') !== -1) {\n            var arrowBeginRotationPoint = vectorMultiply(v, l);\n            var arrowBeginCenter = vectorAdd(origin, arrowBeginRotationPoint);\n            var arrowBeginA = vectorRotate(origin, 2, arrowBeginCenter);\n            var arrowBeginB = vectorRotate(origin, -2, arrowBeginCenter);\n\n            setAttributes(begin, {\n                style: 'display:block;',\n                d: 'M'\n                    .concat(arrowBeginA.x, ',')\n                    .concat(arrowBeginA.y, ' L')\n                    .concat(origin.x, ',')\n                    .concat(origin.y, ' L')\n                    .concat(arrowBeginB.x, ',')\n                    .concat(arrowBeginB.y),\n            });\n        }\n\n        if (markup.lineDecoration.indexOf('arrow-end') !== -1) {\n            var arrowEndRotationPoint = vectorMultiply(v, -l);\n            var arrowEndCenter = vectorAdd(target, arrowEndRotationPoint);\n            var arrowEndA = vectorRotate(target, 2, arrowEndCenter);\n            var arrowEndB = vectorRotate(target, -2, arrowEndCenter);\n\n            setAttributes(end, {\n                style: 'display:block;',\n                d: 'M'\n                    .concat(arrowEndA.x, ',')\n                    .concat(arrowEndA.y, ' L')\n                    .concat(target.x, ',')\n                    .concat(target.y, ' L')\n                    .concat(arrowEndB.x, ',')\n                    .concat(arrowEndB.y),\n            });\n        }\n    };\n\n    var updatePath = function updatePath(element, markup, size, scale) {\n        setAttributes(\n            element,\n            Object.assign({}, element.styles, {\n                fill: 'none',\n                d: pointsToPathShape(\n                    markup.points.map(function(point) {\n                        return {\n                            x: getMarkupValue(point.x, size, scale, 'width'),\n                            y: getMarkupValue(point.y, size, scale, 'height'),\n                        };\n                    })\n                ),\n            })\n        );\n    };\n\n    var createShape = function createShape(node) {\n        return function(markup) {\n            return svg(node, { id: markup.id });\n        };\n    };\n\n    var createImage = function createImage(markup) {\n        var shape = svg('image', {\n            id: markup.id,\n            'stroke-linecap': 'round',\n            'stroke-linejoin': 'round',\n            opacity: '0',\n        });\n\n        shape.onload = function() {\n            shape.setAttribute('opacity', markup.opacity || 1);\n        };\n        shape.setAttributeNS('http://www.w3.org/1999/xlink', 'xlink:href', markup.src);\n        return shape;\n    };\n\n    var createLine = function createLine(markup) {\n        var shape = svg('g', {\n            id: markup.id,\n            'stroke-linecap': 'round',\n            'stroke-linejoin': 'round',\n        });\n\n        var line = svg('line');\n        shape.appendChild(line);\n\n        var begin = svg('path');\n        shape.appendChild(begin);\n\n        var end = svg('path');\n        shape.appendChild(end);\n\n        return shape;\n    };\n\n    var CREATE_TYPE_ROUTES = {\n        image: createImage,\n        rect: createShape('rect'),\n        ellipse: createShape('ellipse'),\n        text: createShape('text'),\n        path: createShape('path'),\n        line: createLine,\n    };\n\n    var UPDATE_TYPE_ROUTES = {\n        rect: updateRect,\n        ellipse: updateEllipse,\n        image: updateImage,\n        text: updateText,\n        path: updatePath,\n        line: updateLine,\n    };\n\n    var createMarkupByType = function createMarkupByType(type, markup) {\n        return CREATE_TYPE_ROUTES[type](markup);\n    };\n\n    var updateMarkupByType = function updateMarkupByType(element, type, markup, size, scale) {\n        if (type !== 'path') {\n            element.rect = getMarkupRect(markup, size, scale);\n        }\n        element.styles = getMarkupStyles(markup, size, scale);\n        UPDATE_TYPE_ROUTES[type](element, markup, size, scale);\n    };\n\n    var sortMarkupByZIndex = function sortMarkupByZIndex(a, b) {\n        if (a[1].zIndex > b[1].zIndex) {\n            return 1;\n        }\n        if (a[1].zIndex < b[1].zIndex) {\n            return -1;\n        }\n        return 0;\n    };\n\n    var cropSVG = function cropSVG(blob) {\n        var crop = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n        var markup = arguments.length > 2 ? arguments[2] : undefined;\n        var options = arguments.length > 3 ? arguments[3] : undefined;\n        return new Promise(function(resolve) {\n            var _options$background = options.background,\n                background = _options$background === void 0 ? null : _options$background;\n\n            // load blob contents and wrap in crop svg\n            var fr = new FileReader();\n            fr.onloadend = function() {\n                // get svg text\n                var text = fr.result;\n\n                // create element with svg and get size\n                var original = document.createElement('div');\n                original.style.cssText =\n                    'position:absolute;pointer-events:none;width:0;height:0;visibility:hidden;';\n                original.innerHTML = text;\n                var originalNode = original.querySelector('svg');\n                document.body.appendChild(original);\n\n                // request bounding box dimensions\n                var bBox = originalNode.getBBox();\n                original.parentNode.removeChild(original);\n\n                // get title\n                var titleNode = original.querySelector('title');\n\n                // calculate new heights and widths\n                var viewBoxAttribute = originalNode.getAttribute('viewBox') || '';\n                var widthAttribute = originalNode.getAttribute('width') || '';\n                var heightAttribute = originalNode.getAttribute('height') || '';\n                var width = parseFloat(widthAttribute) || null;\n                var height = parseFloat(heightAttribute) || null;\n                var widthUnits = (widthAttribute.match(/[a-z]+/) || [])[0] || '';\n                var heightUnits = (heightAttribute.match(/[a-z]+/) || [])[0] || '';\n\n                // create new size\n                var viewBoxList = viewBoxAttribute.split(' ').map(parseFloat);\n                var viewBox = viewBoxList.length\n                    ? {\n                          x: viewBoxList[0],\n                          y: viewBoxList[1],\n                          width: viewBoxList[2],\n                          height: viewBoxList[3],\n                      }\n                    : bBox;\n\n                var imageWidth = width != null ? width : viewBox.width;\n                var imageHeight = height != null ? height : viewBox.height;\n\n                originalNode.style.overflow = 'visible';\n                originalNode.setAttribute('width', imageWidth);\n                originalNode.setAttribute('height', imageHeight);\n\n                // markup\n                var markupSVG = '';\n                if (markup && markup.length) {\n                    var size = {\n                        width: imageWidth,\n                        height: imageHeight,\n                    };\n\n                    markupSVG = markup.sort(sortMarkupByZIndex).reduce(function(prev, shape) {\n                        var el = createMarkupByType(shape[0], shape[1]);\n                        updateMarkupByType(el, shape[0], shape[1], size);\n                        el.removeAttribute('id');\n                        if (el.getAttribute('opacity') === 1) {\n                            el.removeAttribute('opacity');\n                        }\n                        return prev + '\\n' + el.outerHTML + '\\n';\n                    }, '');\n                    markupSVG = '\\n\\n<g>'.concat(markupSVG.replace(/&nbsp;/g, ' '), '</g>\\n\\n');\n                }\n\n                var aspectRatio = crop.aspectRatio || imageHeight / imageWidth;\n\n                var canvasWidth = imageWidth;\n                var canvasHeight = canvasWidth * aspectRatio;\n\n                var shouldLimit = typeof crop.scaleToFit === 'undefined' || crop.scaleToFit;\n\n                var cropCenterX = crop.center ? crop.center.x : 0.5;\n                var cropCenterY = crop.center ? crop.center.y : 0.5;\n\n                var canvasZoomFactor = getImageRectZoomFactor(\n                    {\n                        width: imageWidth,\n                        height: imageHeight,\n                    },\n\n                    getCenteredCropRect(\n                        {\n                            width: canvasWidth,\n                            height: canvasHeight,\n                        },\n\n                        aspectRatio\n                    ),\n\n                    crop.rotation,\n                    shouldLimit\n                        ? { x: cropCenterX, y: cropCenterY }\n                        : {\n                              x: 0.5,\n                              y: 0.5,\n                          }\n                );\n\n                var scale = crop.zoom * canvasZoomFactor;\n\n                var rotation = crop.rotation * (180 / Math.PI);\n\n                var canvasCenter = {\n                    x: canvasWidth * 0.5,\n                    y: canvasHeight * 0.5,\n                };\n\n                var imageOffset = {\n                    x: canvasCenter.x - imageWidth * cropCenterX,\n                    y: canvasCenter.y - imageHeight * cropCenterY,\n                };\n\n                var cropTransforms = [\n                    // rotate\n                    'rotate('\n                        .concat(rotation, ' ')\n                        .concat(canvasCenter.x, ' ')\n                        .concat(canvasCenter.y, ')'),\n\n                    // scale\n                    'translate('.concat(canvasCenter.x, ' ').concat(canvasCenter.y, ')'),\n                    'scale('.concat(scale, ')'),\n                    'translate('.concat(-canvasCenter.x, ' ').concat(-canvasCenter.y, ')'),\n\n                    // offset\n                    'translate('.concat(imageOffset.x, ' ').concat(imageOffset.y, ')'),\n                ];\n\n                var cropFlipHorizontal = crop.flip && crop.flip.horizontal;\n                var cropFlipVertical = crop.flip && crop.flip.vertical;\n\n                var flipTransforms = [\n                    'scale('\n                        .concat(cropFlipHorizontal ? -1 : 1, ' ')\n                        .concat(cropFlipVertical ? -1 : 1, ')'),\n                    'translate('\n                        .concat(cropFlipHorizontal ? -imageWidth : 0, ' ')\n                        .concat(cropFlipVertical ? -imageHeight : 0, ')'),\n                ];\n\n                // crop\n                var transformed = '<?xml version=\"1.0\" encoding=\"UTF-8\"?>\\n<svg width=\"'\n                    .concat(canvasWidth)\n                    .concat(widthUnits, '\" height=\"')\n                    .concat(canvasHeight)\n                    .concat(heightUnits, '\" \\nviewBox=\"0 0 ')\n                    .concat(canvasWidth, ' ')\n                    .concat(canvasHeight, '\" ')\n                    .concat(\n                        background ? 'style=\"background:' + background + '\" ' : '',\n                        '\\npreserveAspectRatio=\"xMinYMin\"\\nxmlns:xlink=\"http://www.w3.org/1999/xlink\"\\nxmlns=\"http://www.w3.org/2000/svg\">\\n<!-- Generated by PQINA - https://pqina.nl/ -->\\n<title>'\n                    )\n                    .concat(titleNode ? titleNode.textContent : '', '</title>\\n<g transform=\"')\n                    .concat(cropTransforms.join(' '), '\">\\n<g transform=\"')\n                    .concat(flipTransforms.join(' '), '\">\\n')\n                    .concat(originalNode.outerHTML)\n                    .concat(markupSVG, '\\n</g>\\n</g>\\n</svg>');\n\n                // create new svg file\n                resolve(transformed);\n            };\n\n            fr.readAsText(blob);\n        });\n    };\n\n    var objectToImageData = function objectToImageData(obj) {\n        var imageData;\n        try {\n            imageData = new ImageData(obj.width, obj.height);\n        } catch (e) {\n            // IE + Old EDGE (tested on 12)\n            var canvas = document.createElement('canvas');\n            imageData = canvas.getContext('2d').createImageData(obj.width, obj.height);\n        }\n        imageData.data.set(obj.data);\n        return imageData;\n    };\n\n    /* javascript-obfuscator:disable */\n    var TransformWorker = function TransformWorker() {\n        // maps transform types to transform functions\n        var TRANSFORMS = { resize: resize, filter: filter };\n\n        // applies all image transforms to the image data array\n        var applyTransforms = function applyTransforms(transforms, imageData) {\n            transforms.forEach(function(transform) {\n                imageData = TRANSFORMS[transform.type](imageData, transform.data);\n            });\n            return imageData;\n        };\n\n        // transform image hub\n        var transform = function transform(data, cb) {\n            var transforms = data.transforms;\n\n            // if has filter and has resize, move filter to resize operation\n            var filterTransform = null;\n            transforms.forEach(function(transform) {\n                if (transform.type === 'filter') {\n                    filterTransform = transform;\n                }\n            });\n            if (filterTransform) {\n                // find resize\n                var resizeTransform = null;\n                transforms.forEach(function(transform) {\n                    if (transform.type === 'resize') {\n                        resizeTransform = transform;\n                    }\n                });\n\n                if (resizeTransform) {\n                    // update resize operation\n                    resizeTransform.data.matrix = filterTransform.data;\n\n                    // remove filter\n                    transforms = transforms.filter(function(transform) {\n                        return transform.type !== 'filter';\n                    });\n                }\n            }\n\n            cb(applyTransforms(transforms, data.imageData));\n        };\n\n        // eslint-disable-next-line no-restricted-globals\n        self.onmessage = function(e) {\n            transform(e.data.message, function(response) {\n                // eslint-disable-next-line no-restricted-globals\n                self.postMessage({ id: e.data.id, message: response }, [response.data.buffer]);\n            });\n        };\n\n        var br = 1.0;\n        var bg = 1.0;\n        var bb = 1.0;\n        function applyFilterMatrix(index, data, m) {\n            var ir = data[index] / 255;\n            var ig = data[index + 1] / 255;\n            var ib = data[index + 2] / 255;\n            var ia = data[index + 3] / 255;\n\n            var mr = ir * m[0] + ig * m[1] + ib * m[2] + ia * m[3] + m[4];\n            var mg = ir * m[5] + ig * m[6] + ib * m[7] + ia * m[8] + m[9];\n            var mb = ir * m[10] + ig * m[11] + ib * m[12] + ia * m[13] + m[14];\n            var ma = ir * m[15] + ig * m[16] + ib * m[17] + ia * m[18] + m[19];\n\n            var or = Math.max(0, mr * ma) + br * (1.0 - ma);\n            var og = Math.max(0, mg * ma) + bg * (1.0 - ma);\n            var ob = Math.max(0, mb * ma) + bb * (1.0 - ma);\n\n            data[index] = Math.max(0.0, Math.min(1.0, or)) * 255;\n            data[index + 1] = Math.max(0.0, Math.min(1.0, og)) * 255;\n            data[index + 2] = Math.max(0.0, Math.min(1.0, ob)) * 255;\n        }\n\n        var identityMatrix = self.JSON.stringify([\n            1,\n            0,\n            0,\n            0,\n            0,\n            0,\n            1,\n            0,\n            0,\n            0,\n            0,\n            0,\n            1,\n            0,\n            0,\n            0,\n            0,\n            0,\n            1,\n            0,\n        ]);\n        function isIdentityMatrix(filter) {\n            return self.JSON.stringify(filter || []) === identityMatrix;\n        }\n\n        function filter(imageData, matrix) {\n            if (!matrix || isIdentityMatrix(matrix)) return imageData;\n\n            var data = imageData.data;\n            var l = data.length;\n\n            var m11 = matrix[0];\n            var m12 = matrix[1];\n            var m13 = matrix[2];\n            var m14 = matrix[3];\n            var m15 = matrix[4];\n\n            var m21 = matrix[5];\n            var m22 = matrix[6];\n            var m23 = matrix[7];\n            var m24 = matrix[8];\n            var m25 = matrix[9];\n\n            var m31 = matrix[10];\n            var m32 = matrix[11];\n            var m33 = matrix[12];\n            var m34 = matrix[13];\n            var m35 = matrix[14];\n\n            var m41 = matrix[15];\n            var m42 = matrix[16];\n            var m43 = matrix[17];\n            var m44 = matrix[18];\n            var m45 = matrix[19];\n\n            var index = 0,\n                r = 0.0,\n                g = 0.0,\n                b = 0.0,\n                a = 0.0,\n                mr = 0.0,\n                mg = 0.0,\n                mb = 0.0,\n                ma = 0.0,\n                or = 0.0,\n                og = 0.0,\n                ob = 0.0;\n\n            for (; index < l; index += 4) {\n                r = data[index] / 255;\n                g = data[index + 1] / 255;\n                b = data[index + 2] / 255;\n                a = data[index + 3] / 255;\n\n                mr = r * m11 + g * m12 + b * m13 + a * m14 + m15;\n                mg = r * m21 + g * m22 + b * m23 + a * m24 + m25;\n                mb = r * m31 + g * m32 + b * m33 + a * m34 + m35;\n                ma = r * m41 + g * m42 + b * m43 + a * m44 + m45;\n\n                or = Math.max(0, mr * ma) + br * (1.0 - ma);\n                og = Math.max(0, mg * ma) + bg * (1.0 - ma);\n                ob = Math.max(0, mb * ma) + bb * (1.0 - ma);\n\n                data[index] = Math.max(0.0, Math.min(1.0, or)) * 255;\n                data[index + 1] = Math.max(0.0, Math.min(1.0, og)) * 255;\n                data[index + 2] = Math.max(0.0, Math.min(1.0, ob)) * 255;\n                // don't update alpha value\n            }\n\n            return imageData;\n        }\n\n        function resize(imageData, data) {\n            var _data$mode = data.mode,\n                mode = _data$mode === void 0 ? 'contain' : _data$mode,\n                _data$upscale = data.upscale,\n                upscale = _data$upscale === void 0 ? false : _data$upscale,\n                width = data.width,\n                height = data.height,\n                matrix = data.matrix;\n\n            // test if is identity matrix\n            matrix = !matrix || isIdentityMatrix(matrix) ? null : matrix;\n\n            // need at least a width or a height\n            // also 0 is not a valid width or height\n            if (!width && !height) {\n                return filter(imageData, matrix);\n            }\n\n            // make sure all bounds are set\n            if (width === null) {\n                width = height;\n            } else if (height === null) {\n                height = width;\n            }\n\n            if (mode !== 'force') {\n                var scalarWidth = width / imageData.width;\n                var scalarHeight = height / imageData.height;\n                var scalar = 1;\n\n                if (mode === 'cover') {\n                    scalar = Math.max(scalarWidth, scalarHeight);\n                } else if (mode === 'contain') {\n                    scalar = Math.min(scalarWidth, scalarHeight);\n                }\n\n                // if image is too small, exit here with original image\n                if (scalar > 1 && upscale === false) {\n                    return filter(imageData, matrix);\n                }\n\n                width = imageData.width * scalar;\n                height = imageData.height * scalar;\n            }\n\n            var originWidth = imageData.width;\n            var originHeight = imageData.height;\n            var targetWidth = Math.round(width);\n            var targetHeight = Math.round(height);\n            var inputData = imageData.data;\n            var outputData = new Uint8ClampedArray(targetWidth * targetHeight * 4);\n            var ratioWidth = originWidth / targetWidth;\n            var ratioHeight = originHeight / targetHeight;\n            var ratioWidthHalf = Math.ceil(ratioWidth * 0.5);\n            var ratioHeightHalf = Math.ceil(ratioHeight * 0.5);\n\n            for (var j = 0; j < targetHeight; j++) {\n                for (var i = 0; i < targetWidth; i++) {\n                    var x2 = (i + j * targetWidth) * 4;\n                    var weight = 0;\n                    var weights = 0;\n                    var weightsAlpha = 0;\n                    var r = 0;\n                    var g = 0;\n                    var b = 0;\n                    var a = 0;\n                    var centerY = (j + 0.5) * ratioHeight;\n\n                    for (var yy = Math.floor(j * ratioHeight); yy < (j + 1) * ratioHeight; yy++) {\n                        var dy = Math.abs(centerY - (yy + 0.5)) / ratioHeightHalf;\n                        var centerX = (i + 0.5) * ratioWidth;\n                        var w0 = dy * dy;\n\n                        for (var xx = Math.floor(i * ratioWidth); xx < (i + 1) * ratioWidth; xx++) {\n                            var dx = Math.abs(centerX - (xx + 0.5)) / ratioWidthHalf;\n                            var w = Math.sqrt(w0 + dx * dx);\n\n                            if (w >= -1 && w <= 1) {\n                                weight = 2 * w * w * w - 3 * w * w + 1;\n\n                                if (weight > 0) {\n                                    dx = 4 * (xx + yy * originWidth);\n\n                                    var ref = inputData[dx + 3];\n                                    a += weight * ref;\n                                    weightsAlpha += weight;\n\n                                    if (ref < 255) {\n                                        weight = (weight * ref) / 250;\n                                    }\n\n                                    r += weight * inputData[dx];\n                                    g += weight * inputData[dx + 1];\n                                    b += weight * inputData[dx + 2];\n                                    weights += weight;\n                                }\n                            }\n                        }\n                    }\n\n                    outputData[x2] = r / weights;\n                    outputData[x2 + 1] = g / weights;\n                    outputData[x2 + 2] = b / weights;\n                    outputData[x2 + 3] = a / weightsAlpha;\n\n                    matrix && applyFilterMatrix(x2, outputData, matrix);\n                }\n            }\n\n            return {\n                data: outputData,\n                width: targetWidth,\n                height: targetHeight,\n            };\n        }\n    };\n    /* javascript-obfuscator:enable */\n\n    var correctOrientation = function correctOrientation(view, offset) {\n        // Missing 0x45786966 Marker? No Exif Header, stop here\n        if (view.getUint32(offset + 4, false) !== 0x45786966) return;\n\n        // next byte!\n        offset += 4;\n\n        // First 2bytes defines byte align of TIFF data.\n        // If it is 0x4949=\"I I\", it means \"Intel\" type byte align\n        var intelByteAligned = view.getUint16((offset += 6), false) === 0x4949;\n        offset += view.getUint32(offset + 4, intelByteAligned);\n\n        var tags = view.getUint16(offset, intelByteAligned);\n        offset += 2;\n\n        // find Orientation tag\n        for (var i = 0; i < tags; i++) {\n            if (view.getUint16(offset + i * 12, intelByteAligned) === 0x0112) {\n                view.setUint16(offset + i * 12 + 8, 1, intelByteAligned);\n                return true;\n            }\n        }\n        return false;\n    };\n\n    var readData = function readData(data) {\n        var view = new DataView(data);\n\n        // Every JPEG file starts from binary value '0xFFD8'\n        // If it's not present, exit here\n        if (view.getUint16(0) !== 0xffd8) return null;\n\n        var offset = 2; // Start at 2 as we skipped two bytes (FFD8)\n        var marker;\n        var markerLength;\n        var orientationCorrected = false;\n\n        while (offset < view.byteLength) {\n            marker = view.getUint16(offset, false);\n            markerLength = view.getUint16(offset + 2, false) + 2;\n\n            // Test if is APP and COM markers\n            var isData = (marker >= 0xffe0 && marker <= 0xffef) || marker === 0xfffe;\n            if (!isData) {\n                break;\n            }\n\n            if (!orientationCorrected) {\n                orientationCorrected = correctOrientation(view, offset, markerLength);\n            }\n\n            if (offset + markerLength > view.byteLength) {\n                break;\n            }\n\n            offset += markerLength;\n        }\n        return data.slice(0, offset);\n    };\n\n    var getImageHead = function getImageHead(file) {\n        return new Promise(function(resolve) {\n            var reader = new FileReader();\n            reader.onload = function() {\n                return resolve(readData(reader.result) || null);\n            };\n            reader.readAsArrayBuffer(file.slice(0, 256 * 1024));\n        });\n    };\n\n    var getBlobBuilder = function getBlobBuilder() {\n        return (window.BlobBuilder =\n            window.BlobBuilder ||\n            window.WebKitBlobBuilder ||\n            window.MozBlobBuilder ||\n            window.MSBlobBuilder);\n    };\n\n    var createBlob = function createBlob(arrayBuffer, mimeType) {\n        var BB = getBlobBuilder();\n\n        if (BB) {\n            var bb = new BB();\n            bb.append(arrayBuffer);\n            return bb.getBlob(mimeType);\n        }\n\n        return new Blob([arrayBuffer], {\n            type: mimeType,\n        });\n    };\n\n    var getUniqueId = function getUniqueId() {\n        return Math.random()\n            .toString(36)\n            .substr(2, 9);\n    };\n\n    var createWorker = function createWorker(fn) {\n        var workerBlob = new Blob(['(', fn.toString(), ')()'], { type: 'application/javascript' });\n        var workerURL = URL.createObjectURL(workerBlob);\n        var worker = new Worker(workerURL);\n\n        var trips = [];\n\n        return {\n            transfer: function transfer() {}, // (message, cb) => {}\n            post: function post(message, cb, transferList) {\n                var id = getUniqueId();\n                trips[id] = cb;\n\n                worker.onmessage = function(e) {\n                    var cb = trips[e.data.id];\n                    if (!cb) return;\n                    cb(e.data.message);\n                    delete trips[e.data.id];\n                };\n\n                worker.postMessage(\n                    {\n                        id: id,\n                        message: message,\n                    },\n\n                    transferList\n                );\n            },\n            terminate: function terminate() {\n                worker.terminate();\n                URL.revokeObjectURL(workerURL);\n            },\n        };\n    };\n\n    var loadImage = function loadImage(url) {\n        return new Promise(function(resolve, reject) {\n            var img = new Image();\n            img.onload = function() {\n                resolve(img);\n            };\n            img.onerror = function(e) {\n                reject(e);\n            };\n            img.src = url;\n        });\n    };\n\n    var chain = function chain(funcs) {\n        return funcs.reduce(function(promise, func) {\n            return promise.then(function(result) {\n                return func().then(Array.prototype.concat.bind(result));\n            });\n        }, Promise.resolve([]));\n    };\n\n    var canvasApplyMarkup = function canvasApplyMarkup(canvas, markup) {\n        return new Promise(function(resolve) {\n            var size = {\n                width: canvas.width,\n                height: canvas.height,\n            };\n\n            var ctx = canvas.getContext('2d');\n\n            var drawers = markup.sort(sortMarkupByZIndex).map(function(item) {\n                return function() {\n                    return new Promise(function(resolve) {\n                        var result = TYPE_DRAW_ROUTES[item[0]](ctx, size, item[1], resolve);\n                        if (result) resolve();\n                    });\n                };\n            });\n\n            chain(drawers).then(function() {\n                return resolve(canvas);\n            });\n        });\n    };\n\n    var applyMarkupStyles = function applyMarkupStyles(ctx, styles) {\n        ctx.beginPath();\n        ctx.lineCap = styles['stroke-linecap'];\n        ctx.lineJoin = styles['stroke-linejoin'];\n        ctx.lineWidth = styles['stroke-width'];\n        if (styles['stroke-dasharray'].length) {\n            ctx.setLineDash(styles['stroke-dasharray'].split(','));\n        }\n        ctx.fillStyle = styles['fill'];\n        ctx.strokeStyle = styles['stroke'];\n        ctx.globalAlpha = styles.opacity || 1;\n    };\n\n    var drawMarkupStyles = function drawMarkupStyles(ctx) {\n        ctx.fill();\n        ctx.stroke();\n        ctx.globalAlpha = 1;\n    };\n\n    var drawRect = function drawRect(ctx, size, markup) {\n        var rect = getMarkupRect(markup, size);\n        var styles = getMarkupStyles(markup, size);\n        applyMarkupStyles(ctx, styles);\n        ctx.rect(rect.x, rect.y, rect.width, rect.height);\n        drawMarkupStyles(ctx, styles);\n        return true;\n    };\n\n    var drawEllipse = function drawEllipse(ctx, size, markup) {\n        var rect = getMarkupRect(markup, size);\n        var styles = getMarkupStyles(markup, size);\n        applyMarkupStyles(ctx, styles);\n\n        var x = rect.x,\n            y = rect.y,\n            w = rect.width,\n            h = rect.height,\n            kappa = 0.5522848,\n            ox = (w / 2) * kappa,\n            oy = (h / 2) * kappa,\n            xe = x + w,\n            ye = y + h,\n            xm = x + w / 2,\n            ym = y + h / 2;\n\n        ctx.moveTo(x, ym);\n        ctx.bezierCurveTo(x, ym - oy, xm - ox, y, xm, y);\n        ctx.bezierCurveTo(xm + ox, y, xe, ym - oy, xe, ym);\n        ctx.bezierCurveTo(xe, ym + oy, xm + ox, ye, xm, ye);\n        ctx.bezierCurveTo(xm - ox, ye, x, ym + oy, x, ym);\n\n        drawMarkupStyles(ctx, styles);\n        return true;\n    };\n\n    var drawImage = function drawImage(ctx, size, markup, done) {\n        var rect = getMarkupRect(markup, size);\n        var styles = getMarkupStyles(markup, size);\n        applyMarkupStyles(ctx, styles);\n\n        var image = new Image();\n\n        // if is cross origin image add cross origin attribute\n        var isCrossOriginImage =\n            new URL(markup.src, window.location.href).origin !== window.location.origin;\n        if (isCrossOriginImage) image.crossOrigin = '';\n\n        image.onload = function() {\n            if (markup.fit === 'cover') {\n                var ar = rect.width / rect.height;\n                var width = ar > 1 ? image.width : image.height * ar;\n                var height = ar > 1 ? image.width / ar : image.height;\n                var x = image.width * 0.5 - width * 0.5;\n                var y = image.height * 0.5 - height * 0.5;\n                ctx.drawImage(image, x, y, width, height, rect.x, rect.y, rect.width, rect.height);\n            } else if (markup.fit === 'contain') {\n                var scalar = Math.min(rect.width / image.width, rect.height / image.height);\n                var _width = scalar * image.width;\n                var _height = scalar * image.height;\n                var _x = rect.x + rect.width * 0.5 - _width * 0.5;\n                var _y = rect.y + rect.height * 0.5 - _height * 0.5;\n                ctx.drawImage(image, 0, 0, image.width, image.height, _x, _y, _width, _height);\n            } else {\n                ctx.drawImage(\n                    image,\n                    0,\n                    0,\n                    image.width,\n                    image.height,\n                    rect.x,\n                    rect.y,\n                    rect.width,\n                    rect.height\n                );\n            }\n\n            drawMarkupStyles(ctx, styles);\n            done();\n        };\n        image.src = markup.src;\n    };\n\n    var drawText = function drawText(ctx, size, markup) {\n        var rect = getMarkupRect(markup, size);\n        var styles = getMarkupStyles(markup, size);\n        applyMarkupStyles(ctx, styles);\n\n        var fontSize = getMarkupValue(markup.fontSize, size);\n        var fontFamily = markup.fontFamily || 'sans-serif';\n        var fontWeight = markup.fontWeight || 'normal';\n        var textAlign = markup.textAlign || 'left';\n\n        ctx.font = ''\n            .concat(fontWeight, ' ')\n            .concat(fontSize, 'px ')\n            .concat(fontFamily);\n        ctx.textAlign = textAlign;\n        ctx.fillText(markup.text, rect.x, rect.y);\n\n        drawMarkupStyles(ctx, styles);\n        return true;\n    };\n\n    var drawPath = function drawPath(ctx, size, markup) {\n        var styles = getMarkupStyles(markup, size);\n        applyMarkupStyles(ctx, styles);\n        ctx.beginPath();\n\n        var points = markup.points.map(function(point) {\n            return {\n                x: getMarkupValue(point.x, size, 1, 'width'),\n                y: getMarkupValue(point.y, size, 1, 'height'),\n            };\n        });\n\n        ctx.moveTo(points[0].x, points[0].y);\n        var l = points.length;\n        for (var i = 1; i < l; i++) {\n            ctx.lineTo(points[i].x, points[i].y);\n        }\n\n        drawMarkupStyles(ctx, styles);\n        return true;\n    };\n\n    var drawLine = function drawLine(ctx, size, markup) {\n        var rect = getMarkupRect(markup, size);\n        var styles = getMarkupStyles(markup, size);\n        applyMarkupStyles(ctx, styles);\n\n        ctx.beginPath();\n\n        var origin = {\n            x: rect.x,\n            y: rect.y,\n        };\n\n        var target = {\n            x: rect.x + rect.width,\n            y: rect.y + rect.height,\n        };\n\n        ctx.moveTo(origin.x, origin.y);\n        ctx.lineTo(target.x, target.y);\n\n        var v = vectorNormalize({\n            x: target.x - origin.x,\n            y: target.y - origin.y,\n        });\n\n        var l = 0.04 * Math.min(size.width, size.height);\n\n        if (markup.lineDecoration.indexOf('arrow-begin') !== -1) {\n            var arrowBeginRotationPoint = vectorMultiply(v, l);\n            var arrowBeginCenter = vectorAdd(origin, arrowBeginRotationPoint);\n            var arrowBeginA = vectorRotate(origin, 2, arrowBeginCenter);\n            var arrowBeginB = vectorRotate(origin, -2, arrowBeginCenter);\n\n            ctx.moveTo(arrowBeginA.x, arrowBeginA.y);\n            ctx.lineTo(origin.x, origin.y);\n            ctx.lineTo(arrowBeginB.x, arrowBeginB.y);\n        }\n        if (markup.lineDecoration.indexOf('arrow-end') !== -1) {\n            var arrowEndRotationPoint = vectorMultiply(v, -l);\n            var arrowEndCenter = vectorAdd(target, arrowEndRotationPoint);\n            var arrowEndA = vectorRotate(target, 2, arrowEndCenter);\n            var arrowEndB = vectorRotate(target, -2, arrowEndCenter);\n\n            ctx.moveTo(arrowEndA.x, arrowEndA.y);\n            ctx.lineTo(target.x, target.y);\n            ctx.lineTo(arrowEndB.x, arrowEndB.y);\n        }\n\n        drawMarkupStyles(ctx, styles);\n        return true;\n    };\n\n    var TYPE_DRAW_ROUTES = {\n        rect: drawRect,\n        ellipse: drawEllipse,\n        image: drawImage,\n        text: drawText,\n        line: drawLine,\n        path: drawPath,\n    };\n\n    var imageDataToCanvas = function imageDataToCanvas(imageData) {\n        var image = document.createElement('canvas');\n        image.width = imageData.width;\n        image.height = imageData.height;\n        var ctx = image.getContext('2d');\n        ctx.putImageData(imageData, 0, 0);\n        return image;\n    };\n\n    var transformImage = function transformImage(file, instructions) {\n        var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n        return new Promise(function(resolve, reject) {\n            // if the file is not an image we do not have any business transforming it\n            if (!file || !isImage$1(file))\n                return reject({ status: 'not an image file', file: file });\n\n            // get separate options for easier use\n            var stripImageHead = options.stripImageHead,\n                beforeCreateBlob = options.beforeCreateBlob,\n                afterCreateBlob = options.afterCreateBlob,\n                canvasMemoryLimit = options.canvasMemoryLimit;\n\n            // get crop\n            var crop = instructions.crop,\n                size = instructions.size,\n                filter = instructions.filter,\n                markup = instructions.markup,\n                output = instructions.output;\n\n            // get exif orientation\n            var orientation =\n                instructions.image && instructions.image.orientation\n                    ? Math.max(1, Math.min(8, instructions.image.orientation))\n                    : null;\n\n            // compression quality 0 => 100\n            var qualityAsPercentage = output && output.quality;\n            var quality = qualityAsPercentage === null ? null : qualityAsPercentage / 100;\n\n            // output format\n            var type = (output && output.type) || null;\n\n            // background color\n            var background = (output && output.background) || null;\n\n            // get transforms\n            var transforms = [];\n\n            // add resize transforms if set\n            if (size && (typeof size.width === 'number' || typeof size.height === 'number')) {\n                transforms.push({ type: 'resize', data: size });\n            }\n\n            // add filters\n            if (filter && filter.length === 20) {\n                transforms.push({ type: 'filter', data: filter });\n            }\n\n            // resolves with supplied blob\n            var resolveWithBlob = function resolveWithBlob(blob) {\n                var promisedBlob = afterCreateBlob ? afterCreateBlob(blob) : blob;\n                Promise.resolve(promisedBlob).then(resolve);\n            };\n\n            // done\n            var toBlob = function toBlob(imageData, options) {\n                var canvas = imageDataToCanvas(imageData);\n                var promisedCanvas = markup.length ? canvasApplyMarkup(canvas, markup) : canvas;\n                Promise.resolve(promisedCanvas).then(function(canvas) {\n                    canvasToBlob(canvas, options, beforeCreateBlob)\n                        .then(function(blob) {\n                            // force release of canvas memory\n                            canvasRelease(canvas);\n\n                            // remove image head (default)\n                            if (stripImageHead) return resolveWithBlob(blob);\n\n                            // try to copy image head from original file to generated blob\n                            getImageHead(file).then(function(imageHead) {\n                                // re-inject image head in case of JPEG, as the image head is removed by canvas export\n                                if (imageHead !== null) {\n                                    blob = new Blob([imageHead, blob.slice(20)], {\n                                        type: blob.type,\n                                    });\n                                }\n\n                                // done!\n                                resolveWithBlob(blob);\n                            });\n                        })\n                        .catch(reject);\n                });\n            };\n\n            // if this is an svg and we want it to stay an svg\n            if (/svg/.test(file.type) && type === null) {\n                return cropSVG(file, crop, markup, { background: background }).then(function(text) {\n                    resolve(createBlob(text, 'image/svg+xml'));\n                });\n            }\n\n            // get file url\n            var url = URL.createObjectURL(file);\n\n            // turn the file into an image\n            loadImage(url)\n                .then(function(image) {\n                    // url is no longer needed\n                    URL.revokeObjectURL(url);\n\n                    // draw to canvas and start transform chain\n                    var imageData = imageToImageData(image, orientation, crop, {\n                        canvasMemoryLimit: canvasMemoryLimit,\n                        background: background,\n                    });\n\n                    // determine the format of the blob that we will output\n                    var outputFormat = {\n                        quality: quality,\n                        type: type || file.type,\n                    };\n\n                    // no transforms necessary, we done!\n                    if (!transforms.length) {\n                        return toBlob(imageData, outputFormat);\n                    }\n\n                    // send to the transform worker to transform the blob on a separate thread\n                    var worker = createWorker(TransformWorker);\n                    worker.post(\n                        {\n                            transforms: transforms,\n                            imageData: imageData,\n                        },\n\n                        function(response) {\n                            // finish up\n                            toBlob(objectToImageData(response), outputFormat);\n\n                            // stop worker\n                            worker.terminate();\n                        },\n                        [imageData.data.buffer]\n                    );\n                })\n                .catch(reject);\n        });\n    };\n\n    function _typeof(obj) {\n        if (typeof Symbol === 'function' && typeof Symbol.iterator === 'symbol') {\n            _typeof = function(obj) {\n                return typeof obj;\n            };\n        } else {\n            _typeof = function(obj) {\n                return obj &&\n                    typeof Symbol === 'function' &&\n                    obj.constructor === Symbol &&\n                    obj !== Symbol.prototype\n                    ? 'symbol'\n                    : typeof obj;\n            };\n        }\n\n        return _typeof(obj);\n    }\n\n    var REACT_ELEMENT_TYPE;\n\n    function _jsx(type, props, key, children) {\n        if (!REACT_ELEMENT_TYPE) {\n            REACT_ELEMENT_TYPE =\n                (typeof Symbol === 'function' && Symbol.for && Symbol.for('react.element')) ||\n                0xeac7;\n        }\n\n        var defaultProps = type && type.defaultProps;\n        var childrenLength = arguments.length - 3;\n\n        if (!props && childrenLength !== 0) {\n            props = {\n                children: void 0,\n            };\n        }\n\n        if (props && defaultProps) {\n            for (var propName in defaultProps) {\n                if (props[propName] === void 0) {\n                    props[propName] = defaultProps[propName];\n                }\n            }\n        } else if (!props) {\n            props = defaultProps || {};\n        }\n\n        if (childrenLength === 1) {\n            props.children = children;\n        } else if (childrenLength > 1) {\n            var childArray = new Array(childrenLength);\n\n            for (var i = 0; i < childrenLength; i++) {\n                childArray[i] = arguments[i + 3];\n            }\n\n            props.children = childArray;\n        }\n\n        return {\n            $$typeof: REACT_ELEMENT_TYPE,\n            type: type,\n            key: key === undefined ? null : '' + key,\n            ref: null,\n            props: props,\n            _owner: null,\n        };\n    }\n\n    function _asyncIterator(iterable) {\n        var method;\n\n        if (typeof Symbol === 'function') {\n            if (Symbol.asyncIterator) {\n                method = iterable[Symbol.asyncIterator];\n                if (method != null) return method.call(iterable);\n            }\n\n            if (Symbol.iterator) {\n                method = iterable[Symbol.iterator];\n                if (method != null) return method.call(iterable);\n            }\n        }\n\n        throw new TypeError('Object is not async iterable');\n    }\n\n    function _AwaitValue(value) {\n        this.wrapped = value;\n    }\n\n    function _AsyncGenerator(gen) {\n        var front, back;\n\n        function send(key, arg) {\n            return new Promise(function(resolve, reject) {\n                var request = {\n                    key: key,\n                    arg: arg,\n                    resolve: resolve,\n                    reject: reject,\n                    next: null,\n                };\n\n                if (back) {\n                    back = back.next = request;\n                } else {\n                    front = back = request;\n                    resume(key, arg);\n                }\n            });\n        }\n\n        function resume(key, arg) {\n            try {\n                var result = gen[key](arg);\n                var value = result.value;\n                var wrappedAwait = value instanceof _AwaitValue;\n                Promise.resolve(wrappedAwait ? value.wrapped : value).then(\n                    function(arg) {\n                        if (wrappedAwait) {\n                            resume('next', arg);\n                            return;\n                        }\n\n                        settle(result.done ? 'return' : 'normal', arg);\n                    },\n                    function(err) {\n                        resume('throw', err);\n                    }\n                );\n            } catch (err) {\n                settle('throw', err);\n            }\n        }\n\n        function settle(type, value) {\n            switch (type) {\n                case 'return':\n                    front.resolve({\n                        value: value,\n                        done: true,\n                    });\n                    break;\n\n                case 'throw':\n                    front.reject(value);\n                    break;\n\n                default:\n                    front.resolve({\n                        value: value,\n                        done: false,\n                    });\n                    break;\n            }\n\n            front = front.next;\n\n            if (front) {\n                resume(front.key, front.arg);\n            } else {\n                back = null;\n            }\n        }\n\n        this._invoke = send;\n\n        if (typeof gen.return !== 'function') {\n            this.return = undefined;\n        }\n    }\n\n    if (typeof Symbol === 'function' && Symbol.asyncIterator) {\n        _AsyncGenerator.prototype[Symbol.asyncIterator] = function() {\n            return this;\n        };\n    }\n\n    _AsyncGenerator.prototype.next = function(arg) {\n        return this._invoke('next', arg);\n    };\n\n    _AsyncGenerator.prototype.throw = function(arg) {\n        return this._invoke('throw', arg);\n    };\n\n    _AsyncGenerator.prototype.return = function(arg) {\n        return this._invoke('return', arg);\n    };\n\n    function _wrapAsyncGenerator(fn) {\n        return function() {\n            return new _AsyncGenerator(fn.apply(this, arguments));\n        };\n    }\n\n    function _awaitAsyncGenerator(value) {\n        return new _AwaitValue(value);\n    }\n\n    function _asyncGeneratorDelegate(inner, awaitWrap) {\n        var iter = {},\n            waiting = false;\n\n        function pump(key, value) {\n            waiting = true;\n            value = new Promise(function(resolve) {\n                resolve(inner[key](value));\n            });\n            return {\n                done: false,\n                value: awaitWrap(value),\n            };\n        }\n\n        if (typeof Symbol === 'function' && Symbol.iterator) {\n            iter[Symbol.iterator] = function() {\n                return this;\n            };\n        }\n\n        iter.next = function(value) {\n            if (waiting) {\n                waiting = false;\n                return value;\n            }\n\n            return pump('next', value);\n        };\n\n        if (typeof inner.throw === 'function') {\n            iter.throw = function(value) {\n                if (waiting) {\n                    waiting = false;\n                    throw value;\n                }\n\n                return pump('throw', value);\n            };\n        }\n\n        if (typeof inner.return === 'function') {\n            iter.return = function(value) {\n                return pump('return', value);\n            };\n        }\n\n        return iter;\n    }\n\n    function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n        try {\n            var info = gen[key](arg);\n            var value = info.value;\n        } catch (error) {\n            reject(error);\n            return;\n        }\n\n        if (info.done) {\n            resolve(value);\n        } else {\n            Promise.resolve(value).then(_next, _throw);\n        }\n    }\n\n    function _asyncToGenerator(fn) {\n        return function() {\n            var self = this,\n                args = arguments;\n            return new Promise(function(resolve, reject) {\n                var gen = fn.apply(self, args);\n\n                function _next(value) {\n                    asyncGeneratorStep(gen, resolve, reject, _next, _throw, 'next', value);\n                }\n\n                function _throw(err) {\n                    asyncGeneratorStep(gen, resolve, reject, _next, _throw, 'throw', err);\n                }\n\n                _next(undefined);\n            });\n        };\n    }\n\n    function _classCallCheck(instance, Constructor) {\n        if (!(instance instanceof Constructor)) {\n            throw new TypeError('Cannot call a class as a function');\n        }\n    }\n\n    function _defineProperties(target, props) {\n        for (var i = 0; i < props.length; i++) {\n            var descriptor = props[i];\n            descriptor.enumerable = descriptor.enumerable || false;\n            descriptor.configurable = true;\n            if ('value' in descriptor) descriptor.writable = true;\n            Object.defineProperty(target, descriptor.key, descriptor);\n        }\n    }\n\n    function _createClass(Constructor, protoProps, staticProps) {\n        if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n        if (staticProps) _defineProperties(Constructor, staticProps);\n        return Constructor;\n    }\n\n    function _defineEnumerableProperties(obj, descs) {\n        for (var key in descs) {\n            var desc = descs[key];\n            desc.configurable = desc.enumerable = true;\n            if ('value' in desc) desc.writable = true;\n            Object.defineProperty(obj, key, desc);\n        }\n\n        if (Object.getOwnPropertySymbols) {\n            var objectSymbols = Object.getOwnPropertySymbols(descs);\n\n            for (var i = 0; i < objectSymbols.length; i++) {\n                var sym = objectSymbols[i];\n                var desc = descs[sym];\n                desc.configurable = desc.enumerable = true;\n                if ('value' in desc) desc.writable = true;\n                Object.defineProperty(obj, sym, desc);\n            }\n        }\n\n        return obj;\n    }\n\n    function _defaults(obj, defaults) {\n        var keys = Object.getOwnPropertyNames(defaults);\n\n        for (var i = 0; i < keys.length; i++) {\n            var key = keys[i];\n            var value = Object.getOwnPropertyDescriptor(defaults, key);\n\n            if (value && value.configurable && obj[key] === undefined) {\n                Object.defineProperty(obj, key, value);\n            }\n        }\n\n        return obj;\n    }\n\n    function _defineProperty(obj, key, value) {\n        if (key in obj) {\n            Object.defineProperty(obj, key, {\n                value: value,\n                enumerable: true,\n                configurable: true,\n                writable: true,\n            });\n        } else {\n            obj[key] = value;\n        }\n\n        return obj;\n    }\n\n    function _extends() {\n        _extends =\n            Object.assign ||\n            function(target) {\n                for (var i = 1; i < arguments.length; i++) {\n                    var source = arguments[i];\n\n                    for (var key in source) {\n                        if (Object.prototype.hasOwnProperty.call(source, key)) {\n                            target[key] = source[key];\n                        }\n                    }\n                }\n\n                return target;\n            };\n\n        return _extends.apply(this, arguments);\n    }\n\n    function _objectSpread(target) {\n        for (var i = 1; i < arguments.length; i++) {\n            var source = arguments[i] != null ? arguments[i] : {};\n            var ownKeys = Object.keys(source);\n\n            if (typeof Object.getOwnPropertySymbols === 'function') {\n                ownKeys = ownKeys.concat(\n                    Object.getOwnPropertySymbols(source).filter(function(sym) {\n                        return Object.getOwnPropertyDescriptor(source, sym).enumerable;\n                    })\n                );\n            }\n\n            ownKeys.forEach(function(key) {\n                _defineProperty(target, key, source[key]);\n            });\n        }\n\n        return target;\n    }\n\n    function _inherits(subClass, superClass) {\n        if (typeof superClass !== 'function' && superClass !== null) {\n            throw new TypeError('Super expression must either be null or a function');\n        }\n\n        subClass.prototype = Object.create(superClass && superClass.prototype, {\n            constructor: {\n                value: subClass,\n                writable: true,\n                configurable: true,\n            },\n        });\n        if (superClass) _setPrototypeOf(subClass, superClass);\n    }\n\n    function _inheritsLoose(subClass, superClass) {\n        subClass.prototype = Object.create(superClass.prototype);\n        subClass.prototype.constructor = subClass;\n        subClass.__proto__ = superClass;\n    }\n\n    function _getPrototypeOf(o) {\n        _getPrototypeOf = Object.setPrototypeOf\n            ? Object.getPrototypeOf\n            : function _getPrototypeOf(o) {\n                  return o.__proto__ || Object.getPrototypeOf(o);\n              };\n        return _getPrototypeOf(o);\n    }\n\n    function _setPrototypeOf(o, p) {\n        _setPrototypeOf =\n            Object.setPrototypeOf ||\n            function _setPrototypeOf(o, p) {\n                o.__proto__ = p;\n                return o;\n            };\n\n        return _setPrototypeOf(o, p);\n    }\n\n    function isNativeReflectConstruct() {\n        if (typeof Reflect === 'undefined' || !Reflect.construct) return false;\n        if (Reflect.construct.sham) return false;\n        if (typeof Proxy === 'function') return true;\n\n        try {\n            Date.prototype.toString.call(Reflect.construct(Date, [], function() {}));\n            return true;\n        } catch (e) {\n            return false;\n        }\n    }\n\n    function _construct(Parent, args, Class) {\n        if (isNativeReflectConstruct()) {\n            _construct = Reflect.construct;\n        } else {\n            _construct = function _construct(Parent, args, Class) {\n                var a = [null];\n                a.push.apply(a, args);\n                var Constructor = Function.bind.apply(Parent, a);\n                var instance = new Constructor();\n                if (Class) _setPrototypeOf(instance, Class.prototype);\n                return instance;\n            };\n        }\n\n        return _construct.apply(null, arguments);\n    }\n\n    function _isNativeFunction(fn) {\n        return Function.toString.call(fn).indexOf('[native code]') !== -1;\n    }\n\n    function _wrapNativeSuper(Class) {\n        var _cache = typeof Map === 'function' ? new Map() : undefined;\n\n        _wrapNativeSuper = function _wrapNativeSuper(Class) {\n            if (Class === null || !_isNativeFunction(Class)) return Class;\n\n            if (typeof Class !== 'function') {\n                throw new TypeError('Super expression must either be null or a function');\n            }\n\n            if (typeof _cache !== 'undefined') {\n                if (_cache.has(Class)) return _cache.get(Class);\n\n                _cache.set(Class, Wrapper);\n            }\n\n            function Wrapper() {\n                return _construct(Class, arguments, _getPrototypeOf(this).constructor);\n            }\n\n            Wrapper.prototype = Object.create(Class.prototype, {\n                constructor: {\n                    value: Wrapper,\n                    enumerable: false,\n                    writable: true,\n                    configurable: true,\n                },\n            });\n            return _setPrototypeOf(Wrapper, Class);\n        };\n\n        return _wrapNativeSuper(Class);\n    }\n\n    function _instanceof(left, right) {\n        if (right != null && typeof Symbol !== 'undefined' && right[Symbol.hasInstance]) {\n            return right[Symbol.hasInstance](left);\n        } else {\n            return left instanceof right;\n        }\n    }\n\n    function _interopRequireDefault(obj) {\n        return obj && obj.__esModule\n            ? obj\n            : {\n                  default: obj,\n              };\n    }\n\n    function _interopRequireWildcard(obj) {\n        if (obj && obj.__esModule) {\n            return obj;\n        } else {\n            var newObj = {};\n\n            if (obj != null) {\n                for (var key in obj) {\n                    if (Object.prototype.hasOwnProperty.call(obj, key)) {\n                        var desc =\n                            Object.defineProperty && Object.getOwnPropertyDescriptor\n                                ? Object.getOwnPropertyDescriptor(obj, key)\n                                : {};\n\n                        if (desc.get || desc.set) {\n                            Object.defineProperty(newObj, key, desc);\n                        } else {\n                            newObj[key] = obj[key];\n                        }\n                    }\n                }\n            }\n\n            newObj.default = obj;\n            return newObj;\n        }\n    }\n\n    function _newArrowCheck(innerThis, boundThis) {\n        if (innerThis !== boundThis) {\n            throw new TypeError('Cannot instantiate an arrow function');\n        }\n    }\n\n    function _objectDestructuringEmpty(obj) {\n        if (obj == null) throw new TypeError('Cannot destructure undefined');\n    }\n\n    function _objectWithoutPropertiesLoose(source, excluded) {\n        if (source == null) return {};\n        var target = {};\n        var sourceKeys = Object.keys(source);\n        var key, i;\n\n        for (i = 0; i < sourceKeys.length; i++) {\n            key = sourceKeys[i];\n            if (excluded.indexOf(key) >= 0) continue;\n            target[key] = source[key];\n        }\n\n        return target;\n    }\n\n    function _objectWithoutProperties(source, excluded) {\n        if (source == null) return {};\n\n        var target = _objectWithoutPropertiesLoose(source, excluded);\n\n        var key, i;\n\n        if (Object.getOwnPropertySymbols) {\n            var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n\n            for (i = 0; i < sourceSymbolKeys.length; i++) {\n                key = sourceSymbolKeys[i];\n                if (excluded.indexOf(key) >= 0) continue;\n                if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n                target[key] = source[key];\n            }\n        }\n\n        return target;\n    }\n\n    function _assertThisInitialized(self) {\n        if (self === void 0) {\n            throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n        }\n\n        return self;\n    }\n\n    function _possibleConstructorReturn(self, call) {\n        if (call && (typeof call === 'object' || typeof call === 'function')) {\n            return call;\n        }\n\n        return _assertThisInitialized(self);\n    }\n\n    function _superPropBase(object, property) {\n        while (!Object.prototype.hasOwnProperty.call(object, property)) {\n            object = _getPrototypeOf(object);\n            if (object === null) break;\n        }\n\n        return object;\n    }\n\n    function _get(target, property, receiver) {\n        if (typeof Reflect !== 'undefined' && Reflect.get) {\n            _get = Reflect.get;\n        } else {\n            _get = function _get(target, property, receiver) {\n                var base = _superPropBase(target, property);\n\n                if (!base) return;\n                var desc = Object.getOwnPropertyDescriptor(base, property);\n\n                if (desc.get) {\n                    return desc.get.call(receiver);\n                }\n\n                return desc.value;\n            };\n        }\n\n        return _get(target, property, receiver || target);\n    }\n\n    function set(target, property, value, receiver) {\n        if (typeof Reflect !== 'undefined' && Reflect.set) {\n            set = Reflect.set;\n        } else {\n            set = function set(target, property, value, receiver) {\n                var base = _superPropBase(target, property);\n\n                var desc;\n\n                if (base) {\n                    desc = Object.getOwnPropertyDescriptor(base, property);\n\n                    if (desc.set) {\n                        desc.set.call(receiver, value);\n                        return true;\n                    } else if (!desc.writable) {\n                        return false;\n                    }\n                }\n\n                desc = Object.getOwnPropertyDescriptor(receiver, property);\n\n                if (desc) {\n                    if (!desc.writable) {\n                        return false;\n                    }\n\n                    desc.value = value;\n                    Object.defineProperty(receiver, property, desc);\n                } else {\n                    _defineProperty(receiver, property, value);\n                }\n\n                return true;\n            };\n        }\n\n        return set(target, property, value, receiver);\n    }\n\n    function _set(target, property, value, receiver, isStrict) {\n        var s = set(target, property, value, receiver || target);\n\n        if (!s && isStrict) {\n            throw new Error('failed to set property');\n        }\n\n        return value;\n    }\n\n    function _taggedTemplateLiteral(strings, raw) {\n        if (!raw) {\n            raw = strings.slice(0);\n        }\n\n        return Object.freeze(\n            Object.defineProperties(strings, {\n                raw: {\n                    value: Object.freeze(raw),\n                },\n            })\n        );\n    }\n\n    function _taggedTemplateLiteralLoose(strings, raw) {\n        if (!raw) {\n            raw = strings.slice(0);\n        }\n\n        strings.raw = raw;\n        return strings;\n    }\n\n    function _temporalRef(val, name) {\n        if (val === _temporalUndefined) {\n            throw new ReferenceError(name + ' is not defined - temporal dead zone');\n        } else {\n            return val;\n        }\n    }\n\n    function _readOnlyError(name) {\n        throw new Error('\"' + name + '\" is read-only');\n    }\n\n    function _classNameTDZError(name) {\n        throw new Error('Class \"' + name + '\" cannot be referenced in computed property keys.');\n    }\n\n    var _temporalUndefined = {};\n\n    function _slicedToArray(arr, i) {\n        return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _nonIterableRest();\n    }\n\n    function _slicedToArrayLoose(arr, i) {\n        return _arrayWithHoles(arr) || _iterableToArrayLimitLoose(arr, i) || _nonIterableRest();\n    }\n\n    function _toArray(arr) {\n        return _arrayWithHoles(arr) || _iterableToArray(arr) || _nonIterableRest();\n    }\n\n    function _toConsumableArray(arr) {\n        return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread();\n    }\n\n    function _arrayWithoutHoles(arr) {\n        if (Array.isArray(arr)) {\n            for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) arr2[i] = arr[i];\n\n            return arr2;\n        }\n    }\n\n    function _arrayWithHoles(arr) {\n        if (Array.isArray(arr)) return arr;\n    }\n\n    function _iterableToArray(iter) {\n        if (\n            Symbol.iterator in Object(iter) ||\n            Object.prototype.toString.call(iter) === '[object Arguments]'\n        )\n            return Array.from(iter);\n    }\n\n    function _iterableToArrayLimit(arr, i) {\n        var _arr = [];\n        var _n = true;\n        var _d = false;\n        var _e = undefined;\n\n        try {\n            for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n                _arr.push(_s.value);\n\n                if (i && _arr.length === i) break;\n            }\n        } catch (err) {\n            _d = true;\n            _e = err;\n        } finally {\n            try {\n                if (!_n && _i['return'] != null) _i['return']();\n            } finally {\n                if (_d) throw _e;\n            }\n        }\n\n        return _arr;\n    }\n\n    function _iterableToArrayLimitLoose(arr, i) {\n        var _arr = [];\n\n        for (var _iterator = arr[Symbol.iterator](), _step; !(_step = _iterator.next()).done; ) {\n            _arr.push(_step.value);\n\n            if (i && _arr.length === i) break;\n        }\n\n        return _arr;\n    }\n\n    function _nonIterableSpread() {\n        throw new TypeError('Invalid attempt to spread non-iterable instance');\n    }\n\n    function _nonIterableRest() {\n        throw new TypeError('Invalid attempt to destructure non-iterable instance');\n    }\n\n    function _skipFirstGeneratorNext(fn) {\n        return function() {\n            var it = fn.apply(this, arguments);\n            it.next();\n            return it;\n        };\n    }\n\n    function _toPrimitive(input, hint) {\n        if (typeof input !== 'object' || input === null) return input;\n        var prim = input[Symbol.toPrimitive];\n\n        if (prim !== undefined) {\n            var res = prim.call(input, hint || 'default');\n            if (typeof res !== 'object') return res;\n            throw new TypeError('@@toPrimitive must return a primitive value.');\n        }\n\n        return (hint === 'string' ? String : Number)(input);\n    }\n\n    function _toPropertyKey(arg) {\n        var key = _toPrimitive(arg, 'string');\n\n        return typeof key === 'symbol' ? key : String(key);\n    }\n\n    function _initializerWarningHelper(descriptor, context) {\n        throw new Error(\n            'Decorating class property failed. Please ensure that ' +\n                'proposal-class-properties is enabled and set to use loose mode. ' +\n                'To use proposal-class-properties in spec mode with decorators, wait for ' +\n                'the next major version of decorators in stage 2.'\n        );\n    }\n\n    function _initializerDefineProperty(target, property, descriptor, context) {\n        if (!descriptor) return;\n        Object.defineProperty(target, property, {\n            enumerable: descriptor.enumerable,\n            configurable: descriptor.configurable,\n            writable: descriptor.writable,\n            value: descriptor.initializer ? descriptor.initializer.call(context) : void 0,\n        });\n    }\n\n    function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) {\n        var desc = {};\n        Object.keys(descriptor).forEach(function(key) {\n            desc[key] = descriptor[key];\n        });\n        desc.enumerable = !!desc.enumerable;\n        desc.configurable = !!desc.configurable;\n\n        if ('value' in desc || desc.initializer) {\n            desc.writable = true;\n        }\n\n        desc = decorators\n            .slice()\n            .reverse()\n            .reduce(function(desc, decorator) {\n                return decorator(target, property, desc) || desc;\n            }, desc);\n\n        if (context && desc.initializer !== void 0) {\n            desc.value = desc.initializer ? desc.initializer.call(context) : void 0;\n            desc.initializer = undefined;\n        }\n\n        if (desc.initializer === void 0) {\n            Object.defineProperty(target, property, desc);\n            desc = null;\n        }\n\n        return desc;\n    }\n\n    var id = 0;\n\n    function _classPrivateFieldLooseKey(name) {\n        return '__private_' + id++ + '_' + name;\n    }\n\n    function _classPrivateFieldLooseBase(receiver, privateKey) {\n        if (!Object.prototype.hasOwnProperty.call(receiver, privateKey)) {\n            throw new TypeError('attempted to use private field on non-instance');\n        }\n\n        return receiver;\n    }\n\n    function _classPrivateFieldGet(receiver, privateMap) {\n        if (!privateMap.has(receiver)) {\n            throw new TypeError('attempted to get private field on non-instance');\n        }\n\n        var descriptor = privateMap.get(receiver);\n\n        if (descriptor.get) {\n            return descriptor.get.call(receiver);\n        }\n\n        return descriptor.value;\n    }\n\n    function _classPrivateFieldSet(receiver, privateMap, value) {\n        if (!privateMap.has(receiver)) {\n            throw new TypeError('attempted to set private field on non-instance');\n        }\n\n        var descriptor = privateMap.get(receiver);\n\n        if (descriptor.set) {\n            descriptor.set.call(receiver, value);\n        } else {\n            if (!descriptor.writable) {\n                throw new TypeError('attempted to set read only private field');\n            }\n\n            descriptor.value = value;\n        }\n\n        return value;\n    }\n\n    function _classStaticPrivateFieldSpecGet(receiver, classConstructor, descriptor) {\n        if (receiver !== classConstructor) {\n            throw new TypeError('Private static access of wrong provenance');\n        }\n\n        return descriptor.value;\n    }\n\n    function _classStaticPrivateFieldSpecSet(receiver, classConstructor, descriptor, value) {\n        if (receiver !== classConstructor) {\n            throw new TypeError('Private static access of wrong provenance');\n        }\n\n        if (!descriptor.writable) {\n            throw new TypeError('attempted to set read only private field');\n        }\n\n        descriptor.value = value;\n        return value;\n    }\n\n    function _classStaticPrivateMethodGet(receiver, classConstructor, method) {\n        if (receiver !== classConstructor) {\n            throw new TypeError('Private static access of wrong provenance');\n        }\n\n        return method;\n    }\n\n    function _classStaticPrivateMethodSet() {\n        throw new TypeError('attempted to set read only static private field');\n    }\n\n    function _decorate(decorators, factory, superClass, mixins) {\n        var api = _getDecoratorsApi();\n\n        if (mixins) {\n            for (var i = 0; i < mixins.length; i++) {\n                api = mixins[i](api);\n            }\n        }\n\n        var r = factory(function initialize(O) {\n            api.initializeInstanceElements(O, decorated.elements);\n        }, superClass);\n        var decorated = api.decorateClass(\n            _coalesceClassElements(r.d.map(_createElementDescriptor)),\n            decorators\n        );\n        api.initializeClassElements(r.F, decorated.elements);\n        return api.runClassFinishers(r.F, decorated.finishers);\n    }\n\n    function _getDecoratorsApi() {\n        _getDecoratorsApi = function() {\n            return api;\n        };\n\n        var api = {\n            elementsDefinitionOrder: [['method'], ['field']],\n            initializeInstanceElements: function(O, elements) {\n                ['method', 'field'].forEach(function(kind) {\n                    elements.forEach(function(element) {\n                        if (element.kind === kind && element.placement === 'own') {\n                            this.defineClassElement(O, element);\n                        }\n                    }, this);\n                }, this);\n            },\n            initializeClassElements: function(F, elements) {\n                var proto = F.prototype;\n                ['method', 'field'].forEach(function(kind) {\n                    elements.forEach(function(element) {\n                        var placement = element.placement;\n\n                        if (\n                            element.kind === kind &&\n                            (placement === 'static' || placement === 'prototype')\n                        ) {\n                            var receiver = placement === 'static' ? F : proto;\n                            this.defineClassElement(receiver, element);\n                        }\n                    }, this);\n                }, this);\n            },\n            defineClassElement: function(receiver, element) {\n                var descriptor = element.descriptor;\n\n                if (element.kind === 'field') {\n                    var initializer = element.initializer;\n                    descriptor = {\n                        enumerable: descriptor.enumerable,\n                        writable: descriptor.writable,\n                        configurable: descriptor.configurable,\n                        value: initializer === void 0 ? void 0 : initializer.call(receiver),\n                    };\n                }\n\n                Object.defineProperty(receiver, element.key, descriptor);\n            },\n            decorateClass: function(elements, decorators) {\n                var newElements = [];\n                var finishers = [];\n                var placements = {\n                    static: [],\n                    prototype: [],\n                    own: [],\n                };\n                elements.forEach(function(element) {\n                    this.addElementPlacement(element, placements);\n                }, this);\n                elements.forEach(function(element) {\n                    if (!_hasDecorators(element)) return newElements.push(element);\n                    var elementFinishersExtras = this.decorateElement(element, placements);\n                    newElements.push(elementFinishersExtras.element);\n                    newElements.push.apply(newElements, elementFinishersExtras.extras);\n                    finishers.push.apply(finishers, elementFinishersExtras.finishers);\n                }, this);\n\n                if (!decorators) {\n                    return {\n                        elements: newElements,\n                        finishers: finishers,\n                    };\n                }\n\n                var result = this.decorateConstructor(newElements, decorators);\n                finishers.push.apply(finishers, result.finishers);\n                result.finishers = finishers;\n                return result;\n            },\n            addElementPlacement: function(element, placements, silent) {\n                var keys = placements[element.placement];\n\n                if (!silent && keys.indexOf(element.key) !== -1) {\n                    throw new TypeError('Duplicated element (' + element.key + ')');\n                }\n\n                keys.push(element.key);\n            },\n            decorateElement: function(element, placements) {\n                var extras = [];\n                var finishers = [];\n\n                for (var decorators = element.decorators, i = decorators.length - 1; i >= 0; i--) {\n                    var keys = placements[element.placement];\n                    keys.splice(keys.indexOf(element.key), 1);\n                    var elementObject = this.fromElementDescriptor(element);\n                    var elementFinisherExtras = this.toElementFinisherExtras(\n                        (0, decorators[i])(elementObject) || elementObject\n                    );\n                    element = elementFinisherExtras.element;\n                    this.addElementPlacement(element, placements);\n\n                    if (elementFinisherExtras.finisher) {\n                        finishers.push(elementFinisherExtras.finisher);\n                    }\n\n                    var newExtras = elementFinisherExtras.extras;\n\n                    if (newExtras) {\n                        for (var j = 0; j < newExtras.length; j++) {\n                            this.addElementPlacement(newExtras[j], placements);\n                        }\n\n                        extras.push.apply(extras, newExtras);\n                    }\n                }\n\n                return {\n                    element: element,\n                    finishers: finishers,\n                    extras: extras,\n                };\n            },\n            decorateConstructor: function(elements, decorators) {\n                var finishers = [];\n\n                for (var i = decorators.length - 1; i >= 0; i--) {\n                    var obj = this.fromClassDescriptor(elements);\n                    var elementsAndFinisher = this.toClassDescriptor(\n                        (0, decorators[i])(obj) || obj\n                    );\n\n                    if (elementsAndFinisher.finisher !== undefined) {\n                        finishers.push(elementsAndFinisher.finisher);\n                    }\n\n                    if (elementsAndFinisher.elements !== undefined) {\n                        elements = elementsAndFinisher.elements;\n\n                        for (var j = 0; j < elements.length - 1; j++) {\n                            for (var k = j + 1; k < elements.length; k++) {\n                                if (\n                                    elements[j].key === elements[k].key &&\n                                    elements[j].placement === elements[k].placement\n                                ) {\n                                    throw new TypeError(\n                                        'Duplicated element (' + elements[j].key + ')'\n                                    );\n                                }\n                            }\n                        }\n                    }\n                }\n\n                return {\n                    elements: elements,\n                    finishers: finishers,\n                };\n            },\n            fromElementDescriptor: function(element) {\n                var obj = {\n                    kind: element.kind,\n                    key: element.key,\n                    placement: element.placement,\n                    descriptor: element.descriptor,\n                };\n                var desc = {\n                    value: 'Descriptor',\n                    configurable: true,\n                };\n                Object.defineProperty(obj, Symbol.toStringTag, desc);\n                if (element.kind === 'field') obj.initializer = element.initializer;\n                return obj;\n            },\n            toElementDescriptors: function(elementObjects) {\n                if (elementObjects === undefined) return;\n                return _toArray(elementObjects).map(function(elementObject) {\n                    var element = this.toElementDescriptor(elementObject);\n                    this.disallowProperty(elementObject, 'finisher', 'An element descriptor');\n                    this.disallowProperty(elementObject, 'extras', 'An element descriptor');\n                    return element;\n                }, this);\n            },\n            toElementDescriptor: function(elementObject) {\n                var kind = String(elementObject.kind);\n\n                if (kind !== 'method' && kind !== 'field') {\n                    throw new TypeError(\n                        'An element descriptor\\'s .kind property must be either \"method\" or' +\n                            ' \"field\", but a decorator created an element descriptor with' +\n                            ' .kind \"' +\n                            kind +\n                            '\"'\n                    );\n                }\n\n                var key = _toPropertyKey(elementObject.key);\n\n                var placement = String(elementObject.placement);\n\n                if (placement !== 'static' && placement !== 'prototype' && placement !== 'own') {\n                    throw new TypeError(\n                        'An element descriptor\\'s .placement property must be one of \"static\",' +\n                            ' \"prototype\" or \"own\", but a decorator created an element descriptor' +\n                            ' with .placement \"' +\n                            placement +\n                            '\"'\n                    );\n                }\n\n                var descriptor = elementObject.descriptor;\n                this.disallowProperty(elementObject, 'elements', 'An element descriptor');\n                var element = {\n                    kind: kind,\n                    key: key,\n                    placement: placement,\n                    descriptor: Object.assign({}, descriptor),\n                };\n\n                if (kind !== 'field') {\n                    this.disallowProperty(elementObject, 'initializer', 'A method descriptor');\n                } else {\n                    this.disallowProperty(\n                        descriptor,\n                        'get',\n                        'The property descriptor of a field descriptor'\n                    );\n                    this.disallowProperty(\n                        descriptor,\n                        'set',\n                        'The property descriptor of a field descriptor'\n                    );\n                    this.disallowProperty(\n                        descriptor,\n                        'value',\n                        'The property descriptor of a field descriptor'\n                    );\n                    element.initializer = elementObject.initializer;\n                }\n\n                return element;\n            },\n            toElementFinisherExtras: function(elementObject) {\n                var element = this.toElementDescriptor(elementObject);\n\n                var finisher = _optionalCallableProperty(elementObject, 'finisher');\n\n                var extras = this.toElementDescriptors(elementObject.extras);\n                return {\n                    element: element,\n                    finisher: finisher,\n                    extras: extras,\n                };\n            },\n            fromClassDescriptor: function(elements) {\n                var obj = {\n                    kind: 'class',\n                    elements: elements.map(this.fromElementDescriptor, this),\n                };\n                var desc = {\n                    value: 'Descriptor',\n                    configurable: true,\n                };\n                Object.defineProperty(obj, Symbol.toStringTag, desc);\n                return obj;\n            },\n            toClassDescriptor: function(obj) {\n                var kind = String(obj.kind);\n\n                if (kind !== 'class') {\n                    throw new TypeError(\n                        'A class descriptor\\'s .kind property must be \"class\", but a decorator' +\n                            ' created a class descriptor with .kind \"' +\n                            kind +\n                            '\"'\n                    );\n                }\n\n                this.disallowProperty(obj, 'key', 'A class descriptor');\n                this.disallowProperty(obj, 'placement', 'A class descriptor');\n                this.disallowProperty(obj, 'descriptor', 'A class descriptor');\n                this.disallowProperty(obj, 'initializer', 'A class descriptor');\n                this.disallowProperty(obj, 'extras', 'A class descriptor');\n\n                var finisher = _optionalCallableProperty(obj, 'finisher');\n\n                var elements = this.toElementDescriptors(obj.elements);\n                return {\n                    elements: elements,\n                    finisher: finisher,\n                };\n            },\n            runClassFinishers: function(constructor, finishers) {\n                for (var i = 0; i < finishers.length; i++) {\n                    var newConstructor = (0, finishers[i])(constructor);\n\n                    if (newConstructor !== undefined) {\n                        if (typeof newConstructor !== 'function') {\n                            throw new TypeError('Finishers must return a constructor.');\n                        }\n\n                        constructor = newConstructor;\n                    }\n                }\n\n                return constructor;\n            },\n            disallowProperty: function(obj, name, objectType) {\n                if (obj[name] !== undefined) {\n                    throw new TypeError(objectType + \" can't have a .\" + name + ' property.');\n                }\n            },\n        };\n        return api;\n    }\n\n    function _createElementDescriptor(def) {\n        var key = _toPropertyKey(def.key);\n\n        var descriptor;\n\n        if (def.kind === 'method') {\n            descriptor = {\n                value: def.value,\n                writable: true,\n                configurable: true,\n                enumerable: false,\n            };\n        } else if (def.kind === 'get') {\n            descriptor = {\n                get: def.value,\n                configurable: true,\n                enumerable: false,\n            };\n        } else if (def.kind === 'set') {\n            descriptor = {\n                set: def.value,\n                configurable: true,\n                enumerable: false,\n            };\n        } else if (def.kind === 'field') {\n            descriptor = {\n                configurable: true,\n                writable: true,\n                enumerable: true,\n            };\n        }\n\n        var element = {\n            kind: def.kind === 'field' ? 'field' : 'method',\n            key: key,\n            placement: def.static ? 'static' : def.kind === 'field' ? 'own' : 'prototype',\n            descriptor: descriptor,\n        };\n        if (def.decorators) element.decorators = def.decorators;\n        if (def.kind === 'field') element.initializer = def.value;\n        return element;\n    }\n\n    function _coalesceGetterSetter(element, other) {\n        if (element.descriptor.get !== undefined) {\n            other.descriptor.get = element.descriptor.get;\n        } else {\n            other.descriptor.set = element.descriptor.set;\n        }\n    }\n\n    function _coalesceClassElements(elements) {\n        var newElements = [];\n\n        var isSameElement = function(other) {\n            return (\n                other.kind === 'method' &&\n                other.key === element.key &&\n                other.placement === element.placement\n            );\n        };\n\n        for (var i = 0; i < elements.length; i++) {\n            var element = elements[i];\n            var other;\n\n            if (element.kind === 'method' && (other = newElements.find(isSameElement))) {\n                if (_isDataDescriptor(element.descriptor) || _isDataDescriptor(other.descriptor)) {\n                    if (_hasDecorators(element) || _hasDecorators(other)) {\n                        throw new ReferenceError(\n                            'Duplicated methods (' + element.key + \") can't be decorated.\"\n                        );\n                    }\n\n                    other.descriptor = element.descriptor;\n                } else {\n                    if (_hasDecorators(element)) {\n                        if (_hasDecorators(other)) {\n                            throw new ReferenceError(\n                                \"Decorators can't be placed on different accessors with for \" +\n                                    'the same property (' +\n                                    element.key +\n                                    ').'\n                            );\n                        }\n\n                        other.decorators = element.decorators;\n                    }\n\n                    _coalesceGetterSetter(element, other);\n                }\n            } else {\n                newElements.push(element);\n            }\n        }\n\n        return newElements;\n    }\n\n    function _hasDecorators(element) {\n        return element.decorators && element.decorators.length;\n    }\n\n    function _isDataDescriptor(desc) {\n        return desc !== undefined && !(desc.value === undefined && desc.writable === undefined);\n    }\n\n    function _optionalCallableProperty(obj, name) {\n        var value = obj[name];\n\n        if (value !== undefined && typeof value !== 'function') {\n            throw new TypeError(\"Expected '\" + name + \"' to be a function\");\n        }\n\n        return value;\n    }\n\n    function _classPrivateMethodGet(receiver, privateSet, fn) {\n        if (!privateSet.has(receiver)) {\n            throw new TypeError('attempted to get private field on non-instance');\n        }\n\n        return fn;\n    }\n\n    function _classPrivateMethodSet() {\n        throw new TypeError('attempted to reassign private method');\n    }\n\n    function _wrapRegExp(re, groups) {\n        _wrapRegExp = function(re, groups) {\n            return new BabelRegExp(re, groups);\n        };\n\n        var _RegExp = _wrapNativeSuper(RegExp);\n\n        var _super = RegExp.prototype;\n\n        var _groups = new WeakMap();\n\n        function BabelRegExp(re, groups) {\n            var _this = _RegExp.call(this, re);\n\n            _groups.set(_this, groups);\n\n            return _this;\n        }\n\n        _inherits(BabelRegExp, _RegExp);\n\n        BabelRegExp.prototype.exec = function(str) {\n            var result = _super.exec.call(this, str);\n\n            if (result) result.groups = buildGroups(result, this);\n            return result;\n        };\n\n        BabelRegExp.prototype[Symbol.replace] = function(str, substitution) {\n            if (typeof substitution === 'string') {\n                var groups = _groups.get(this);\n\n                return _super[Symbol.replace].call(\n                    this,\n                    str,\n                    substitution.replace(/\\$<([^>]+)>/g, function(_, name) {\n                        return '$' + groups[name];\n                    })\n                );\n            } else if (typeof substitution === 'function') {\n                var _this = this;\n\n                return _super[Symbol.replace].call(this, str, function() {\n                    var args = [];\n                    args.push.apply(args, arguments);\n\n                    if (typeof args[args.length - 1] !== 'object') {\n                        args.push(buildGroups(args, _this));\n                    }\n\n                    return substitution.apply(this, args);\n                });\n            } else {\n                return _super[Symbol.replace].call(this, str, substitution);\n            }\n        };\n\n        function buildGroups(result, re) {\n            var g = _groups.get(re);\n\n            return Object.keys(g).reduce(function(groups, name) {\n                groups[name] = result[g[name]];\n                return groups;\n            }, Object.create(null));\n        }\n\n        return _wrapRegExp.apply(this, arguments);\n    }\n\n    var MARKUP_RECT = ['x', 'y', 'left', 'top', 'right', 'bottom', 'width', 'height'];\n\n    var toOptionalFraction = function toOptionalFraction(value) {\n        return typeof value === 'string' && /%/.test(value) ? parseFloat(value) / 100 : value;\n    };\n\n    // adds default markup properties, clones markup\n    var prepareMarkup = function prepareMarkup(markup) {\n        var _markup = _slicedToArray(markup, 2),\n            type = _markup[0],\n            props = _markup[1];\n\n        var rect = props.points\n            ? {}\n            : MARKUP_RECT.reduce(function(prev, curr) {\n                  prev[curr] = toOptionalFraction(props[curr]);\n                  return prev;\n              }, {});\n\n        return [\n            type,\n            Object.assign(\n                {\n                    zIndex: 0,\n                },\n                props,\n                rect\n            ),\n        ];\n    };\n\n    var getImageSize = function getImageSize(file) {\n        return new Promise(function(resolve, reject) {\n            var imageElement = new Image();\n            imageElement.src = URL.createObjectURL(file);\n\n            // start testing size\n            var measure = function measure() {\n                var width = imageElement.naturalWidth;\n                var height = imageElement.naturalHeight;\n                var hasSize = width && height;\n                if (!hasSize) return;\n\n                URL.revokeObjectURL(imageElement.src);\n                clearInterval(intervalId);\n                resolve({ width: width, height: height });\n            };\n\n            imageElement.onerror = function(err) {\n                URL.revokeObjectURL(imageElement.src);\n                clearInterval(intervalId);\n                reject(err);\n            };\n\n            var intervalId = setInterval(measure, 1);\n\n            measure();\n        });\n    };\n\n    /**\n     * Polyfill Edge and IE when in Browser\n     */\n    if (typeof window !== 'undefined' && typeof window.document !== 'undefined') {\n        if (!HTMLCanvasElement.prototype.toBlob) {\n            Object.defineProperty(HTMLCanvasElement.prototype, 'toBlob', {\n                value: function value(cb, type, quality) {\n                    var canvas = this;\n                    setTimeout(function() {\n                        var dataURL = canvas.toDataURL(type, quality).split(',')[1];\n                        var binStr = atob(dataURL);\n                        var index = binStr.length;\n                        var data = new Uint8Array(index);\n                        while (index--) {\n                            data[index] = binStr.charCodeAt(index);\n                        }\n                        cb(new Blob([data], { type: type || 'image/png' }));\n                    });\n                },\n            });\n        }\n    }\n\n    var isBrowser = typeof window !== 'undefined' && typeof window.document !== 'undefined';\n    var isIOS = isBrowser && /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;\n\n    /**\n     * Image Transform Plugin\n     */\n    var plugin = function plugin(_ref) {\n        var addFilter = _ref.addFilter,\n            utils = _ref.utils;\n        var Type = utils.Type,\n            forin = utils.forin,\n            getFileFromBlob = utils.getFileFromBlob,\n            isFile = utils.isFile;\n\n        /**\n         * Helper functions\n         */\n\n        // valid transforms (in correct order)\n        var TRANSFORM_LIST = ['crop', 'resize', 'filter', 'markup', 'output'];\n\n        var createVariantCreator = function createVariantCreator(updateMetadata) {\n            return function(transform, file, metadata) {\n                return transform(file, updateMetadata ? updateMetadata(metadata) : metadata);\n            };\n        };\n\n        var isDefaultCrop = function isDefaultCrop(crop) {\n            return (\n                crop.aspectRatio === null &&\n                crop.rotation === 0 &&\n                crop.zoom === 1 &&\n                crop.center &&\n                crop.center.x === 0.5 &&\n                crop.center.y === 0.5 &&\n                crop.flip &&\n                crop.flip.horizontal === false &&\n                crop.flip.vertical === false\n            );\n        };\n\n        /**\n         * Filters\n         */\n        addFilter('SHOULD_PREPARE_OUTPUT', function(shouldPrepareOutput, _ref2) {\n            var query = _ref2.query;\n            return new Promise(function(resolve) {\n                // If is not async should prepare now\n                resolve(!query('IS_ASYNC'));\n            });\n        });\n\n        var shouldTransformFile = function shouldTransformFile(query, file, item) {\n            return new Promise(function(resolve) {\n                if (\n                    !query('GET_ALLOW_IMAGE_TRANSFORM') ||\n                    item.archived ||\n                    !isFile(file) ||\n                    !isImage(file)\n                ) {\n                    return resolve(false);\n                }\n\n                // if size can't be read this browser doesn't support image\n                getImageSize(file)\n                    .then(function() {\n                        var fn = query('GET_IMAGE_TRANSFORM_IMAGE_FILTER');\n                        if (fn) {\n                            var filterResult = fn(file);\n                            if (filterResult == null) {\n                                // undefined or null\n                                return handleRevert(true);\n                            }\n                            if (typeof filterResult === 'boolean') {\n                                return resolve(filterResult);\n                            }\n                            if (typeof filterResult.then === 'function') {\n                                return filterResult.then(resolve);\n                            }\n                        }\n\n                        resolve(true);\n                    })\n                    .catch(function(err) {\n                        resolve(false);\n                    });\n            });\n        };\n\n        addFilter('DID_CREATE_ITEM', function(item, _ref3) {\n            var query = _ref3.query,\n                dispatch = _ref3.dispatch;\n            if (!query('GET_ALLOW_IMAGE_TRANSFORM')) return;\n\n            item.extend('requestPrepare', function() {\n                return new Promise(function(resolve, reject) {\n                    dispatch(\n                        'REQUEST_PREPARE_OUTPUT',\n                        {\n                            query: item.id,\n                            item: item,\n                            success: resolve,\n                            failure: reject,\n                        },\n\n                        true\n                    );\n                });\n            });\n        });\n\n        // subscribe to file transformations\n        addFilter('PREPARE_OUTPUT', function(file, _ref4) {\n            var query = _ref4.query,\n                item = _ref4.item;\n            return new Promise(function(resolve) {\n                shouldTransformFile(query, file, item).then(function(shouldTransform) {\n                    // no need to transform, exit\n                    if (!shouldTransform) return resolve(file);\n\n                    // get variants\n                    var variants = [];\n\n                    // add original file\n                    if (query('GET_IMAGE_TRANSFORM_VARIANTS_INCLUDE_ORIGINAL')) {\n                        variants.push(function() {\n                            return new Promise(function(resolve) {\n                                resolve({\n                                    name: query('GET_IMAGE_TRANSFORM_VARIANTS_ORIGINAL_NAME'),\n                                    file: file,\n                                });\n                            });\n                        });\n                    }\n\n                    // add default output version if output default set to true or if no variants defined\n                    if (query('GET_IMAGE_TRANSFORM_VARIANTS_INCLUDE_DEFAULT')) {\n                        variants.push(function(transform, file, metadata) {\n                            return new Promise(function(resolve) {\n                                transform(file, metadata).then(function(file) {\n                                    return resolve({\n                                        name: query('GET_IMAGE_TRANSFORM_VARIANTS_DEFAULT_NAME'),\n\n                                        file: file,\n                                    });\n                                });\n                            });\n                        });\n                    }\n\n                    // get other variants\n                    var variantsDefinition = query('GET_IMAGE_TRANSFORM_VARIANTS') || {};\n                    forin(variantsDefinition, function(key, fn) {\n                        var createVariant = createVariantCreator(fn);\n                        variants.push(function(transform, file, metadata) {\n                            return new Promise(function(resolve) {\n                                createVariant(transform, file, metadata).then(function(file) {\n                                    return resolve({ name: key, file: file });\n                                });\n                            });\n                        });\n                    });\n\n                    // output format (quality 0 => 100)\n                    var qualityAsPercentage = query('GET_IMAGE_TRANSFORM_OUTPUT_QUALITY');\n                    var qualityMode = query('GET_IMAGE_TRANSFORM_OUTPUT_QUALITY_MODE');\n                    var quality = qualityAsPercentage === null ? null : qualityAsPercentage / 100;\n                    var type = query('GET_IMAGE_TRANSFORM_OUTPUT_MIME_TYPE');\n                    var clientTransforms =\n                        query('GET_IMAGE_TRANSFORM_CLIENT_TRANSFORMS') || TRANSFORM_LIST;\n\n                    // update transform metadata object\n                    item.setMetadata(\n                        'output',\n                        {\n                            type: type,\n                            quality: quality,\n                            client: clientTransforms,\n                        },\n\n                        true\n                    );\n\n                    // the function that is used to apply the file transformations\n                    var transform = function transform(file, metadata) {\n                        return new Promise(function(resolve, reject) {\n                            var filteredMetadata = Object.assign({}, metadata);\n\n                            Object.keys(filteredMetadata)\n                                .filter(function(instruction) {\n                                    return instruction !== 'exif';\n                                })\n                                .forEach(function(instruction) {\n                                    // if not in list, remove from object, the instruction will be handled by the server\n                                    if (clientTransforms.indexOf(instruction) === -1) {\n                                        delete filteredMetadata[instruction];\n                                    }\n                                });\n                            var resize = filteredMetadata.resize,\n                                exif = filteredMetadata.exif,\n                                output = filteredMetadata.output,\n                                crop = filteredMetadata.crop,\n                                filter = filteredMetadata.filter,\n                                markup = filteredMetadata.markup;\n\n                            var instructions = {\n                                image: {\n                                    orientation: exif ? exif.orientation : null,\n                                },\n\n                                output:\n                                    output &&\n                                    (output.type ||\n                                        typeof output.quality === 'number' ||\n                                        output.background)\n                                        ? {\n                                              type: output.type,\n                                              quality:\n                                                  typeof output.quality === 'number'\n                                                      ? output.quality * 100\n                                                      : null,\n                                              background:\n                                                  output.background ||\n                                                  query(\n                                                      'GET_IMAGE_TRANSFORM_CANVAS_BACKGROUND_COLOR'\n                                                  ) ||\n                                                  null,\n                                          }\n                                        : undefined,\n                                size:\n                                    resize && (resize.size.width || resize.size.height)\n                                        ? Object.assign(\n                                              {\n                                                  mode: resize.mode,\n                                                  upscale: resize.upscale,\n                                              },\n                                              resize.size\n                                          )\n                                        : undefined,\n                                crop:\n                                    crop && !isDefaultCrop(crop)\n                                        ? Object.assign(\n                                              {},\n\n                                              crop\n                                          )\n                                        : undefined,\n                                markup: markup && markup.length ? markup.map(prepareMarkup) : [],\n                                filter: filter,\n                            };\n\n                            if (instructions.output) {\n                                // determine if file type will change\n                                var willChangeType = output.type\n                                    ? // type set\n                                      output.type !== file.type\n                                    : // type not set\n                                      false;\n\n                                var canChangeQuality = /\\/jpe?g$/.test(file.type);\n                                var willChangeQuality =\n                                    output.quality !== null\n                                        ? // quality set\n                                          canChangeQuality && qualityMode === 'always'\n                                        : // quality not set\n                                          false;\n\n                                // determine if file data will be modified\n                                var willModifyImageData = !!(\n                                    instructions.size ||\n                                    instructions.crop ||\n                                    instructions.filter ||\n                                    willChangeType ||\n                                    willChangeQuality\n                                );\n\n                                // if we're not modifying the image data then we don't have to modify the output\n                                if (!willModifyImageData) return resolve(file);\n                            }\n\n                            var options = {\n                                beforeCreateBlob: query('GET_IMAGE_TRANSFORM_BEFORE_CREATE_BLOB'),\n                                afterCreateBlob: query('GET_IMAGE_TRANSFORM_AFTER_CREATE_BLOB'),\n                                canvasMemoryLimit: query('GET_IMAGE_TRANSFORM_CANVAS_MEMORY_LIMIT'),\n                                stripImageHead: query(\n                                    'GET_IMAGE_TRANSFORM_OUTPUT_STRIP_IMAGE_HEAD'\n                                ),\n                            };\n\n                            transformImage(file, instructions, options)\n                                .then(function(blob) {\n                                    // set file object\n                                    var out = getFileFromBlob(\n                                        blob,\n                                        // rename the original filename to match the mime type of the output image\n                                        renameFileToMatchMimeType(\n                                            file.name,\n                                            getValidOutputMimeType(blob.type)\n                                        )\n                                    );\n\n                                    resolve(out);\n                                })\n                                .catch(reject);\n                        });\n                    };\n\n                    // start creating variants\n                    var variantPromises = variants.map(function(create) {\n                        return create(transform, file, item.getMetadata());\n                    });\n\n                    // wait for results\n                    Promise.all(variantPromises).then(function(files) {\n                        // if single file object in array, return the single file object else, return array of\n                        resolve(\n                            files.length === 1 && files[0].name === null\n                                ? // return the File object\n                                  files[0].file\n                                : // return an array of files { name:'name', file:File }\n                                  files\n                        );\n                    });\n                });\n            });\n        });\n\n        // Expose plugin options\n        return {\n            options: {\n                allowImageTransform: [true, Type.BOOLEAN],\n\n                // filter images to transform\n                imageTransformImageFilter: [null, Type.FUNCTION],\n\n                // null, 'image/jpeg', 'image/png'\n                imageTransformOutputMimeType: [null, Type.STRING],\n\n                // null, 0 - 100\n                imageTransformOutputQuality: [null, Type.INT],\n\n                // set to false to copy image exif data to output\n                imageTransformOutputStripImageHead: [true, Type.BOOLEAN],\n\n                // only apply transforms in this list\n                imageTransformClientTransforms: [null, Type.ARRAY],\n\n                // only apply output quality when a transform is required\n                imageTransformOutputQualityMode: ['always', Type.STRING],\n                // 'always'\n                // 'optional'\n                // 'mismatch' (future feature, only applied if quality differs from input)\n\n                // get image transform variants\n                imageTransformVariants: [null, Type.OBJECT],\n\n                // should we post the default transformed file\n                imageTransformVariantsIncludeDefault: [true, Type.BOOLEAN],\n\n                // which name to prefix the default transformed file with\n                imageTransformVariantsDefaultName: [null, Type.STRING],\n\n                // should we post the original file\n                imageTransformVariantsIncludeOriginal: [false, Type.BOOLEAN],\n\n                // which name to prefix the original file with\n                imageTransformVariantsOriginalName: ['original_', Type.STRING],\n\n                // called before creating the blob, receives canvas, expects promise resolve with canvas\n                imageTransformBeforeCreateBlob: [null, Type.FUNCTION],\n\n                // expects promise resolved with blob\n                imageTransformAfterCreateBlob: [null, Type.FUNCTION],\n\n                // canvas memory limit\n                imageTransformCanvasMemoryLimit: [\n                    isBrowser && isIOS ? 4096 * 4096 : null,\n                    Type.INT,\n                ],\n\n                // background image of the output canvas\n                imageTransformCanvasBackgroundColor: [null, Type.STRING],\n            },\n        };\n    };\n\n    // fire pluginloaded event if running in browser, this allows registering the plugin when using async script tags\n    if (isBrowser) {\n        document.dispatchEvent(new CustomEvent('FilePond:pluginloaded', { detail: plugin }));\n    }\n\n    return plugin;\n});\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}