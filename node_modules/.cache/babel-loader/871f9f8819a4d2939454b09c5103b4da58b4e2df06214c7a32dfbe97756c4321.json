{"ast":null,"code":"/*!\n * FilePondPluginImagePreview 4.6.11\n * Licensed under MIT, https://opensource.org/licenses/MIT/\n * Please visit https://pqina.nl/filepond/ for details.\n */\n\n/* eslint-disable */\n\n(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() : typeof define === 'function' && define.amd ? define(factory) : (global = global || self, global.FilePondPluginImagePreview = factory());\n})(this, function () {\n  'use strict';\n\n  // test if file is of type image and can be viewed in canvas\n  var isPreviewableImage = function isPreviewableImage(file) {\n    return /^image/.test(file.type);\n  };\n  function _typeof(obj) {\n    if (typeof Symbol === 'function' && typeof Symbol.iterator === 'symbol') {\n      _typeof = function (obj) {\n        return typeof obj;\n      };\n    } else {\n      _typeof = function (obj) {\n        return obj && typeof Symbol === 'function' && obj.constructor === Symbol && obj !== Symbol.prototype ? 'symbol' : typeof obj;\n      };\n    }\n    return _typeof(obj);\n  }\n  var REACT_ELEMENT_TYPE;\n  function _jsx(type, props, key, children) {\n    if (!REACT_ELEMENT_TYPE) {\n      REACT_ELEMENT_TYPE = typeof Symbol === 'function' && Symbol.for && Symbol.for('react.element') || 0xeac7;\n    }\n    var defaultProps = type && type.defaultProps;\n    var childrenLength = arguments.length - 3;\n    if (!props && childrenLength !== 0) {\n      props = {\n        children: void 0\n      };\n    }\n    if (props && defaultProps) {\n      for (var propName in defaultProps) {\n        if (props[propName] === void 0) {\n          props[propName] = defaultProps[propName];\n        }\n      }\n    } else if (!props) {\n      props = defaultProps || {};\n    }\n    if (childrenLength === 1) {\n      props.children = children;\n    } else if (childrenLength > 1) {\n      var childArray = new Array(childrenLength);\n      for (var i = 0; i < childrenLength; i++) {\n        childArray[i] = arguments[i + 3];\n      }\n      props.children = childArray;\n    }\n    return {\n      $$typeof: REACT_ELEMENT_TYPE,\n      type: type,\n      key: key === undefined ? null : '' + key,\n      ref: null,\n      props: props,\n      _owner: null\n    };\n  }\n  function _asyncIterator(iterable) {\n    var method;\n    if (typeof Symbol === 'function') {\n      if (Symbol.asyncIterator) {\n        method = iterable[Symbol.asyncIterator];\n        if (method != null) return method.call(iterable);\n      }\n      if (Symbol.iterator) {\n        method = iterable[Symbol.iterator];\n        if (method != null) return method.call(iterable);\n      }\n    }\n    throw new TypeError('Object is not async iterable');\n  }\n  function _AwaitValue(value) {\n    this.wrapped = value;\n  }\n  function _AsyncGenerator(gen) {\n    var front, back;\n    function send(key, arg) {\n      return new Promise(function (resolve, reject) {\n        var request = {\n          key: key,\n          arg: arg,\n          resolve: resolve,\n          reject: reject,\n          next: null\n        };\n        if (back) {\n          back = back.next = request;\n        } else {\n          front = back = request;\n          resume(key, arg);\n        }\n      });\n    }\n    function resume(key, arg) {\n      try {\n        var result = gen[key](arg);\n        var value = result.value;\n        var wrappedAwait = value instanceof _AwaitValue;\n        Promise.resolve(wrappedAwait ? value.wrapped : value).then(function (arg) {\n          if (wrappedAwait) {\n            resume('next', arg);\n            return;\n          }\n          settle(result.done ? 'return' : 'normal', arg);\n        }, function (err) {\n          resume('throw', err);\n        });\n      } catch (err) {\n        settle('throw', err);\n      }\n    }\n    function settle(type, value) {\n      switch (type) {\n        case 'return':\n          front.resolve({\n            value: value,\n            done: true\n          });\n          break;\n        case 'throw':\n          front.reject(value);\n          break;\n        default:\n          front.resolve({\n            value: value,\n            done: false\n          });\n          break;\n      }\n      front = front.next;\n      if (front) {\n        resume(front.key, front.arg);\n      } else {\n        back = null;\n      }\n    }\n    this._invoke = send;\n    if (typeof gen.return !== 'function') {\n      this.return = undefined;\n    }\n  }\n  if (typeof Symbol === 'function' && Symbol.asyncIterator) {\n    _AsyncGenerator.prototype[Symbol.asyncIterator] = function () {\n      return this;\n    };\n  }\n  _AsyncGenerator.prototype.next = function (arg) {\n    return this._invoke('next', arg);\n  };\n  _AsyncGenerator.prototype.throw = function (arg) {\n    return this._invoke('throw', arg);\n  };\n  _AsyncGenerator.prototype.return = function (arg) {\n    return this._invoke('return', arg);\n  };\n  function _wrapAsyncGenerator(fn) {\n    return function () {\n      return new _AsyncGenerator(fn.apply(this, arguments));\n    };\n  }\n  function _awaitAsyncGenerator(value) {\n    return new _AwaitValue(value);\n  }\n  function _asyncGeneratorDelegate(inner, awaitWrap) {\n    var iter = {},\n      waiting = false;\n    function pump(key, value) {\n      waiting = true;\n      value = new Promise(function (resolve) {\n        resolve(inner[key](value));\n      });\n      return {\n        done: false,\n        value: awaitWrap(value)\n      };\n    }\n    if (typeof Symbol === 'function' && Symbol.iterator) {\n      iter[Symbol.iterator] = function () {\n        return this;\n      };\n    }\n    iter.next = function (value) {\n      if (waiting) {\n        waiting = false;\n        return value;\n      }\n      return pump('next', value);\n    };\n    if (typeof inner.throw === 'function') {\n      iter.throw = function (value) {\n        if (waiting) {\n          waiting = false;\n          throw value;\n        }\n        return pump('throw', value);\n      };\n    }\n    if (typeof inner.return === 'function') {\n      iter.return = function (value) {\n        return pump('return', value);\n      };\n    }\n    return iter;\n  }\n  function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n    try {\n      var info = gen[key](arg);\n      var value = info.value;\n    } catch (error) {\n      reject(error);\n      return;\n    }\n    if (info.done) {\n      resolve(value);\n    } else {\n      Promise.resolve(value).then(_next, _throw);\n    }\n  }\n  function _asyncToGenerator(fn) {\n    return function () {\n      var self = this,\n        args = arguments;\n      return new Promise(function (resolve, reject) {\n        var gen = fn.apply(self, args);\n        function _next(value) {\n          asyncGeneratorStep(gen, resolve, reject, _next, _throw, 'next', value);\n        }\n        function _throw(err) {\n          asyncGeneratorStep(gen, resolve, reject, _next, _throw, 'throw', err);\n        }\n        _next(undefined);\n      });\n    };\n  }\n  function _classCallCheck(instance, Constructor) {\n    if (!(instance instanceof Constructor)) {\n      throw new TypeError('Cannot call a class as a function');\n    }\n  }\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if ('value' in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n  function _createClass(Constructor, protoProps, staticProps) {\n    if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) _defineProperties(Constructor, staticProps);\n    return Constructor;\n  }\n  function _defineEnumerableProperties(obj, descs) {\n    for (var key in descs) {\n      var desc = descs[key];\n      desc.configurable = desc.enumerable = true;\n      if ('value' in desc) desc.writable = true;\n      Object.defineProperty(obj, key, desc);\n    }\n    if (Object.getOwnPropertySymbols) {\n      var objectSymbols = Object.getOwnPropertySymbols(descs);\n      for (var i = 0; i < objectSymbols.length; i++) {\n        var sym = objectSymbols[i];\n        var desc = descs[sym];\n        desc.configurable = desc.enumerable = true;\n        if ('value' in desc) desc.writable = true;\n        Object.defineProperty(obj, sym, desc);\n      }\n    }\n    return obj;\n  }\n  function _defaults(obj, defaults) {\n    var keys = Object.getOwnPropertyNames(defaults);\n    for (var i = 0; i < keys.length; i++) {\n      var key = keys[i];\n      var value = Object.getOwnPropertyDescriptor(defaults, key);\n      if (value && value.configurable && obj[key] === undefined) {\n        Object.defineProperty(obj, key, value);\n      }\n    }\n    return obj;\n  }\n  function _defineProperty(obj, key, value) {\n    if (key in obj) {\n      Object.defineProperty(obj, key, {\n        value: value,\n        enumerable: true,\n        configurable: true,\n        writable: true\n      });\n    } else {\n      obj[key] = value;\n    }\n    return obj;\n  }\n  function _extends() {\n    _extends = Object.assign || function (target) {\n      for (var i = 1; i < arguments.length; i++) {\n        var source = arguments[i];\n        for (var key in source) {\n          if (Object.prototype.hasOwnProperty.call(source, key)) {\n            target[key] = source[key];\n          }\n        }\n      }\n      return target;\n    };\n    return _extends.apply(this, arguments);\n  }\n  function _objectSpread(target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i] != null ? arguments[i] : {};\n      var ownKeys = Object.keys(source);\n      if (typeof Object.getOwnPropertySymbols === 'function') {\n        ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) {\n          return Object.getOwnPropertyDescriptor(source, sym).enumerable;\n        }));\n      }\n      ownKeys.forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    }\n    return target;\n  }\n  function _inherits(subClass, superClass) {\n    if (typeof superClass !== 'function' && superClass !== null) {\n      throw new TypeError('Super expression must either be null or a function');\n    }\n    subClass.prototype = Object.create(superClass && superClass.prototype, {\n      constructor: {\n        value: subClass,\n        writable: true,\n        configurable: true\n      }\n    });\n    if (superClass) _setPrototypeOf(subClass, superClass);\n  }\n  function _inheritsLoose(subClass, superClass) {\n    subClass.prototype = Object.create(superClass.prototype);\n    subClass.prototype.constructor = subClass;\n    subClass.__proto__ = superClass;\n  }\n  function _getPrototypeOf(o) {\n    _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n      return o.__proto__ || Object.getPrototypeOf(o);\n    };\n    return _getPrototypeOf(o);\n  }\n  function _setPrototypeOf(o, p) {\n    _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n      o.__proto__ = p;\n      return o;\n    };\n    return _setPrototypeOf(o, p);\n  }\n  function isNativeReflectConstruct() {\n    if (typeof Reflect === 'undefined' || !Reflect.construct) return false;\n    if (Reflect.construct.sham) return false;\n    if (typeof Proxy === 'function') return true;\n    try {\n      Date.prototype.toString.call(Reflect.construct(Date, [], function () {}));\n      return true;\n    } catch (e) {\n      return false;\n    }\n  }\n  function _construct(Parent, args, Class) {\n    if (isNativeReflectConstruct()) {\n      _construct = Reflect.construct;\n    } else {\n      _construct = function _construct(Parent, args, Class) {\n        var a = [null];\n        a.push.apply(a, args);\n        var Constructor = Function.bind.apply(Parent, a);\n        var instance = new Constructor();\n        if (Class) _setPrototypeOf(instance, Class.prototype);\n        return instance;\n      };\n    }\n    return _construct.apply(null, arguments);\n  }\n  function _isNativeFunction(fn) {\n    return Function.toString.call(fn).indexOf('[native code]') !== -1;\n  }\n  function _wrapNativeSuper(Class) {\n    var _cache = typeof Map === 'function' ? new Map() : undefined;\n    _wrapNativeSuper = function _wrapNativeSuper(Class) {\n      if (Class === null || !_isNativeFunction(Class)) return Class;\n      if (typeof Class !== 'function') {\n        throw new TypeError('Super expression must either be null or a function');\n      }\n      if (typeof _cache !== 'undefined') {\n        if (_cache.has(Class)) return _cache.get(Class);\n        _cache.set(Class, Wrapper);\n      }\n      function Wrapper() {\n        return _construct(Class, arguments, _getPrototypeOf(this).constructor);\n      }\n      Wrapper.prototype = Object.create(Class.prototype, {\n        constructor: {\n          value: Wrapper,\n          enumerable: false,\n          writable: true,\n          configurable: true\n        }\n      });\n      return _setPrototypeOf(Wrapper, Class);\n    };\n    return _wrapNativeSuper(Class);\n  }\n  function _instanceof(left, right) {\n    if (right != null && typeof Symbol !== 'undefined' && right[Symbol.hasInstance]) {\n      return right[Symbol.hasInstance](left);\n    } else {\n      return left instanceof right;\n    }\n  }\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  }\n  function _interopRequireWildcard(obj) {\n    if (obj && obj.__esModule) {\n      return obj;\n    } else {\n      var newObj = {};\n      if (obj != null) {\n        for (var key in obj) {\n          if (Object.prototype.hasOwnProperty.call(obj, key)) {\n            var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {};\n            if (desc.get || desc.set) {\n              Object.defineProperty(newObj, key, desc);\n            } else {\n              newObj[key] = obj[key];\n            }\n          }\n        }\n      }\n      newObj.default = obj;\n      return newObj;\n    }\n  }\n  function _newArrowCheck(innerThis, boundThis) {\n    if (innerThis !== boundThis) {\n      throw new TypeError('Cannot instantiate an arrow function');\n    }\n  }\n  function _objectDestructuringEmpty(obj) {\n    if (obj == null) throw new TypeError('Cannot destructure undefined');\n  }\n  function _objectWithoutPropertiesLoose(source, excluded) {\n    if (source == null) return {};\n    var target = {};\n    var sourceKeys = Object.keys(source);\n    var key, i;\n    for (i = 0; i < sourceKeys.length; i++) {\n      key = sourceKeys[i];\n      if (excluded.indexOf(key) >= 0) continue;\n      target[key] = source[key];\n    }\n    return target;\n  }\n  function _objectWithoutProperties(source, excluded) {\n    if (source == null) return {};\n    var target = _objectWithoutPropertiesLoose(source, excluded);\n    var key, i;\n    if (Object.getOwnPropertySymbols) {\n      var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n      for (i = 0; i < sourceSymbolKeys.length; i++) {\n        key = sourceSymbolKeys[i];\n        if (excluded.indexOf(key) >= 0) continue;\n        if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n        target[key] = source[key];\n      }\n    }\n    return target;\n  }\n  function _assertThisInitialized(self) {\n    if (self === void 0) {\n      throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n    }\n    return self;\n  }\n  function _possibleConstructorReturn(self, call) {\n    if (call && (typeof call === 'object' || typeof call === 'function')) {\n      return call;\n    }\n    return _assertThisInitialized(self);\n  }\n  function _superPropBase(object, property) {\n    while (!Object.prototype.hasOwnProperty.call(object, property)) {\n      object = _getPrototypeOf(object);\n      if (object === null) break;\n    }\n    return object;\n  }\n  function _get(target, property, receiver) {\n    if (typeof Reflect !== 'undefined' && Reflect.get) {\n      _get = Reflect.get;\n    } else {\n      _get = function _get(target, property, receiver) {\n        var base = _superPropBase(target, property);\n        if (!base) return;\n        var desc = Object.getOwnPropertyDescriptor(base, property);\n        if (desc.get) {\n          return desc.get.call(receiver);\n        }\n        return desc.value;\n      };\n    }\n    return _get(target, property, receiver || target);\n  }\n  function set(target, property, value, receiver) {\n    if (typeof Reflect !== 'undefined' && Reflect.set) {\n      set = Reflect.set;\n    } else {\n      set = function set(target, property, value, receiver) {\n        var base = _superPropBase(target, property);\n        var desc;\n        if (base) {\n          desc = Object.getOwnPropertyDescriptor(base, property);\n          if (desc.set) {\n            desc.set.call(receiver, value);\n            return true;\n          } else if (!desc.writable) {\n            return false;\n          }\n        }\n        desc = Object.getOwnPropertyDescriptor(receiver, property);\n        if (desc) {\n          if (!desc.writable) {\n            return false;\n          }\n          desc.value = value;\n          Object.defineProperty(receiver, property, desc);\n        } else {\n          _defineProperty(receiver, property, value);\n        }\n        return true;\n      };\n    }\n    return set(target, property, value, receiver);\n  }\n  function _set(target, property, value, receiver, isStrict) {\n    var s = set(target, property, value, receiver || target);\n    if (!s && isStrict) {\n      throw new Error('failed to set property');\n    }\n    return value;\n  }\n  function _taggedTemplateLiteral(strings, raw) {\n    if (!raw) {\n      raw = strings.slice(0);\n    }\n    return Object.freeze(Object.defineProperties(strings, {\n      raw: {\n        value: Object.freeze(raw)\n      }\n    }));\n  }\n  function _taggedTemplateLiteralLoose(strings, raw) {\n    if (!raw) {\n      raw = strings.slice(0);\n    }\n    strings.raw = raw;\n    return strings;\n  }\n  function _temporalRef(val, name) {\n    if (val === _temporalUndefined) {\n      throw new ReferenceError(name + ' is not defined - temporal dead zone');\n    } else {\n      return val;\n    }\n  }\n  function _readOnlyError(name) {\n    throw new Error('\"' + name + '\" is read-only');\n  }\n  function _classNameTDZError(name) {\n    throw new Error('Class \"' + name + '\" cannot be referenced in computed property keys.');\n  }\n  var _temporalUndefined = {};\n  function _slicedToArray(arr, i) {\n    return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _nonIterableRest();\n  }\n  function _slicedToArrayLoose(arr, i) {\n    return _arrayWithHoles(arr) || _iterableToArrayLimitLoose(arr, i) || _nonIterableRest();\n  }\n  function _toArray(arr) {\n    return _arrayWithHoles(arr) || _iterableToArray(arr) || _nonIterableRest();\n  }\n  function _toConsumableArray(arr) {\n    return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread();\n  }\n  function _arrayWithoutHoles(arr) {\n    if (Array.isArray(arr)) {\n      for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) arr2[i] = arr[i];\n      return arr2;\n    }\n  }\n  function _arrayWithHoles(arr) {\n    if (Array.isArray(arr)) return arr;\n  }\n  function _iterableToArray(iter) {\n    if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === '[object Arguments]') return Array.from(iter);\n  }\n  function _iterableToArrayLimit(arr, i) {\n    var _arr = [];\n    var _n = true;\n    var _d = false;\n    var _e = undefined;\n    try {\n      for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n        _arr.push(_s.value);\n        if (i && _arr.length === i) break;\n      }\n    } catch (err) {\n      _d = true;\n      _e = err;\n    } finally {\n      try {\n        if (!_n && _i['return'] != null) _i['return']();\n      } finally {\n        if (_d) throw _e;\n      }\n    }\n    return _arr;\n  }\n  function _iterableToArrayLimitLoose(arr, i) {\n    var _arr = [];\n    for (var _iterator = arr[Symbol.iterator](), _step; !(_step = _iterator.next()).done;) {\n      _arr.push(_step.value);\n      if (i && _arr.length === i) break;\n    }\n    return _arr;\n  }\n  function _nonIterableSpread() {\n    throw new TypeError('Invalid attempt to spread non-iterable instance');\n  }\n  function _nonIterableRest() {\n    throw new TypeError('Invalid attempt to destructure non-iterable instance');\n  }\n  function _skipFirstGeneratorNext(fn) {\n    return function () {\n      var it = fn.apply(this, arguments);\n      it.next();\n      return it;\n    };\n  }\n  function _toPrimitive(input, hint) {\n    if (typeof input !== 'object' || input === null) return input;\n    var prim = input[Symbol.toPrimitive];\n    if (prim !== undefined) {\n      var res = prim.call(input, hint || 'default');\n      if (typeof res !== 'object') return res;\n      throw new TypeError('@@toPrimitive must return a primitive value.');\n    }\n    return (hint === 'string' ? String : Number)(input);\n  }\n  function _toPropertyKey(arg) {\n    var key = _toPrimitive(arg, 'string');\n    return typeof key === 'symbol' ? key : String(key);\n  }\n  function _initializerWarningHelper(descriptor, context) {\n    throw new Error('Decorating class property failed. Please ensure that ' + 'proposal-class-properties is enabled and set to use loose mode. ' + 'To use proposal-class-properties in spec mode with decorators, wait for ' + 'the next major version of decorators in stage 2.');\n  }\n  function _initializerDefineProperty(target, property, descriptor, context) {\n    if (!descriptor) return;\n    Object.defineProperty(target, property, {\n      enumerable: descriptor.enumerable,\n      configurable: descriptor.configurable,\n      writable: descriptor.writable,\n      value: descriptor.initializer ? descriptor.initializer.call(context) : void 0\n    });\n  }\n  function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) {\n    var desc = {};\n    Object.keys(descriptor).forEach(function (key) {\n      desc[key] = descriptor[key];\n    });\n    desc.enumerable = !!desc.enumerable;\n    desc.configurable = !!desc.configurable;\n    if ('value' in desc || desc.initializer) {\n      desc.writable = true;\n    }\n    desc = decorators.slice().reverse().reduce(function (desc, decorator) {\n      return decorator(target, property, desc) || desc;\n    }, desc);\n    if (context && desc.initializer !== void 0) {\n      desc.value = desc.initializer ? desc.initializer.call(context) : void 0;\n      desc.initializer = undefined;\n    }\n    if (desc.initializer === void 0) {\n      Object.defineProperty(target, property, desc);\n      desc = null;\n    }\n    return desc;\n  }\n  var id = 0;\n  function _classPrivateFieldLooseKey(name) {\n    return '__private_' + id++ + '_' + name;\n  }\n  function _classPrivateFieldLooseBase(receiver, privateKey) {\n    if (!Object.prototype.hasOwnProperty.call(receiver, privateKey)) {\n      throw new TypeError('attempted to use private field on non-instance');\n    }\n    return receiver;\n  }\n  function _classPrivateFieldGet(receiver, privateMap) {\n    if (!privateMap.has(receiver)) {\n      throw new TypeError('attempted to get private field on non-instance');\n    }\n    var descriptor = privateMap.get(receiver);\n    if (descriptor.get) {\n      return descriptor.get.call(receiver);\n    }\n    return descriptor.value;\n  }\n  function _classPrivateFieldSet(receiver, privateMap, value) {\n    if (!privateMap.has(receiver)) {\n      throw new TypeError('attempted to set private field on non-instance');\n    }\n    var descriptor = privateMap.get(receiver);\n    if (descriptor.set) {\n      descriptor.set.call(receiver, value);\n    } else {\n      if (!descriptor.writable) {\n        throw new TypeError('attempted to set read only private field');\n      }\n      descriptor.value = value;\n    }\n    return value;\n  }\n  function _classStaticPrivateFieldSpecGet(receiver, classConstructor, descriptor) {\n    if (receiver !== classConstructor) {\n      throw new TypeError('Private static access of wrong provenance');\n    }\n    return descriptor.value;\n  }\n  function _classStaticPrivateFieldSpecSet(receiver, classConstructor, descriptor, value) {\n    if (receiver !== classConstructor) {\n      throw new TypeError('Private static access of wrong provenance');\n    }\n    if (!descriptor.writable) {\n      throw new TypeError('attempted to set read only private field');\n    }\n    descriptor.value = value;\n    return value;\n  }\n  function _classStaticPrivateMethodGet(receiver, classConstructor, method) {\n    if (receiver !== classConstructor) {\n      throw new TypeError('Private static access of wrong provenance');\n    }\n    return method;\n  }\n  function _classStaticPrivateMethodSet() {\n    throw new TypeError('attempted to set read only static private field');\n  }\n  function _decorate(decorators, factory, superClass, mixins) {\n    var api = _getDecoratorsApi();\n    if (mixins) {\n      for (var i = 0; i < mixins.length; i++) {\n        api = mixins[i](api);\n      }\n    }\n    var r = factory(function initialize(O) {\n      api.initializeInstanceElements(O, decorated.elements);\n    }, superClass);\n    var decorated = api.decorateClass(_coalesceClassElements(r.d.map(_createElementDescriptor)), decorators);\n    api.initializeClassElements(r.F, decorated.elements);\n    return api.runClassFinishers(r.F, decorated.finishers);\n  }\n  function _getDecoratorsApi() {\n    _getDecoratorsApi = function () {\n      return api;\n    };\n    var api = {\n      elementsDefinitionOrder: [['method'], ['field']],\n      initializeInstanceElements: function (O, elements) {\n        ['method', 'field'].forEach(function (kind) {\n          elements.forEach(function (element) {\n            if (element.kind === kind && element.placement === 'own') {\n              this.defineClassElement(O, element);\n            }\n          }, this);\n        }, this);\n      },\n      initializeClassElements: function (F, elements) {\n        var proto = F.prototype;\n        ['method', 'field'].forEach(function (kind) {\n          elements.forEach(function (element) {\n            var placement = element.placement;\n            if (element.kind === kind && (placement === 'static' || placement === 'prototype')) {\n              var receiver = placement === 'static' ? F : proto;\n              this.defineClassElement(receiver, element);\n            }\n          }, this);\n        }, this);\n      },\n      defineClassElement: function (receiver, element) {\n        var descriptor = element.descriptor;\n        if (element.kind === 'field') {\n          var initializer = element.initializer;\n          descriptor = {\n            enumerable: descriptor.enumerable,\n            writable: descriptor.writable,\n            configurable: descriptor.configurable,\n            value: initializer === void 0 ? void 0 : initializer.call(receiver)\n          };\n        }\n        Object.defineProperty(receiver, element.key, descriptor);\n      },\n      decorateClass: function (elements, decorators) {\n        var newElements = [];\n        var finishers = [];\n        var placements = {\n          static: [],\n          prototype: [],\n          own: []\n        };\n        elements.forEach(function (element) {\n          this.addElementPlacement(element, placements);\n        }, this);\n        elements.forEach(function (element) {\n          if (!_hasDecorators(element)) return newElements.push(element);\n          var elementFinishersExtras = this.decorateElement(element, placements);\n          newElements.push(elementFinishersExtras.element);\n          newElements.push.apply(newElements, elementFinishersExtras.extras);\n          finishers.push.apply(finishers, elementFinishersExtras.finishers);\n        }, this);\n        if (!decorators) {\n          return {\n            elements: newElements,\n            finishers: finishers\n          };\n        }\n        var result = this.decorateConstructor(newElements, decorators);\n        finishers.push.apply(finishers, result.finishers);\n        result.finishers = finishers;\n        return result;\n      },\n      addElementPlacement: function (element, placements, silent) {\n        var keys = placements[element.placement];\n        if (!silent && keys.indexOf(element.key) !== -1) {\n          throw new TypeError('Duplicated element (' + element.key + ')');\n        }\n        keys.push(element.key);\n      },\n      decorateElement: function (element, placements) {\n        var extras = [];\n        var finishers = [];\n        for (var decorators = element.decorators, i = decorators.length - 1; i >= 0; i--) {\n          var keys = placements[element.placement];\n          keys.splice(keys.indexOf(element.key), 1);\n          var elementObject = this.fromElementDescriptor(element);\n          var elementFinisherExtras = this.toElementFinisherExtras((0, decorators[i])(elementObject) || elementObject);\n          element = elementFinisherExtras.element;\n          this.addElementPlacement(element, placements);\n          if (elementFinisherExtras.finisher) {\n            finishers.push(elementFinisherExtras.finisher);\n          }\n          var newExtras = elementFinisherExtras.extras;\n          if (newExtras) {\n            for (var j = 0; j < newExtras.length; j++) {\n              this.addElementPlacement(newExtras[j], placements);\n            }\n            extras.push.apply(extras, newExtras);\n          }\n        }\n        return {\n          element: element,\n          finishers: finishers,\n          extras: extras\n        };\n      },\n      decorateConstructor: function (elements, decorators) {\n        var finishers = [];\n        for (var i = decorators.length - 1; i >= 0; i--) {\n          var obj = this.fromClassDescriptor(elements);\n          var elementsAndFinisher = this.toClassDescriptor((0, decorators[i])(obj) || obj);\n          if (elementsAndFinisher.finisher !== undefined) {\n            finishers.push(elementsAndFinisher.finisher);\n          }\n          if (elementsAndFinisher.elements !== undefined) {\n            elements = elementsAndFinisher.elements;\n            for (var j = 0; j < elements.length - 1; j++) {\n              for (var k = j + 1; k < elements.length; k++) {\n                if (elements[j].key === elements[k].key && elements[j].placement === elements[k].placement) {\n                  throw new TypeError('Duplicated element (' + elements[j].key + ')');\n                }\n              }\n            }\n          }\n        }\n        return {\n          elements: elements,\n          finishers: finishers\n        };\n      },\n      fromElementDescriptor: function (element) {\n        var obj = {\n          kind: element.kind,\n          key: element.key,\n          placement: element.placement,\n          descriptor: element.descriptor\n        };\n        var desc = {\n          value: 'Descriptor',\n          configurable: true\n        };\n        Object.defineProperty(obj, Symbol.toStringTag, desc);\n        if (element.kind === 'field') obj.initializer = element.initializer;\n        return obj;\n      },\n      toElementDescriptors: function (elementObjects) {\n        if (elementObjects === undefined) return;\n        return _toArray(elementObjects).map(function (elementObject) {\n          var element = this.toElementDescriptor(elementObject);\n          this.disallowProperty(elementObject, 'finisher', 'An element descriptor');\n          this.disallowProperty(elementObject, 'extras', 'An element descriptor');\n          return element;\n        }, this);\n      },\n      toElementDescriptor: function (elementObject) {\n        var kind = String(elementObject.kind);\n        if (kind !== 'method' && kind !== 'field') {\n          throw new TypeError('An element descriptor\\'s .kind property must be either \"method\" or' + ' \"field\", but a decorator created an element descriptor with' + ' .kind \"' + kind + '\"');\n        }\n        var key = _toPropertyKey(elementObject.key);\n        var placement = String(elementObject.placement);\n        if (placement !== 'static' && placement !== 'prototype' && placement !== 'own') {\n          throw new TypeError('An element descriptor\\'s .placement property must be one of \"static\",' + ' \"prototype\" or \"own\", but a decorator created an element descriptor' + ' with .placement \"' + placement + '\"');\n        }\n        var descriptor = elementObject.descriptor;\n        this.disallowProperty(elementObject, 'elements', 'An element descriptor');\n        var element = {\n          kind: kind,\n          key: key,\n          placement: placement,\n          descriptor: Object.assign({}, descriptor)\n        };\n        if (kind !== 'field') {\n          this.disallowProperty(elementObject, 'initializer', 'A method descriptor');\n        } else {\n          this.disallowProperty(descriptor, 'get', 'The property descriptor of a field descriptor');\n          this.disallowProperty(descriptor, 'set', 'The property descriptor of a field descriptor');\n          this.disallowProperty(descriptor, 'value', 'The property descriptor of a field descriptor');\n          element.initializer = elementObject.initializer;\n        }\n        return element;\n      },\n      toElementFinisherExtras: function (elementObject) {\n        var element = this.toElementDescriptor(elementObject);\n        var finisher = _optionalCallableProperty(elementObject, 'finisher');\n        var extras = this.toElementDescriptors(elementObject.extras);\n        return {\n          element: element,\n          finisher: finisher,\n          extras: extras\n        };\n      },\n      fromClassDescriptor: function (elements) {\n        var obj = {\n          kind: 'class',\n          elements: elements.map(this.fromElementDescriptor, this)\n        };\n        var desc = {\n          value: 'Descriptor',\n          configurable: true\n        };\n        Object.defineProperty(obj, Symbol.toStringTag, desc);\n        return obj;\n      },\n      toClassDescriptor: function (obj) {\n        var kind = String(obj.kind);\n        if (kind !== 'class') {\n          throw new TypeError('A class descriptor\\'s .kind property must be \"class\", but a decorator' + ' created a class descriptor with .kind \"' + kind + '\"');\n        }\n        this.disallowProperty(obj, 'key', 'A class descriptor');\n        this.disallowProperty(obj, 'placement', 'A class descriptor');\n        this.disallowProperty(obj, 'descriptor', 'A class descriptor');\n        this.disallowProperty(obj, 'initializer', 'A class descriptor');\n        this.disallowProperty(obj, 'extras', 'A class descriptor');\n        var finisher = _optionalCallableProperty(obj, 'finisher');\n        var elements = this.toElementDescriptors(obj.elements);\n        return {\n          elements: elements,\n          finisher: finisher\n        };\n      },\n      runClassFinishers: function (constructor, finishers) {\n        for (var i = 0; i < finishers.length; i++) {\n          var newConstructor = (0, finishers[i])(constructor);\n          if (newConstructor !== undefined) {\n            if (typeof newConstructor !== 'function') {\n              throw new TypeError('Finishers must return a constructor.');\n            }\n            constructor = newConstructor;\n          }\n        }\n        return constructor;\n      },\n      disallowProperty: function (obj, name, objectType) {\n        if (obj[name] !== undefined) {\n          throw new TypeError(objectType + \" can't have a .\" + name + ' property.');\n        }\n      }\n    };\n    return api;\n  }\n  function _createElementDescriptor(def) {\n    var key = _toPropertyKey(def.key);\n    var descriptor;\n    if (def.kind === 'method') {\n      descriptor = {\n        value: def.value,\n        writable: true,\n        configurable: true,\n        enumerable: false\n      };\n    } else if (def.kind === 'get') {\n      descriptor = {\n        get: def.value,\n        configurable: true,\n        enumerable: false\n      };\n    } else if (def.kind === 'set') {\n      descriptor = {\n        set: def.value,\n        configurable: true,\n        enumerable: false\n      };\n    } else if (def.kind === 'field') {\n      descriptor = {\n        configurable: true,\n        writable: true,\n        enumerable: true\n      };\n    }\n    var element = {\n      kind: def.kind === 'field' ? 'field' : 'method',\n      key: key,\n      placement: def.static ? 'static' : def.kind === 'field' ? 'own' : 'prototype',\n      descriptor: descriptor\n    };\n    if (def.decorators) element.decorators = def.decorators;\n    if (def.kind === 'field') element.initializer = def.value;\n    return element;\n  }\n  function _coalesceGetterSetter(element, other) {\n    if (element.descriptor.get !== undefined) {\n      other.descriptor.get = element.descriptor.get;\n    } else {\n      other.descriptor.set = element.descriptor.set;\n    }\n  }\n  function _coalesceClassElements(elements) {\n    var newElements = [];\n    var isSameElement = function (other) {\n      return other.kind === 'method' && other.key === element.key && other.placement === element.placement;\n    };\n    for (var i = 0; i < elements.length; i++) {\n      var element = elements[i];\n      var other;\n      if (element.kind === 'method' && (other = newElements.find(isSameElement))) {\n        if (_isDataDescriptor(element.descriptor) || _isDataDescriptor(other.descriptor)) {\n          if (_hasDecorators(element) || _hasDecorators(other)) {\n            throw new ReferenceError('Duplicated methods (' + element.key + \") can't be decorated.\");\n          }\n          other.descriptor = element.descriptor;\n        } else {\n          if (_hasDecorators(element)) {\n            if (_hasDecorators(other)) {\n              throw new ReferenceError(\"Decorators can't be placed on different accessors with for \" + 'the same property (' + element.key + ').');\n            }\n            other.decorators = element.decorators;\n          }\n          _coalesceGetterSetter(element, other);\n        }\n      } else {\n        newElements.push(element);\n      }\n    }\n    return newElements;\n  }\n  function _hasDecorators(element) {\n    return element.decorators && element.decorators.length;\n  }\n  function _isDataDescriptor(desc) {\n    return desc !== undefined && !(desc.value === undefined && desc.writable === undefined);\n  }\n  function _optionalCallableProperty(obj, name) {\n    var value = obj[name];\n    if (value !== undefined && typeof value !== 'function') {\n      throw new TypeError(\"Expected '\" + name + \"' to be a function\");\n    }\n    return value;\n  }\n  function _classPrivateMethodGet(receiver, privateSet, fn) {\n    if (!privateSet.has(receiver)) {\n      throw new TypeError('attempted to get private field on non-instance');\n    }\n    return fn;\n  }\n  function _classPrivateMethodSet() {\n    throw new TypeError('attempted to reassign private method');\n  }\n  function _wrapRegExp(re, groups) {\n    _wrapRegExp = function (re, groups) {\n      return new BabelRegExp(re, groups);\n    };\n    var _RegExp = _wrapNativeSuper(RegExp);\n    var _super = RegExp.prototype;\n    var _groups = new WeakMap();\n    function BabelRegExp(re, groups) {\n      var _this = _RegExp.call(this, re);\n      _groups.set(_this, groups);\n      return _this;\n    }\n    _inherits(BabelRegExp, _RegExp);\n    BabelRegExp.prototype.exec = function (str) {\n      var result = _super.exec.call(this, str);\n      if (result) result.groups = buildGroups(result, this);\n      return result;\n    };\n    BabelRegExp.prototype[Symbol.replace] = function (str, substitution) {\n      if (typeof substitution === 'string') {\n        var groups = _groups.get(this);\n        return _super[Symbol.replace].call(this, str, substitution.replace(/\\$<([^>]+)>/g, function (_, name) {\n          return '$' + groups[name];\n        }));\n      } else if (typeof substitution === 'function') {\n        var _this = this;\n        return _super[Symbol.replace].call(this, str, function () {\n          var args = [];\n          args.push.apply(args, arguments);\n          if (typeof args[args.length - 1] !== 'object') {\n            args.push(buildGroups(args, _this));\n          }\n          return substitution.apply(this, args);\n        });\n      } else {\n        return _super[Symbol.replace].call(this, str, substitution);\n      }\n    };\n    function buildGroups(result, re) {\n      var g = _groups.get(re);\n      return Object.keys(g).reduce(function (groups, name) {\n        groups[name] = result[g[name]];\n        return groups;\n      }, Object.create(null));\n    }\n    return _wrapRegExp.apply(this, arguments);\n  }\n  var vectorMultiply = function vectorMultiply(v, amount) {\n    return createVector(v.x * amount, v.y * amount);\n  };\n  var vectorAdd = function vectorAdd(a, b) {\n    return createVector(a.x + b.x, a.y + b.y);\n  };\n  var vectorNormalize = function vectorNormalize(v) {\n    var l = Math.sqrt(v.x * v.x + v.y * v.y);\n    if (l === 0) {\n      return {\n        x: 0,\n        y: 0\n      };\n    }\n    return createVector(v.x / l, v.y / l);\n  };\n  var vectorRotate = function vectorRotate(v, radians, origin) {\n    var cos = Math.cos(radians);\n    var sin = Math.sin(radians);\n    var t = createVector(v.x - origin.x, v.y - origin.y);\n    return createVector(origin.x + cos * t.x - sin * t.y, origin.y + sin * t.x + cos * t.y);\n  };\n  var createVector = function createVector() {\n    var x = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n    var y = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n    return {\n      x: x,\n      y: y\n    };\n  };\n  var getMarkupValue = function getMarkupValue(value, size) {\n    var scalar = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 1;\n    var axis = arguments.length > 3 ? arguments[3] : undefined;\n    if (typeof value === 'string') {\n      return parseFloat(value) * scalar;\n    }\n    if (typeof value === 'number') {\n      return value * (axis ? size[axis] : Math.min(size.width, size.height));\n    }\n    return;\n  };\n  var getMarkupStyles = function getMarkupStyles(markup, size, scale) {\n    var lineStyle = markup.borderStyle || markup.lineStyle || 'solid';\n    var fill = markup.backgroundColor || markup.fontColor || 'transparent';\n    var stroke = markup.borderColor || markup.lineColor || 'transparent';\n    var strokeWidth = getMarkupValue(markup.borderWidth || markup.lineWidth, size, scale);\n    var lineCap = markup.lineCap || 'round';\n    var lineJoin = markup.lineJoin || 'round';\n    var dashes = typeof lineStyle === 'string' ? '' : lineStyle.map(function (v) {\n      return getMarkupValue(v, size, scale);\n    }).join(',');\n    var opacity = markup.opacity || 1;\n    return {\n      'stroke-linecap': lineCap,\n      'stroke-linejoin': lineJoin,\n      'stroke-width': strokeWidth || 0,\n      'stroke-dasharray': dashes,\n      stroke: stroke,\n      fill: fill,\n      opacity: opacity\n    };\n  };\n  var isDefined = function isDefined(value) {\n    return value != null;\n  };\n  var getMarkupRect = function getMarkupRect(rect, size) {\n    var scalar = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 1;\n    var left = getMarkupValue(rect.x, size, scalar, 'width') || getMarkupValue(rect.left, size, scalar, 'width');\n    var top = getMarkupValue(rect.y, size, scalar, 'height') || getMarkupValue(rect.top, size, scalar, 'height');\n    var width = getMarkupValue(rect.width, size, scalar, 'width');\n    var height = getMarkupValue(rect.height, size, scalar, 'height');\n    var right = getMarkupValue(rect.right, size, scalar, 'width');\n    var bottom = getMarkupValue(rect.bottom, size, scalar, 'height');\n    if (!isDefined(top)) {\n      if (isDefined(height) && isDefined(bottom)) {\n        top = size.height - height - bottom;\n      } else {\n        top = bottom;\n      }\n    }\n    if (!isDefined(left)) {\n      if (isDefined(width) && isDefined(right)) {\n        left = size.width - width - right;\n      } else {\n        left = right;\n      }\n    }\n    if (!isDefined(width)) {\n      if (isDefined(left) && isDefined(right)) {\n        width = size.width - left - right;\n      } else {\n        width = 0;\n      }\n    }\n    if (!isDefined(height)) {\n      if (isDefined(top) && isDefined(bottom)) {\n        height = size.height - top - bottom;\n      } else {\n        height = 0;\n      }\n    }\n    return {\n      x: left || 0,\n      y: top || 0,\n      width: width || 0,\n      height: height || 0\n    };\n  };\n  var pointsToPathShape = function pointsToPathShape(points) {\n    return points.map(function (point, index) {\n      return ''.concat(index === 0 ? 'M' : 'L', ' ').concat(point.x, ' ').concat(point.y);\n    }).join(' ');\n  };\n  var setAttributes = function setAttributes(element, attr) {\n    return Object.keys(attr).forEach(function (key) {\n      return element.setAttribute(key, attr[key]);\n    });\n  };\n  var ns = 'http://www.w3.org/2000/svg';\n  var svg = function svg(tag, attr) {\n    var element = document.createElementNS(ns, tag);\n    if (attr) {\n      setAttributes(element, attr);\n    }\n    return element;\n  };\n  var updateRect = function updateRect(element) {\n    return setAttributes(element, Object.assign({}, element.rect, element.styles));\n  };\n  var updateEllipse = function updateEllipse(element) {\n    var cx = element.rect.x + element.rect.width * 0.5;\n    var cy = element.rect.y + element.rect.height * 0.5;\n    var rx = element.rect.width * 0.5;\n    var ry = element.rect.height * 0.5;\n    return setAttributes(element, Object.assign({\n      cx: cx,\n      cy: cy,\n      rx: rx,\n      ry: ry\n    }, element.styles));\n  };\n  var IMAGE_FIT_STYLE = {\n    contain: 'xMidYMid meet',\n    cover: 'xMidYMid slice'\n  };\n  var updateImage = function updateImage(element, markup) {\n    setAttributes(element, Object.assign({}, element.rect, element.styles, {\n      preserveAspectRatio: IMAGE_FIT_STYLE[markup.fit] || 'none'\n    }));\n  };\n  var TEXT_ANCHOR = {\n    left: 'start',\n    center: 'middle',\n    right: 'end'\n  };\n  var updateText = function updateText(element, markup, size, scale) {\n    var fontSize = getMarkupValue(markup.fontSize, size, scale);\n    var fontFamily = markup.fontFamily || 'sans-serif';\n    var fontWeight = markup.fontWeight || 'normal';\n    var textAlign = TEXT_ANCHOR[markup.textAlign] || 'start';\n    setAttributes(element, Object.assign({}, element.rect, element.styles, {\n      'stroke-width': 0,\n      'font-weight': fontWeight,\n      'font-size': fontSize,\n      'font-family': fontFamily,\n      'text-anchor': textAlign\n    }));\n\n    // update text\n    if (element.text !== markup.text) {\n      element.text = markup.text;\n      element.textContent = markup.text.length ? markup.text : ' ';\n    }\n  };\n  var updateLine = function updateLine(element, markup, size, scale) {\n    setAttributes(element, Object.assign({}, element.rect, element.styles, {\n      fill: 'none'\n    }));\n    var line = element.childNodes[0];\n    var begin = element.childNodes[1];\n    var end = element.childNodes[2];\n    var origin = element.rect;\n    var target = {\n      x: element.rect.x + element.rect.width,\n      y: element.rect.y + element.rect.height\n    };\n    setAttributes(line, {\n      x1: origin.x,\n      y1: origin.y,\n      x2: target.x,\n      y2: target.y\n    });\n    if (!markup.lineDecoration) return;\n    begin.style.display = 'none';\n    end.style.display = 'none';\n    var v = vectorNormalize({\n      x: target.x - origin.x,\n      y: target.y - origin.y\n    });\n    var l = getMarkupValue(0.05, size, scale);\n    if (markup.lineDecoration.indexOf('arrow-begin') !== -1) {\n      var arrowBeginRotationPoint = vectorMultiply(v, l);\n      var arrowBeginCenter = vectorAdd(origin, arrowBeginRotationPoint);\n      var arrowBeginA = vectorRotate(origin, 2, arrowBeginCenter);\n      var arrowBeginB = vectorRotate(origin, -2, arrowBeginCenter);\n      setAttributes(begin, {\n        style: 'display:block;',\n        d: 'M'.concat(arrowBeginA.x, ',').concat(arrowBeginA.y, ' L').concat(origin.x, ',').concat(origin.y, ' L').concat(arrowBeginB.x, ',').concat(arrowBeginB.y)\n      });\n    }\n    if (markup.lineDecoration.indexOf('arrow-end') !== -1) {\n      var arrowEndRotationPoint = vectorMultiply(v, -l);\n      var arrowEndCenter = vectorAdd(target, arrowEndRotationPoint);\n      var arrowEndA = vectorRotate(target, 2, arrowEndCenter);\n      var arrowEndB = vectorRotate(target, -2, arrowEndCenter);\n      setAttributes(end, {\n        style: 'display:block;',\n        d: 'M'.concat(arrowEndA.x, ',').concat(arrowEndA.y, ' L').concat(target.x, ',').concat(target.y, ' L').concat(arrowEndB.x, ',').concat(arrowEndB.y)\n      });\n    }\n  };\n  var updatePath = function updatePath(element, markup, size, scale) {\n    setAttributes(element, Object.assign({}, element.styles, {\n      fill: 'none',\n      d: pointsToPathShape(markup.points.map(function (point) {\n        return {\n          x: getMarkupValue(point.x, size, scale, 'width'),\n          y: getMarkupValue(point.y, size, scale, 'height')\n        };\n      }))\n    }));\n  };\n  var createShape = function createShape(node) {\n    return function (markup) {\n      return svg(node, {\n        id: markup.id\n      });\n    };\n  };\n  var createImage = function createImage(markup) {\n    var shape = svg('image', {\n      id: markup.id,\n      'stroke-linecap': 'round',\n      'stroke-linejoin': 'round',\n      opacity: '0'\n    });\n    shape.onload = function () {\n      shape.setAttribute('opacity', markup.opacity || 1);\n    };\n    shape.setAttributeNS('http://www.w3.org/1999/xlink', 'xlink:href', markup.src);\n    return shape;\n  };\n  var createLine = function createLine(markup) {\n    var shape = svg('g', {\n      id: markup.id,\n      'stroke-linecap': 'round',\n      'stroke-linejoin': 'round'\n    });\n    var line = svg('line');\n    shape.appendChild(line);\n    var begin = svg('path');\n    shape.appendChild(begin);\n    var end = svg('path');\n    shape.appendChild(end);\n    return shape;\n  };\n  var CREATE_TYPE_ROUTES = {\n    image: createImage,\n    rect: createShape('rect'),\n    ellipse: createShape('ellipse'),\n    text: createShape('text'),\n    path: createShape('path'),\n    line: createLine\n  };\n  var UPDATE_TYPE_ROUTES = {\n    rect: updateRect,\n    ellipse: updateEllipse,\n    image: updateImage,\n    text: updateText,\n    path: updatePath,\n    line: updateLine\n  };\n  var createMarkupByType = function createMarkupByType(type, markup) {\n    return CREATE_TYPE_ROUTES[type](markup);\n  };\n  var updateMarkupByType = function updateMarkupByType(element, type, markup, size, scale) {\n    if (type !== 'path') {\n      element.rect = getMarkupRect(markup, size, scale);\n    }\n    element.styles = getMarkupStyles(markup, size, scale);\n    UPDATE_TYPE_ROUTES[type](element, markup, size, scale);\n  };\n  var MARKUP_RECT = ['x', 'y', 'left', 'top', 'right', 'bottom', 'width', 'height'];\n  var toOptionalFraction = function toOptionalFraction(value) {\n    return typeof value === 'string' && /%/.test(value) ? parseFloat(value) / 100 : value;\n  };\n\n  // adds default markup properties, clones markup\n  var prepareMarkup = function prepareMarkup(markup) {\n    var _markup = _slicedToArray(markup, 2),\n      type = _markup[0],\n      props = _markup[1];\n    var rect = props.points ? {} : MARKUP_RECT.reduce(function (prev, curr) {\n      prev[curr] = toOptionalFraction(props[curr]);\n      return prev;\n    }, {});\n    return [type, Object.assign({\n      zIndex: 0\n    }, props, rect)];\n  };\n  var sortMarkupByZIndex = function sortMarkupByZIndex(a, b) {\n    if (a[1].zIndex > b[1].zIndex) {\n      return 1;\n    }\n    if (a[1].zIndex < b[1].zIndex) {\n      return -1;\n    }\n    return 0;\n  };\n  var createMarkupView = function createMarkupView(_) {\n    return _.utils.createView({\n      name: 'image-preview-markup',\n      tag: 'svg',\n      ignoreRect: true,\n      mixins: {\n        apis: ['width', 'height', 'crop', 'markup', 'resize', 'dirty']\n      },\n      write: function write(_ref) {\n        var root = _ref.root,\n          props = _ref.props;\n        if (!props.dirty) return;\n        var crop = props.crop,\n          resize = props.resize,\n          markup = props.markup;\n        var viewWidth = props.width;\n        var viewHeight = props.height;\n        var cropWidth = crop.width;\n        var cropHeight = crop.height;\n        if (resize) {\n          var _size = resize.size;\n          var outputWidth = _size && _size.width;\n          var outputHeight = _size && _size.height;\n          var outputFit = resize.mode;\n          var outputUpscale = resize.upscale;\n          if (outputWidth && !outputHeight) outputHeight = outputWidth;\n          if (outputHeight && !outputWidth) outputWidth = outputHeight;\n          var shouldUpscale = cropWidth < outputWidth && cropHeight < outputHeight;\n          if (!shouldUpscale || shouldUpscale && outputUpscale) {\n            var scalarWidth = outputWidth / cropWidth;\n            var scalarHeight = outputHeight / cropHeight;\n            if (outputFit === 'force') {\n              cropWidth = outputWidth;\n              cropHeight = outputHeight;\n            } else {\n              var scalar;\n              if (outputFit === 'cover') {\n                scalar = Math.max(scalarWidth, scalarHeight);\n              } else if (outputFit === 'contain') {\n                scalar = Math.min(scalarWidth, scalarHeight);\n              }\n              cropWidth = cropWidth * scalar;\n              cropHeight = cropHeight * scalar;\n            }\n          }\n        }\n        var size = {\n          width: viewWidth,\n          height: viewHeight\n        };\n        root.element.setAttribute('width', size.width);\n        root.element.setAttribute('height', size.height);\n        var scale = Math.min(viewWidth / cropWidth, viewHeight / cropHeight);\n\n        // clear\n        root.element.innerHTML = '';\n\n        // get filter\n        var markupFilter = root.query('GET_IMAGE_PREVIEW_MARKUP_FILTER');\n\n        // draw new\n        markup.filter(markupFilter).map(prepareMarkup).sort(sortMarkupByZIndex).forEach(function (markup) {\n          var _markup = _slicedToArray(markup, 2),\n            type = _markup[0],\n            settings = _markup[1];\n\n          // create\n          var element = createMarkupByType(type, settings);\n\n          // update\n          updateMarkupByType(element, type, settings, size, scale);\n\n          // add\n          root.element.appendChild(element);\n        });\n      }\n    });\n  };\n  var createVector$1 = function createVector(x, y) {\n    return {\n      x: x,\n      y: y\n    };\n  };\n  var vectorDot = function vectorDot(a, b) {\n    return a.x * b.x + a.y * b.y;\n  };\n  var vectorSubtract = function vectorSubtract(a, b) {\n    return createVector$1(a.x - b.x, a.y - b.y);\n  };\n  var vectorDistanceSquared = function vectorDistanceSquared(a, b) {\n    return vectorDot(vectorSubtract(a, b), vectorSubtract(a, b));\n  };\n  var vectorDistance = function vectorDistance(a, b) {\n    return Math.sqrt(vectorDistanceSquared(a, b));\n  };\n  var getOffsetPointOnEdge = function getOffsetPointOnEdge(length, rotation) {\n    var a = length;\n    var A = 1.5707963267948966;\n    var B = rotation;\n    var C = 1.5707963267948966 - rotation;\n    var sinA = Math.sin(A);\n    var sinB = Math.sin(B);\n    var sinC = Math.sin(C);\n    var cosC = Math.cos(C);\n    var ratio = a / sinA;\n    var b = ratio * sinB;\n    var c = ratio * sinC;\n    return createVector$1(cosC * b, cosC * c);\n  };\n  var getRotatedRectSize = function getRotatedRectSize(rect, rotation) {\n    var w = rect.width;\n    var h = rect.height;\n    var hor = getOffsetPointOnEdge(w, rotation);\n    var ver = getOffsetPointOnEdge(h, rotation);\n    var tl = createVector$1(rect.x + Math.abs(hor.x), rect.y - Math.abs(hor.y));\n    var tr = createVector$1(rect.x + rect.width + Math.abs(ver.y), rect.y + Math.abs(ver.x));\n    var bl = createVector$1(rect.x - Math.abs(ver.y), rect.y + rect.height - Math.abs(ver.x));\n    return {\n      width: vectorDistance(tl, tr),\n      height: vectorDistance(tl, bl)\n    };\n  };\n  var calculateCanvasSize = function calculateCanvasSize(image, canvasAspectRatio) {\n    var zoom = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 1;\n    var imageAspectRatio = image.height / image.width;\n\n    // determine actual pixels on x and y axis\n    var canvasWidth = 1;\n    var canvasHeight = canvasAspectRatio;\n    var imgWidth = 1;\n    var imgHeight = imageAspectRatio;\n    if (imgHeight > canvasHeight) {\n      imgHeight = canvasHeight;\n      imgWidth = imgHeight / imageAspectRatio;\n    }\n    var scalar = Math.max(canvasWidth / imgWidth, canvasHeight / imgHeight);\n    var width = image.width / (zoom * scalar * imgWidth);\n    var height = width * canvasAspectRatio;\n    return {\n      width: width,\n      height: height\n    };\n  };\n  var getImageRectZoomFactor = function getImageRectZoomFactor(imageRect, cropRect, rotation, center) {\n    // calculate available space round image center position\n    var cx = center.x > 0.5 ? 1 - center.x : center.x;\n    var cy = center.y > 0.5 ? 1 - center.y : center.y;\n    var imageWidth = cx * 2 * imageRect.width;\n    var imageHeight = cy * 2 * imageRect.height;\n\n    // calculate rotated crop rectangle size\n    var rotatedCropSize = getRotatedRectSize(cropRect, rotation);\n\n    // calculate scalar required to fit image\n    return Math.max(rotatedCropSize.width / imageWidth, rotatedCropSize.height / imageHeight);\n  };\n  var getCenteredCropRect = function getCenteredCropRect(container, aspectRatio) {\n    var width = container.width;\n    var height = width * aspectRatio;\n    if (height > container.height) {\n      height = container.height;\n      width = height / aspectRatio;\n    }\n    var x = (container.width - width) * 0.5;\n    var y = (container.height - height) * 0.5;\n    return {\n      x: x,\n      y: y,\n      width: width,\n      height: height\n    };\n  };\n  var getCurrentCropSize = function getCurrentCropSize(imageSize) {\n    var crop = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var zoom = crop.zoom,\n      rotation = crop.rotation,\n      center = crop.center,\n      aspectRatio = crop.aspectRatio;\n    if (!aspectRatio) aspectRatio = imageSize.height / imageSize.width;\n    var canvasSize = calculateCanvasSize(imageSize, aspectRatio, zoom);\n    var canvasCenter = {\n      x: canvasSize.width * 0.5,\n      y: canvasSize.height * 0.5\n    };\n    var stage = {\n      x: 0,\n      y: 0,\n      width: canvasSize.width,\n      height: canvasSize.height,\n      center: canvasCenter\n    };\n    var shouldLimit = typeof crop.scaleToFit === 'undefined' || crop.scaleToFit;\n    var stageZoomFactor = getImageRectZoomFactor(imageSize, getCenteredCropRect(stage, aspectRatio), rotation, shouldLimit ? center : {\n      x: 0.5,\n      y: 0.5\n    });\n    var scale = zoom * stageZoomFactor;\n\n    // start drawing\n    return {\n      widthFloat: canvasSize.width / scale,\n      heightFloat: canvasSize.height / scale,\n      width: Math.round(canvasSize.width / scale),\n      height: Math.round(canvasSize.height / scale)\n    };\n  };\n  var IMAGE_SCALE_SPRING_PROPS = {\n    type: 'spring',\n    stiffness: 0.5,\n    damping: 0.45,\n    mass: 10\n  };\n\n  // does horizontal and vertical flipping\n  var createBitmapView = function createBitmapView(_) {\n    return _.utils.createView({\n      name: 'image-bitmap',\n      ignoreRect: true,\n      mixins: {\n        styles: ['scaleX', 'scaleY']\n      },\n      create: function create(_ref) {\n        var root = _ref.root,\n          props = _ref.props;\n        root.appendChild(props.image);\n      }\n    });\n  };\n\n  // shifts and rotates image\n  var createImageCanvasWrapper = function createImageCanvasWrapper(_) {\n    return _.utils.createView({\n      name: 'image-canvas-wrapper',\n      tag: 'div',\n      ignoreRect: true,\n      mixins: {\n        apis: ['crop', 'width', 'height'],\n        styles: ['originX', 'originY', 'translateX', 'translateY', 'scaleX', 'scaleY', 'rotateZ'],\n        animations: {\n          originX: IMAGE_SCALE_SPRING_PROPS,\n          originY: IMAGE_SCALE_SPRING_PROPS,\n          scaleX: IMAGE_SCALE_SPRING_PROPS,\n          scaleY: IMAGE_SCALE_SPRING_PROPS,\n          translateX: IMAGE_SCALE_SPRING_PROPS,\n          translateY: IMAGE_SCALE_SPRING_PROPS,\n          rotateZ: IMAGE_SCALE_SPRING_PROPS\n        }\n      },\n      create: function create(_ref2) {\n        var root = _ref2.root,\n          props = _ref2.props;\n        props.width = props.image.width;\n        props.height = props.image.height;\n        root.ref.bitmap = root.appendChildView(root.createChildView(createBitmapView(_), {\n          image: props.image\n        }));\n      },\n      write: function write(_ref3) {\n        var root = _ref3.root,\n          props = _ref3.props;\n        var flip = props.crop.flip;\n        var bitmap = root.ref.bitmap;\n        bitmap.scaleX = flip.horizontal ? -1 : 1;\n        bitmap.scaleY = flip.vertical ? -1 : 1;\n      }\n    });\n  };\n\n  // clips canvas to correct aspect ratio\n  var createClipView = function createClipView(_) {\n    return _.utils.createView({\n      name: 'image-clip',\n      tag: 'div',\n      ignoreRect: true,\n      mixins: {\n        apis: ['crop', 'markup', 'resize', 'width', 'height', 'dirty', 'background'],\n        styles: ['width', 'height', 'opacity'],\n        animations: {\n          opacity: {\n            type: 'tween',\n            duration: 250\n          }\n        }\n      },\n      didWriteView: function didWriteView(_ref4) {\n        var root = _ref4.root,\n          props = _ref4.props;\n        if (!props.background) return;\n        root.element.style.backgroundColor = props.background;\n      },\n      create: function create(_ref5) {\n        var root = _ref5.root,\n          props = _ref5.props;\n        root.ref.image = root.appendChildView(root.createChildView(createImageCanvasWrapper(_), Object.assign({}, props)));\n        root.ref.createMarkup = function () {\n          if (root.ref.markup) return;\n          root.ref.markup = root.appendChildView(root.createChildView(createMarkupView(_), Object.assign({}, props)));\n        };\n        root.ref.destroyMarkup = function () {\n          if (!root.ref.markup) return;\n          root.removeChildView(root.ref.markup);\n          root.ref.markup = null;\n        };\n\n        // set up transparency grid\n        var transparencyIndicator = root.query('GET_IMAGE_PREVIEW_TRANSPARENCY_INDICATOR');\n        if (transparencyIndicator === null) return;\n\n        // grid pattern\n        if (transparencyIndicator === 'grid') {\n          root.element.dataset.transparencyIndicator = transparencyIndicator;\n        }\n        // basic color\n        else {\n          root.element.dataset.transparencyIndicator = 'color';\n        }\n      },\n      write: function write(_ref6) {\n        var root = _ref6.root,\n          props = _ref6.props,\n          shouldOptimize = _ref6.shouldOptimize;\n        var crop = props.crop,\n          markup = props.markup,\n          resize = props.resize,\n          dirty = props.dirty,\n          width = props.width,\n          height = props.height;\n        root.ref.image.crop = crop;\n        var stage = {\n          x: 0,\n          y: 0,\n          width: width,\n          height: height,\n          center: {\n            x: width * 0.5,\n            y: height * 0.5\n          }\n        };\n        var image = {\n          width: root.ref.image.width,\n          height: root.ref.image.height\n        };\n        var origin = {\n          x: crop.center.x * image.width,\n          y: crop.center.y * image.height\n        };\n        var translation = {\n          x: stage.center.x - image.width * crop.center.x,\n          y: stage.center.y - image.height * crop.center.y\n        };\n        var rotation = Math.PI * 2 + crop.rotation % (Math.PI * 2);\n        var cropAspectRatio = crop.aspectRatio || image.height / image.width;\n        var shouldLimit = typeof crop.scaleToFit === 'undefined' || crop.scaleToFit;\n        var stageZoomFactor = getImageRectZoomFactor(image, getCenteredCropRect(stage, cropAspectRatio), rotation, shouldLimit ? crop.center : {\n          x: 0.5,\n          y: 0.5\n        });\n        var scale = crop.zoom * stageZoomFactor;\n\n        // update markup view\n        if (markup && markup.length) {\n          root.ref.createMarkup();\n          root.ref.markup.width = width;\n          root.ref.markup.height = height;\n          root.ref.markup.resize = resize;\n          root.ref.markup.dirty = dirty;\n          root.ref.markup.markup = markup;\n          root.ref.markup.crop = getCurrentCropSize(image, crop);\n        } else if (root.ref.markup) {\n          root.ref.destroyMarkup();\n        }\n\n        // update image view\n        var imageView = root.ref.image;\n\n        // don't update clip layout\n        if (shouldOptimize) {\n          imageView.originX = null;\n          imageView.originY = null;\n          imageView.translateX = null;\n          imageView.translateY = null;\n          imageView.rotateZ = null;\n          imageView.scaleX = null;\n          imageView.scaleY = null;\n          return;\n        }\n        imageView.originX = origin.x;\n        imageView.originY = origin.y;\n        imageView.translateX = translation.x;\n        imageView.translateY = translation.y;\n        imageView.rotateZ = rotation;\n        imageView.scaleX = scale;\n        imageView.scaleY = scale;\n      }\n    });\n  };\n  var createImageView = function createImageView(_) {\n    return _.utils.createView({\n      name: 'image-preview',\n      tag: 'div',\n      ignoreRect: true,\n      mixins: {\n        apis: ['image', 'crop', 'markup', 'resize', 'dirty', 'background'],\n        styles: ['translateY', 'scaleX', 'scaleY', 'opacity'],\n        animations: {\n          scaleX: IMAGE_SCALE_SPRING_PROPS,\n          scaleY: IMAGE_SCALE_SPRING_PROPS,\n          translateY: IMAGE_SCALE_SPRING_PROPS,\n          opacity: {\n            type: 'tween',\n            duration: 400\n          }\n        }\n      },\n      create: function create(_ref7) {\n        var root = _ref7.root,\n          props = _ref7.props;\n        root.ref.clip = root.appendChildView(root.createChildView(createClipView(_), {\n          id: props.id,\n          image: props.image,\n          crop: props.crop,\n          markup: props.markup,\n          resize: props.resize,\n          dirty: props.dirty,\n          background: props.background\n        }));\n      },\n      write: function write(_ref8) {\n        var root = _ref8.root,\n          props = _ref8.props,\n          shouldOptimize = _ref8.shouldOptimize;\n        var clip = root.ref.clip;\n        var image = props.image,\n          crop = props.crop,\n          markup = props.markup,\n          resize = props.resize,\n          dirty = props.dirty;\n        clip.crop = crop;\n        clip.markup = markup;\n        clip.resize = resize;\n        clip.dirty = dirty;\n\n        // don't update clip layout\n        clip.opacity = shouldOptimize ? 0 : 1;\n\n        // don't re-render if optimizing or hidden (width will be zero resulting in weird animations)\n        if (shouldOptimize || root.rect.element.hidden) return;\n\n        // calculate scaled preview image size\n        var imageAspectRatio = image.height / image.width;\n        var aspectRatio = crop.aspectRatio || imageAspectRatio;\n\n        // calculate container size\n        var containerWidth = root.rect.inner.width;\n        var containerHeight = root.rect.inner.height;\n        var fixedPreviewHeight = root.query('GET_IMAGE_PREVIEW_HEIGHT');\n        var minPreviewHeight = root.query('GET_IMAGE_PREVIEW_MIN_HEIGHT');\n        var maxPreviewHeight = root.query('GET_IMAGE_PREVIEW_MAX_HEIGHT');\n        var panelAspectRatio = root.query('GET_PANEL_ASPECT_RATIO');\n        var allowMultiple = root.query('GET_ALLOW_MULTIPLE');\n        if (panelAspectRatio && !allowMultiple) {\n          fixedPreviewHeight = containerWidth * panelAspectRatio;\n          aspectRatio = panelAspectRatio;\n        }\n\n        // determine clip width and height\n        var clipHeight = fixedPreviewHeight !== null ? fixedPreviewHeight : Math.max(minPreviewHeight, Math.min(containerWidth * aspectRatio, maxPreviewHeight));\n        var clipWidth = clipHeight / aspectRatio;\n        if (clipWidth > containerWidth) {\n          clipWidth = containerWidth;\n          clipHeight = clipWidth * aspectRatio;\n        }\n        if (clipHeight > containerHeight) {\n          clipHeight = containerHeight;\n          clipWidth = containerHeight / aspectRatio;\n        }\n        clip.width = clipWidth;\n        clip.height = clipHeight;\n      }\n    });\n  };\n  var SVG_MASK = '<svg width=\"500\" height=\"200\" viewBox=\"0 0 500 200\" preserveAspectRatio=\"none\">\\n    <defs>\\n        <radialGradient id=\"gradient-__UID__\" cx=\".5\" cy=\"1.25\" r=\"1.15\">\\n            <stop offset=\\'50%\\' stop-color=\\'#000000\\'/>\\n            <stop offset=\\'56%\\' stop-color=\\'#0a0a0a\\'/>\\n            <stop offset=\\'63%\\' stop-color=\\'#262626\\'/>\\n            <stop offset=\\'69%\\' stop-color=\\'#4f4f4f\\'/>\\n            <stop offset=\\'75%\\' stop-color=\\'#808080\\'/>\\n            <stop offset=\\'81%\\' stop-color=\\'#b1b1b1\\'/>\\n            <stop offset=\\'88%\\' stop-color=\\'#dadada\\'/>\\n            <stop offset=\\'94%\\' stop-color=\\'#f6f6f6\\'/>\\n            <stop offset=\\'100%\\' stop-color=\\'#ffffff\\'/>\\n        </radialGradient>\\n        <mask id=\"mask-__UID__\">\\n            <rect x=\"0\" y=\"0\" width=\"500\" height=\"200\" fill=\"url(#gradient-__UID__)\"></rect>\\n        </mask>\\n    </defs>\\n    <rect x=\"0\" width=\"500\" height=\"200\" fill=\"currentColor\" mask=\"url(#mask-__UID__)\"></rect>\\n</svg>';\n  var SVGMaskUniqueId = 0;\n  var createImageOverlayView = function createImageOverlayView(fpAPI) {\n    return fpAPI.utils.createView({\n      name: 'image-preview-overlay',\n      tag: 'div',\n      ignoreRect: true,\n      create: function create(_ref) {\n        var root = _ref.root,\n          props = _ref.props;\n        var mask = SVG_MASK;\n        if (document.querySelector('base')) {\n          var url = new URL(window.location.href.replace(window.location.hash, '')).href;\n          mask = mask.replace(/url\\(\\#/g, 'url(' + url + '#');\n        }\n        SVGMaskUniqueId++;\n        root.element.classList.add('filepond--image-preview-overlay-'.concat(props.status));\n        root.element.innerHTML = mask.replace(/__UID__/g, SVGMaskUniqueId);\n      },\n      mixins: {\n        styles: ['opacity'],\n        animations: {\n          opacity: {\n            type: 'spring',\n            mass: 25\n          }\n        }\n      }\n    });\n  };\n\n  /**\n   * Bitmap Worker\n   */\n  var BitmapWorker = function BitmapWorker() {\n    self.onmessage = function (e) {\n      createImageBitmap(e.data.message.file).then(function (bitmap) {\n        self.postMessage({\n          id: e.data.id,\n          message: bitmap\n        }, [bitmap]);\n      });\n    };\n  };\n\n  /**\n   * ColorMatrix Worker\n   */\n  var ColorMatrixWorker = function ColorMatrixWorker() {\n    self.onmessage = function (e) {\n      var imageData = e.data.message.imageData;\n      var matrix = e.data.message.colorMatrix;\n      var data = imageData.data;\n      var l = data.length;\n      var m11 = matrix[0];\n      var m12 = matrix[1];\n      var m13 = matrix[2];\n      var m14 = matrix[3];\n      var m15 = matrix[4];\n      var m21 = matrix[5];\n      var m22 = matrix[6];\n      var m23 = matrix[7];\n      var m24 = matrix[8];\n      var m25 = matrix[9];\n      var m31 = matrix[10];\n      var m32 = matrix[11];\n      var m33 = matrix[12];\n      var m34 = matrix[13];\n      var m35 = matrix[14];\n      var m41 = matrix[15];\n      var m42 = matrix[16];\n      var m43 = matrix[17];\n      var m44 = matrix[18];\n      var m45 = matrix[19];\n      var index = 0,\n        r = 0.0,\n        g = 0.0,\n        b = 0.0,\n        a = 0.0;\n      for (; index < l; index += 4) {\n        r = data[index] / 255;\n        g = data[index + 1] / 255;\n        b = data[index + 2] / 255;\n        a = data[index + 3] / 255;\n        data[index] = Math.max(0, Math.min((r * m11 + g * m12 + b * m13 + a * m14 + m15) * 255, 255));\n        data[index + 1] = Math.max(0, Math.min((r * m21 + g * m22 + b * m23 + a * m24 + m25) * 255, 255));\n        data[index + 2] = Math.max(0, Math.min((r * m31 + g * m32 + b * m33 + a * m34 + m35) * 255, 255));\n        data[index + 3] = Math.max(0, Math.min((r * m41 + g * m42 + b * m43 + a * m44 + m45) * 255, 255));\n      }\n      self.postMessage({\n        id: e.data.id,\n        message: imageData\n      }, [imageData.data.buffer]);\n    };\n  };\n  var getImageSize = function getImageSize(url, cb) {\n    var image = new Image();\n    image.onload = function () {\n      var width = image.naturalWidth;\n      var height = image.naturalHeight;\n      image = null;\n      cb(width, height);\n    };\n    image.src = url;\n  };\n  var transforms = {\n    1: function _() {\n      return [1, 0, 0, 1, 0, 0];\n    },\n    2: function _(width) {\n      return [-1, 0, 0, 1, width, 0];\n    },\n    3: function _(width, height) {\n      return [-1, 0, 0, -1, width, height];\n    },\n    4: function _(width, height) {\n      return [1, 0, 0, -1, 0, height];\n    },\n    5: function _() {\n      return [0, 1, 1, 0, 0, 0];\n    },\n    6: function _(width, height) {\n      return [0, 1, -1, 0, height, 0];\n    },\n    7: function _(width, height) {\n      return [0, -1, -1, 0, height, width];\n    },\n    8: function _(width) {\n      return [0, -1, 1, 0, 0, width];\n    }\n  };\n  var fixImageOrientation = function fixImageOrientation(ctx, width, height, orientation) {\n    // no orientation supplied\n    if (orientation === -1) {\n      return;\n    }\n    ctx.transform.apply(ctx, transforms[orientation](width, height));\n  };\n\n  // draws the preview image to canvas\n  var createPreviewImage = function createPreviewImage(data, width, height, orientation) {\n    // can't draw on half pixels\n    width = Math.round(width);\n    height = Math.round(height);\n\n    // draw image\n    var canvas = document.createElement('canvas');\n    canvas.width = width;\n    canvas.height = height;\n    var ctx = canvas.getContext('2d');\n\n    // if is rotated incorrectly swap width and height\n    if (orientation >= 5 && orientation <= 8) {\n      var _ref = [height, width];\n      width = _ref[0];\n      height = _ref[1];\n    }\n\n    // correct image orientation\n    fixImageOrientation(ctx, width, height, orientation);\n\n    // draw the image\n    ctx.drawImage(data, 0, 0, width, height);\n    return canvas;\n  };\n  var isBitmap = function isBitmap(file) {\n    return /^image/.test(file.type) && !/svg/.test(file.type);\n  };\n  var MAX_WIDTH = 10;\n  var MAX_HEIGHT = 10;\n  var calculateAverageColor = function calculateAverageColor(image) {\n    var scalar = Math.min(MAX_WIDTH / image.width, MAX_HEIGHT / image.height);\n    var canvas = document.createElement('canvas');\n    var ctx = canvas.getContext('2d');\n    var width = canvas.width = Math.ceil(image.width * scalar);\n    var height = canvas.height = Math.ceil(image.height * scalar);\n    ctx.drawImage(image, 0, 0, width, height);\n    var data = null;\n    try {\n      data = ctx.getImageData(0, 0, width, height).data;\n    } catch (e) {\n      return null;\n    }\n    var l = data.length;\n    var r = 0;\n    var g = 0;\n    var b = 0;\n    var i = 0;\n    for (; i < l; i += 4) {\n      r += data[i] * data[i];\n      g += data[i + 1] * data[i + 1];\n      b += data[i + 2] * data[i + 2];\n    }\n    r = averageColor(r, l);\n    g = averageColor(g, l);\n    b = averageColor(b, l);\n    return {\n      r: r,\n      g: g,\n      b: b\n    };\n  };\n  var averageColor = function averageColor(c, l) {\n    return Math.floor(Math.sqrt(c / (l / 4)));\n  };\n  var cloneCanvas = function cloneCanvas(origin, target) {\n    target = target || document.createElement('canvas');\n    target.width = origin.width;\n    target.height = origin.height;\n    var ctx = target.getContext('2d');\n    ctx.drawImage(origin, 0, 0);\n    return target;\n  };\n  var cloneImageData = function cloneImageData(imageData) {\n    var id;\n    try {\n      id = new ImageData(imageData.width, imageData.height);\n    } catch (e) {\n      var canvas = document.createElement('canvas');\n      var ctx = canvas.getContext('2d');\n      id = ctx.createImageData(imageData.width, imageData.height);\n    }\n    id.data.set(new Uint8ClampedArray(imageData.data));\n    return id;\n  };\n  var loadImage = function loadImage(url) {\n    return new Promise(function (resolve, reject) {\n      var img = new Image();\n      img.crossOrigin = 'Anonymous';\n      img.onload = function () {\n        resolve(img);\n      };\n      img.onerror = function (e) {\n        reject(e);\n      };\n      img.src = url;\n    });\n  };\n  var createImageWrapperView = function createImageWrapperView(_) {\n    // create overlay view\n    var OverlayView = createImageOverlayView(_);\n    var ImageView = createImageView(_);\n    var createWorker = _.utils.createWorker;\n    var applyFilter = function applyFilter(root, filter, target) {\n      return new Promise(function (resolve) {\n        // will store image data for future filter updates\n        if (!root.ref.imageData) {\n          root.ref.imageData = target.getContext('2d').getImageData(0, 0, target.width, target.height);\n        }\n\n        // get image data reference\n        var imageData = cloneImageData(root.ref.imageData);\n        if (!filter || filter.length !== 20) {\n          target.getContext('2d').putImageData(imageData, 0, 0);\n          return resolve();\n        }\n        var worker = createWorker(ColorMatrixWorker);\n        worker.post({\n          imageData: imageData,\n          colorMatrix: filter\n        }, function (response) {\n          // apply filtered colors\n          target.getContext('2d').putImageData(response, 0, 0);\n\n          // stop worker\n          worker.terminate();\n\n          // done!\n          resolve();\n        }, [imageData.data.buffer]);\n      });\n    };\n    var removeImageView = function removeImageView(root, imageView) {\n      root.removeChildView(imageView);\n      imageView.image.width = 1;\n      imageView.image.height = 1;\n      imageView._destroy();\n    };\n\n    // remove an image\n    var shiftImage = function shiftImage(_ref) {\n      var root = _ref.root;\n      var imageView = root.ref.images.shift();\n      imageView.opacity = 0;\n      imageView.translateY = -15;\n      root.ref.imageViewBin.push(imageView);\n      return imageView;\n    };\n\n    // add new image\n    var pushImage = function pushImage(_ref2) {\n      var root = _ref2.root,\n        props = _ref2.props,\n        image = _ref2.image;\n      var id = props.id;\n      var item = root.query('GET_ITEM', {\n        id: id\n      });\n      if (!item) return;\n      var crop = item.getMetadata('crop') || {\n        center: {\n          x: 0.5,\n          y: 0.5\n        },\n        flip: {\n          horizontal: false,\n          vertical: false\n        },\n        zoom: 1,\n        rotation: 0,\n        aspectRatio: null\n      };\n      var background = root.query('GET_IMAGE_TRANSFORM_CANVAS_BACKGROUND_COLOR');\n      var markup;\n      var resize;\n      var dirty = false;\n      if (root.query('GET_IMAGE_PREVIEW_MARKUP_SHOW')) {\n        markup = item.getMetadata('markup') || [];\n        resize = item.getMetadata('resize');\n        dirty = true;\n      }\n\n      // append image presenter\n      var imageView = root.appendChildView(root.createChildView(ImageView, {\n        id: id,\n        image: image,\n        crop: crop,\n        resize: resize,\n        markup: markup,\n        dirty: dirty,\n        background: background,\n        opacity: 0,\n        scaleX: 1.15,\n        scaleY: 1.15,\n        translateY: 15\n      }), root.childViews.length);\n      root.ref.images.push(imageView);\n\n      // reveal the preview image\n      imageView.opacity = 1;\n      imageView.scaleX = 1;\n      imageView.scaleY = 1;\n      imageView.translateY = 0;\n\n      // the preview is now ready to be drawn\n      setTimeout(function () {\n        root.dispatch('DID_IMAGE_PREVIEW_SHOW', {\n          id: id\n        });\n      }, 250);\n    };\n    var updateImage = function updateImage(_ref3) {\n      var root = _ref3.root,\n        props = _ref3.props;\n      var item = root.query('GET_ITEM', {\n        id: props.id\n      });\n      if (!item) return;\n      var imageView = root.ref.images[root.ref.images.length - 1];\n      imageView.crop = item.getMetadata('crop');\n      imageView.background = root.query('GET_IMAGE_TRANSFORM_CANVAS_BACKGROUND_COLOR');\n      if (root.query('GET_IMAGE_PREVIEW_MARKUP_SHOW')) {\n        imageView.dirty = true;\n        imageView.resize = item.getMetadata('resize');\n        imageView.markup = item.getMetadata('markup');\n      }\n    };\n\n    // replace image preview\n    var didUpdateItemMetadata = function didUpdateItemMetadata(_ref4) {\n      var root = _ref4.root,\n        props = _ref4.props,\n        action = _ref4.action;\n      // only filter and crop trigger redraw\n      if (!/crop|filter|markup|resize/.test(action.change.key)) return;\n\n      // no images to update, exit\n      if (!root.ref.images.length) return;\n\n      // no item found, exit\n      var item = root.query('GET_ITEM', {\n        id: props.id\n      });\n      if (!item) return;\n\n      // for now, update existing image when filtering\n      if (/filter/.test(action.change.key)) {\n        var imageView = root.ref.images[root.ref.images.length - 1];\n        applyFilter(root, action.change.value, imageView.image);\n        return;\n      }\n      if (/crop|markup|resize/.test(action.change.key)) {\n        var crop = item.getMetadata('crop');\n        var image = root.ref.images[root.ref.images.length - 1];\n\n        // if aspect ratio has changed, we need to create a new image\n        if (crop && crop.aspectRatio && image.crop && image.crop.aspectRatio && Math.abs(crop.aspectRatio - image.crop.aspectRatio) > 0.00001) {\n          var _imageView = shiftImage({\n            root: root\n          });\n          pushImage({\n            root: root,\n            props: props,\n            image: cloneCanvas(_imageView.image)\n          });\n        }\n        // if not, we can update the current image\n        else {\n          updateImage({\n            root: root,\n            props: props\n          });\n        }\n      }\n    };\n    var canCreateImageBitmap = function canCreateImageBitmap(file) {\n      // Firefox versions before 58 will freeze when running createImageBitmap\n      // in a Web Worker so we detect those versions and return false for support\n      var userAgent = window.navigator.userAgent;\n      var isFirefox = userAgent.match(/Firefox\\/([0-9]+)\\./);\n      var firefoxVersion = isFirefox ? parseInt(isFirefox[1]) : null;\n      if (firefoxVersion <= 58) return false;\n      return 'createImageBitmap' in window && isBitmap(file);\n    };\n\n    /**\n     * Write handler for when preview container has been created\n     */\n    var didCreatePreviewContainer = function didCreatePreviewContainer(_ref5) {\n      var root = _ref5.root,\n        props = _ref5.props;\n      var id = props.id;\n\n      // we need to get the file data to determine the eventual image size\n      var item = root.query('GET_ITEM', id);\n      if (!item) return;\n\n      // get url to file (we'll revoke it later on when done)\n      var fileURL = URL.createObjectURL(item.file);\n\n      // determine image size of this item\n      getImageSize(fileURL, function (width, height) {\n        // we can now scale the panel to the final size\n        root.dispatch('DID_IMAGE_PREVIEW_CALCULATE_SIZE', {\n          id: id,\n          width: width,\n          height: height\n        });\n      });\n    };\n    var drawPreview = function drawPreview(_ref6) {\n      var root = _ref6.root,\n        props = _ref6.props;\n      var id = props.id;\n\n      // we need to get the file data to determine the eventual image size\n      var item = root.query('GET_ITEM', id);\n      if (!item) return;\n\n      // get url to file (we'll revoke it later on when done)\n      var fileURL = URL.createObjectURL(item.file);\n\n      // fallback\n      var loadPreviewFallback = function loadPreviewFallback() {\n        // let's scale the image in the main thread :(\n        loadImage(fileURL).then(previewImageLoaded);\n      };\n\n      // image is now ready\n      var previewImageLoaded = function previewImageLoaded(imageData) {\n        // the file url is no longer needed\n        URL.revokeObjectURL(fileURL);\n\n        // draw the scaled down version here and use that as source so bitmapdata can be closed\n        // orientation info\n        var exif = item.getMetadata('exif') || {};\n        var orientation = exif.orientation || -1;\n\n        // get width and height from action, and swap if orientation is incorrect\n        var width = imageData.width,\n          height = imageData.height;\n\n        // if no width or height, just return early.\n        if (!width || !height) return;\n        if (orientation >= 5 && orientation <= 8) {\n          var _ref7 = [height, width];\n          width = _ref7[0];\n          height = _ref7[1];\n        }\n\n        // scale canvas based on pixel density\n        // we multiply by .75 as that creates smaller but still clear images on screens with high res displays\n        var pixelDensityFactor = Math.max(1, window.devicePixelRatio * 0.75);\n\n        // we want as much pixels to work with as possible,\n        // this multiplies the minimum image resolution,\n        // so when zooming in it doesn't get too blurry\n        var zoomFactor = root.query('GET_IMAGE_PREVIEW_ZOOM_FACTOR');\n\n        // imaeg scale factor\n        var scaleFactor = zoomFactor * pixelDensityFactor;\n\n        // calculate scaled preview image size\n        var previewImageRatio = height / width;\n\n        // calculate image preview height and width\n        var previewContainerWidth = root.rect.element.width;\n        var previewContainerHeight = root.rect.element.height;\n        var imageWidth = previewContainerWidth;\n        var imageHeight = imageWidth * previewImageRatio;\n        if (previewImageRatio > 1) {\n          imageWidth = Math.min(width, previewContainerWidth * scaleFactor);\n          imageHeight = imageWidth * previewImageRatio;\n        } else {\n          imageHeight = Math.min(height, previewContainerHeight * scaleFactor);\n          imageWidth = imageHeight / previewImageRatio;\n        }\n\n        // transfer to image tag so no canvas memory wasted on iOS\n        var previewImage = createPreviewImage(imageData, imageWidth, imageHeight, orientation);\n\n        // done\n        var done = function done() {\n          // calculate average image color, disabled for now\n          var averageColor = root.query('GET_IMAGE_PREVIEW_CALCULATE_AVERAGE_IMAGE_COLOR') ? calculateAverageColor(data) : null;\n          item.setMetadata('color', averageColor, true);\n\n          // data has been transferred to canvas ( if was ImageBitmap )\n          if ('close' in imageData) {\n            imageData.close();\n          }\n\n          // show the overlay\n          root.ref.overlayShadow.opacity = 1;\n\n          // create the first image\n          pushImage({\n            root: root,\n            props: props,\n            image: previewImage\n          });\n        };\n\n        // apply filter\n        var filter = item.getMetadata('filter');\n        if (filter) {\n          applyFilter(root, filter, previewImage).then(done);\n        } else {\n          done();\n        }\n      };\n\n      // if we support scaling using createImageBitmap we use a worker\n      if (canCreateImageBitmap(item.file)) {\n        // let's scale the image in a worker\n        var worker = createWorker(BitmapWorker);\n        worker.post({\n          file: item.file\n        }, function (imageBitmap) {\n          // destroy worker\n          worker.terminate();\n\n          // no bitmap returned, must be something wrong,\n          // try the oldschool way\n          if (!imageBitmap) {\n            loadPreviewFallback();\n            return;\n          }\n\n          // yay we got our bitmap, let's continue showing the preview\n          previewImageLoaded(imageBitmap);\n        });\n      } else {\n        // create fallback preview\n        loadPreviewFallback();\n      }\n    };\n\n    /**\n     * Write handler for when the preview image is ready to be animated\n     */\n    var didDrawPreview = function didDrawPreview(_ref8) {\n      var root = _ref8.root;\n      // get last added image\n      var image = root.ref.images[root.ref.images.length - 1];\n      image.translateY = 0;\n      image.scaleX = 1.0;\n      image.scaleY = 1.0;\n      image.opacity = 1;\n    };\n\n    /**\n     * Write handler for when the preview has been loaded\n     */\n    var restoreOverlay = function restoreOverlay(_ref9) {\n      var root = _ref9.root;\n      root.ref.overlayShadow.opacity = 1;\n      root.ref.overlayError.opacity = 0;\n      root.ref.overlaySuccess.opacity = 0;\n    };\n    var didThrowError = function didThrowError(_ref10) {\n      var root = _ref10.root;\n      root.ref.overlayShadow.opacity = 0.25;\n      root.ref.overlayError.opacity = 1;\n    };\n    var didCompleteProcessing = function didCompleteProcessing(_ref11) {\n      var root = _ref11.root;\n      root.ref.overlayShadow.opacity = 0.25;\n      root.ref.overlaySuccess.opacity = 1;\n    };\n\n    /**\n     * Constructor\n     */\n    var create = function create(_ref12) {\n      var root = _ref12.root;\n      // image view\n      root.ref.images = [];\n\n      // the preview image data (we need this to filter the image)\n      root.ref.imageData = null;\n\n      // image bin\n      root.ref.imageViewBin = [];\n\n      // image overlays\n      root.ref.overlayShadow = root.appendChildView(root.createChildView(OverlayView, {\n        opacity: 0,\n        status: 'idle'\n      }));\n      root.ref.overlaySuccess = root.appendChildView(root.createChildView(OverlayView, {\n        opacity: 0,\n        status: 'success'\n      }));\n      root.ref.overlayError = root.appendChildView(root.createChildView(OverlayView, {\n        opacity: 0,\n        status: 'failure'\n      }));\n    };\n    return _.utils.createView({\n      name: 'image-preview-wrapper',\n      create: create,\n      styles: ['height'],\n      apis: ['height'],\n      destroy: function destroy(_ref13) {\n        var root = _ref13.root;\n        // we resize the image so memory on iOS 12 is released more quickly (it seems)\n        root.ref.images.forEach(function (imageView) {\n          imageView.image.width = 1;\n          imageView.image.height = 1;\n        });\n      },\n      didWriteView: function didWriteView(_ref14) {\n        var root = _ref14.root;\n        root.ref.images.forEach(function (imageView) {\n          imageView.dirty = false;\n        });\n      },\n      write: _.utils.createRoute({\n        // image preview stated\n        DID_IMAGE_PREVIEW_DRAW: didDrawPreview,\n        DID_IMAGE_PREVIEW_CONTAINER_CREATE: didCreatePreviewContainer,\n        DID_FINISH_CALCULATE_PREVIEWSIZE: drawPreview,\n        DID_UPDATE_ITEM_METADATA: didUpdateItemMetadata,\n        // file states\n        DID_THROW_ITEM_LOAD_ERROR: didThrowError,\n        DID_THROW_ITEM_PROCESSING_ERROR: didThrowError,\n        DID_THROW_ITEM_INVALID: didThrowError,\n        DID_COMPLETE_ITEM_PROCESSING: didCompleteProcessing,\n        DID_START_ITEM_PROCESSING: restoreOverlay,\n        DID_REVERT_ITEM_PROCESSING: restoreOverlay\n      }, function (_ref15) {\n        var root = _ref15.root;\n        // views on death row\n        var viewsToRemove = root.ref.imageViewBin.filter(function (imageView) {\n          return imageView.opacity === 0;\n        });\n\n        // views to retain\n        root.ref.imageViewBin = root.ref.imageViewBin.filter(function (imageView) {\n          return imageView.opacity > 0;\n        });\n\n        // remove these views\n        viewsToRemove.forEach(function (imageView) {\n          return removeImageView(root, imageView);\n        });\n        viewsToRemove.length = 0;\n      })\n    });\n  };\n\n  /**\n   * Image Preview Plugin\n   */\n  var plugin = function plugin(fpAPI) {\n    var addFilter = fpAPI.addFilter,\n      utils = fpAPI.utils;\n    var Type = utils.Type,\n      createRoute = utils.createRoute,\n      isFile = utils.isFile;\n\n    // imagePreviewView\n    var imagePreviewView = createImageWrapperView(fpAPI);\n\n    // called for each view that is created right after the 'create' method\n    addFilter('CREATE_VIEW', function (viewAPI) {\n      // get reference to created view\n      var is = viewAPI.is,\n        view = viewAPI.view,\n        query = viewAPI.query;\n\n      // only hook up to item view and only if is enabled for this cropper\n      if (!is('file') || !query('GET_ALLOW_IMAGE_PREVIEW')) return;\n\n      // create the image preview plugin, but only do so if the item is an image\n      var didLoadItem = function didLoadItem(_ref) {\n        var root = _ref.root,\n          props = _ref.props;\n        var id = props.id;\n        var item = query('GET_ITEM', id);\n\n        // item could theoretically have been removed in the mean time\n        if (!item || !isFile(item.file) || item.archived) return;\n\n        // get the file object\n        var file = item.file;\n\n        // exit if this is not an image\n        if (!isPreviewableImage(file)) return;\n\n        // test if is filtered\n        if (!query('GET_IMAGE_PREVIEW_FILTER_ITEM')(item)) return;\n\n        // exit if image size is too high and no createImageBitmap support\n        // this would simply bring the browser to its knees and that is not what we want\n        var supportsCreateImageBitmap = ('createImageBitmap' in (window || {}));\n        var maxPreviewFileSize = query('GET_IMAGE_PREVIEW_MAX_FILE_SIZE');\n        if (!supportsCreateImageBitmap && maxPreviewFileSize && file.size > maxPreviewFileSize) return;\n\n        // set preview view\n        root.ref.imagePreview = view.appendChildView(view.createChildView(imagePreviewView, {\n          id: id\n        }));\n\n        // update height if is fixed\n        var fixedPreviewHeight = root.query('GET_IMAGE_PREVIEW_HEIGHT');\n        if (fixedPreviewHeight) {\n          root.dispatch('DID_UPDATE_PANEL_HEIGHT', {\n            id: item.id,\n            height: fixedPreviewHeight\n          });\n        }\n\n        // now ready\n        var queue = !supportsCreateImageBitmap && file.size > query('GET_IMAGE_PREVIEW_MAX_INSTANT_PREVIEW_FILE_SIZE');\n        root.dispatch('DID_IMAGE_PREVIEW_CONTAINER_CREATE', {\n          id: id\n        }, queue);\n      };\n      var rescaleItem = function rescaleItem(root, props) {\n        if (!root.ref.imagePreview) return;\n        var id = props.id;\n\n        // get item\n        var item = root.query('GET_ITEM', {\n          id: id\n        });\n        if (!item) return;\n\n        // if is fixed height or panel has aspect ratio, exit here, height has already been defined\n        var panelAspectRatio = root.query('GET_PANEL_ASPECT_RATIO');\n        var itemPanelAspectRatio = root.query('GET_ITEM_PANEL_ASPECT_RATIO');\n        var fixedHeight = root.query('GET_IMAGE_PREVIEW_HEIGHT');\n        if (panelAspectRatio || itemPanelAspectRatio || fixedHeight) return;\n\n        // no data!\n        var _root$ref = root.ref,\n          imageWidth = _root$ref.imageWidth,\n          imageHeight = _root$ref.imageHeight;\n        if (!imageWidth || !imageHeight) return;\n\n        // get height min and max\n        var minPreviewHeight = root.query('GET_IMAGE_PREVIEW_MIN_HEIGHT');\n        var maxPreviewHeight = root.query('GET_IMAGE_PREVIEW_MAX_HEIGHT');\n\n        // orientation info\n        var exif = item.getMetadata('exif') || {};\n        var orientation = exif.orientation || -1;\n\n        // get width and height from action, and swap of orientation is incorrect\n        if (orientation >= 5 && orientation <= 8) {\n          var _ref2 = [imageHeight, imageWidth];\n          imageWidth = _ref2[0];\n          imageHeight = _ref2[1];\n        }\n\n        // scale up width and height when we're dealing with an SVG\n        if (!isBitmap(item.file) || root.query('GET_IMAGE_PREVIEW_UPSCALE')) {\n          var scalar = 2048 / imageWidth;\n          imageWidth *= scalar;\n          imageHeight *= scalar;\n        }\n\n        // image aspect ratio\n        var imageAspectRatio = imageHeight / imageWidth;\n\n        // we need the item to get to the crop size\n        var previewAspectRatio = (item.getMetadata('crop') || {}).aspectRatio || imageAspectRatio;\n\n        // preview height range\n        var previewHeightMax = Math.max(minPreviewHeight, Math.min(imageHeight, maxPreviewHeight));\n        var itemWidth = root.rect.element.width;\n        var previewHeight = Math.min(itemWidth * previewAspectRatio, previewHeightMax);\n\n        // request update to panel height\n        root.dispatch('DID_UPDATE_PANEL_HEIGHT', {\n          id: item.id,\n          height: previewHeight\n        });\n      };\n      var didResizeView = function didResizeView(_ref3) {\n        var root = _ref3.root;\n        // actions in next write operation\n        root.ref.shouldRescale = true;\n      };\n      var didUpdateItemMetadata = function didUpdateItemMetadata(_ref4) {\n        var root = _ref4.root,\n          action = _ref4.action;\n        if (action.change.key !== 'crop') return;\n\n        // actions in next write operation\n        root.ref.shouldRescale = true;\n      };\n      var didCalculatePreviewSize = function didCalculatePreviewSize(_ref5) {\n        var root = _ref5.root,\n          action = _ref5.action;\n        // remember dimensions\n        root.ref.imageWidth = action.width;\n        root.ref.imageHeight = action.height;\n\n        // actions in next write operation\n        root.ref.shouldRescale = true;\n        root.ref.shouldDrawPreview = true;\n\n        // as image load could take a while and fire when draw loop is resting we need to give it a kick\n        root.dispatch('KICK');\n      };\n\n      // start writing\n      view.registerWriter(createRoute({\n        DID_RESIZE_ROOT: didResizeView,\n        DID_STOP_RESIZE: didResizeView,\n        DID_LOAD_ITEM: didLoadItem,\n        DID_IMAGE_PREVIEW_CALCULATE_SIZE: didCalculatePreviewSize,\n        DID_UPDATE_ITEM_METADATA: didUpdateItemMetadata\n      }, function (_ref6) {\n        var root = _ref6.root,\n          props = _ref6.props;\n        // no preview view attached\n        if (!root.ref.imagePreview) return;\n\n        // don't do anything while hidden\n        if (root.rect.element.hidden) return;\n\n        // resize the item panel\n        if (root.ref.shouldRescale) {\n          rescaleItem(root, props);\n          root.ref.shouldRescale = false;\n        }\n        if (root.ref.shouldDrawPreview) {\n          // queue till next frame so we're sure the height has been applied this forces the draw image call inside the wrapper view to use the correct height\n          requestAnimationFrame(function () {\n            // this requestAnimationFrame nesting is horrible but it fixes an issue with 100hz displays on Chrome\n            // https://github.com/pqina/filepond-plugin-image-preview/issues/57\n            requestAnimationFrame(function () {\n              root.dispatch('DID_FINISH_CALCULATE_PREVIEWSIZE', {\n                id: props.id\n              });\n            });\n          });\n          root.ref.shouldDrawPreview = false;\n        }\n      }));\n    });\n\n    // expose plugin\n    return {\n      options: {\n        // Enable or disable image preview\n        allowImagePreview: [true, Type.BOOLEAN],\n        // filters file items to determine which are shown as preview\n        imagePreviewFilterItem: [function () {\n          return true;\n        }, Type.FUNCTION],\n        // Fixed preview height\n        imagePreviewHeight: [null, Type.INT],\n        // Min image height\n        imagePreviewMinHeight: [44, Type.INT],\n        // Max image height\n        imagePreviewMaxHeight: [256, Type.INT],\n        // Max size of preview file for when createImageBitmap is not supported\n        imagePreviewMaxFileSize: [null, Type.INT],\n        // The amount of extra pixels added to the image preview to allow comfortable zooming\n        imagePreviewZoomFactor: [2, Type.INT],\n        // Should we upscale small images to fit the max bounding box of the preview area\n        imagePreviewUpscale: [false, Type.BOOLEAN],\n        // Max size of preview file that we allow to try to instant preview if createImageBitmap is not supported, else image is queued for loading\n        imagePreviewMaxInstantPreviewFileSize: [1000000, Type.INT],\n        // Style of the transparancy indicator used behind images\n        imagePreviewTransparencyIndicator: [null, Type.STRING],\n        // Enables or disables reading average image color\n        imagePreviewCalculateAverageImageColor: [false, Type.BOOLEAN],\n        // Enables or disables the previewing of markup\n        imagePreviewMarkupShow: [true, Type.BOOLEAN],\n        // Allows filtering of markup to only show certain shapes\n        imagePreviewMarkupFilter: [function () {\n          return true;\n        }, Type.FUNCTION]\n      }\n    };\n  };\n\n  // fire pluginloaded event if running in browser, this allows registering the plugin when using async script tags\n  var isBrowser = typeof window !== 'undefined' && typeof window.document !== 'undefined';\n  if (isBrowser) {\n    document.dispatchEvent(new CustomEvent('FilePond:pluginloaded', {\n      detail: plugin\n    }));\n  }\n  return plugin;\n});","map":{"version":3,"names":["global","factory","exports","module","define","amd","self","FilePondPluginImagePreview","isPreviewableImage","file","test","type","_typeof","obj","Symbol","iterator","constructor","prototype","REACT_ELEMENT_TYPE","_jsx","props","key","children","for","defaultProps","childrenLength","arguments","length","propName","childArray","Array","i","$$typeof","undefined","ref","_owner","_asyncIterator","iterable","method","asyncIterator","call","TypeError","_AwaitValue","value","wrapped","_AsyncGenerator","gen","front","back","send","arg","Promise","resolve","reject","request","next","resume","result","wrappedAwait","then","settle","done","err","_invoke","return","throw","_wrapAsyncGenerator","fn","apply","_awaitAsyncGenerator","_asyncGeneratorDelegate","inner","awaitWrap","iter","waiting","pump","asyncGeneratorStep","_next","_throw","info","error","_asyncToGenerator","args","_classCallCheck","instance","Constructor","_defineProperties","target","descriptor","enumerable","configurable","writable","Object","defineProperty","_createClass","protoProps","staticProps","_defineEnumerableProperties","descs","desc","getOwnPropertySymbols","objectSymbols","sym","_defaults","defaults","keys","getOwnPropertyNames","getOwnPropertyDescriptor","_defineProperty","_extends","assign","source","hasOwnProperty","_objectSpread","ownKeys","concat","filter","forEach","_inherits","subClass","superClass","create","_setPrototypeOf","_inheritsLoose","__proto__","_getPrototypeOf","o","setPrototypeOf","getPrototypeOf","p","isNativeReflectConstruct","Reflect","construct","sham","Proxy","Date","toString","e","_construct","Parent","Class","a","push","Function","bind","_isNativeFunction","indexOf","_wrapNativeSuper","_cache","Map","has","get","set","Wrapper","_instanceof","left","right","hasInstance","_interopRequireDefault","__esModule","default","_interopRequireWildcard","newObj","_newArrowCheck","innerThis","boundThis","_objectDestructuringEmpty","_objectWithoutPropertiesLoose","excluded","sourceKeys","_objectWithoutProperties","sourceSymbolKeys","propertyIsEnumerable","_assertThisInitialized","ReferenceError","_possibleConstructorReturn","_superPropBase","object","property","_get","receiver","base","_set","isStrict","s","Error","_taggedTemplateLiteral","strings","raw","slice","freeze","defineProperties","_taggedTemplateLiteralLoose","_temporalRef","val","name","_temporalUndefined","_readOnlyError","_classNameTDZError","_slicedToArray","arr","_arrayWithHoles","_iterableToArrayLimit","_nonIterableRest","_slicedToArrayLoose","_iterableToArrayLimitLoose","_toArray","_iterableToArray","_toConsumableArray","_arrayWithoutHoles","_nonIterableSpread","isArray","arr2","from","_arr","_n","_d","_e","_i","_s","_iterator","_step","_skipFirstGeneratorNext","it","_toPrimitive","input","hint","prim","toPrimitive","res","String","Number","_toPropertyKey","_initializerWarningHelper","context","_initializerDefineProperty","initializer","_applyDecoratedDescriptor","decorators","reverse","reduce","decorator","id","_classPrivateFieldLooseKey","_classPrivateFieldLooseBase","privateKey","_classPrivateFieldGet","privateMap","_classPrivateFieldSet","_classStaticPrivateFieldSpecGet","classConstructor","_classStaticPrivateFieldSpecSet","_classStaticPrivateMethodGet","_classStaticPrivateMethodSet","_decorate","mixins","api","_getDecoratorsApi","r","initialize","O","initializeInstanceElements","decorated","elements","decorateClass","_coalesceClassElements","d","map","_createElementDescriptor","initializeClassElements","F","runClassFinishers","finishers","elementsDefinitionOrder","kind","element","placement","defineClassElement","proto","newElements","placements","static","own","addElementPlacement","_hasDecorators","elementFinishersExtras","decorateElement","extras","decorateConstructor","silent","splice","elementObject","fromElementDescriptor","elementFinisherExtras","toElementFinisherExtras","finisher","newExtras","j","fromClassDescriptor","elementsAndFinisher","toClassDescriptor","k","toStringTag","toElementDescriptors","elementObjects","toElementDescriptor","disallowProperty","_optionalCallableProperty","newConstructor","objectType","def","_coalesceGetterSetter","other","isSameElement","find","_isDataDescriptor","_classPrivateMethodGet","privateSet","_classPrivateMethodSet","_wrapRegExp","re","groups","BabelRegExp","_RegExp","RegExp","_super","_groups","WeakMap","_this","exec","str","buildGroups","replace","substitution","_","g","vectorMultiply","v","amount","createVector","x","y","vectorAdd","b","vectorNormalize","l","Math","sqrt","vectorRotate","radians","origin","cos","sin","t","getMarkupValue","size","scalar","axis","parseFloat","min","width","height","getMarkupStyles","markup","scale","lineStyle","borderStyle","fill","backgroundColor","fontColor","stroke","borderColor","lineColor","strokeWidth","borderWidth","lineWidth","lineCap","lineJoin","dashes","join","opacity","isDefined","getMarkupRect","rect","top","bottom","pointsToPathShape","points","point","index","setAttributes","attr","setAttribute","ns","svg","tag","document","createElementNS","updateRect","styles","updateEllipse","cx","cy","rx","ry","IMAGE_FIT_STYLE","contain","cover","updateImage","preserveAspectRatio","fit","TEXT_ANCHOR","center","updateText","fontSize","fontFamily","fontWeight","textAlign","text","textContent","updateLine","line","childNodes","begin","end","x1","y1","x2","y2","lineDecoration","style","display","arrowBeginRotationPoint","arrowBeginCenter","arrowBeginA","arrowBeginB","arrowEndRotationPoint","arrowEndCenter","arrowEndA","arrowEndB","updatePath","createShape","node","createImage","shape","onload","setAttributeNS","src","createLine","appendChild","CREATE_TYPE_ROUTES","image","ellipse","path","UPDATE_TYPE_ROUTES","createMarkupByType","updateMarkupByType","MARKUP_RECT","toOptionalFraction","prepareMarkup","_markup","prev","curr","zIndex","sortMarkupByZIndex","createMarkupView","utils","createView","ignoreRect","apis","write","_ref","root","dirty","crop","resize","viewWidth","viewHeight","cropWidth","cropHeight","_size","outputWidth","outputHeight","outputFit","mode","outputUpscale","upscale","shouldUpscale","scalarWidth","scalarHeight","max","innerHTML","markupFilter","query","sort","settings","createVector$1","vectorDot","vectorSubtract","vectorDistanceSquared","vectorDistance","getOffsetPointOnEdge","rotation","A","B","C","sinA","sinB","sinC","cosC","ratio","c","getRotatedRectSize","w","h","hor","ver","tl","abs","tr","bl","calculateCanvasSize","canvasAspectRatio","zoom","imageAspectRatio","canvasWidth","canvasHeight","imgWidth","imgHeight","getImageRectZoomFactor","imageRect","cropRect","imageWidth","imageHeight","rotatedCropSize","getCenteredCropRect","container","aspectRatio","getCurrentCropSize","imageSize","canvasSize","canvasCenter","stage","shouldLimit","scaleToFit","stageZoomFactor","widthFloat","heightFloat","round","IMAGE_SCALE_SPRING_PROPS","stiffness","damping","mass","createBitmapView","createImageCanvasWrapper","animations","originX","originY","scaleX","scaleY","translateX","translateY","rotateZ","_ref2","bitmap","appendChildView","createChildView","_ref3","flip","horizontal","vertical","createClipView","duration","didWriteView","_ref4","background","_ref5","createMarkup","destroyMarkup","removeChildView","transparencyIndicator","dataset","_ref6","shouldOptimize","translation","PI","cropAspectRatio","imageView","createImageView","_ref7","clip","_ref8","hidden","containerWidth","containerHeight","fixedPreviewHeight","minPreviewHeight","maxPreviewHeight","panelAspectRatio","allowMultiple","clipHeight","clipWidth","SVG_MASK","SVGMaskUniqueId","createImageOverlayView","fpAPI","mask","querySelector","url","URL","window","location","href","hash","classList","add","status","BitmapWorker","onmessage","createImageBitmap","data","message","postMessage","ColorMatrixWorker","imageData","matrix","colorMatrix","m11","m12","m13","m14","m15","m21","m22","m23","m24","m25","m31","m32","m33","m34","m35","m41","m42","m43","m44","m45","buffer","getImageSize","cb","Image","naturalWidth","naturalHeight","transforms","fixImageOrientation","ctx","orientation","transform","createPreviewImage","canvas","createElement","getContext","drawImage","isBitmap","MAX_WIDTH","MAX_HEIGHT","calculateAverageColor","ceil","getImageData","averageColor","floor","cloneCanvas","cloneImageData","ImageData","createImageData","Uint8ClampedArray","loadImage","img","crossOrigin","onerror","createImageWrapperView","OverlayView","ImageView","createWorker","applyFilter","putImageData","worker","post","response","terminate","removeImageView","_destroy","shiftImage","images","shift","imageViewBin","pushImage","item","getMetadata","childViews","setTimeout","dispatch","didUpdateItemMetadata","action","change","_imageView","canCreateImageBitmap","userAgent","navigator","isFirefox","match","firefoxVersion","parseInt","didCreatePreviewContainer","fileURL","createObjectURL","drawPreview","loadPreviewFallback","previewImageLoaded","revokeObjectURL","exif","pixelDensityFactor","devicePixelRatio","zoomFactor","scaleFactor","previewImageRatio","previewContainerWidth","previewContainerHeight","previewImage","setMetadata","close","overlayShadow","imageBitmap","didDrawPreview","restoreOverlay","_ref9","overlayError","overlaySuccess","didThrowError","_ref10","didCompleteProcessing","_ref11","_ref12","destroy","_ref13","_ref14","createRoute","DID_IMAGE_PREVIEW_DRAW","DID_IMAGE_PREVIEW_CONTAINER_CREATE","DID_FINISH_CALCULATE_PREVIEWSIZE","DID_UPDATE_ITEM_METADATA","DID_THROW_ITEM_LOAD_ERROR","DID_THROW_ITEM_PROCESSING_ERROR","DID_THROW_ITEM_INVALID","DID_COMPLETE_ITEM_PROCESSING","DID_START_ITEM_PROCESSING","DID_REVERT_ITEM_PROCESSING","_ref15","viewsToRemove","plugin","addFilter","Type","isFile","imagePreviewView","viewAPI","is","view","didLoadItem","archived","supportsCreateImageBitmap","maxPreviewFileSize","imagePreview","queue","rescaleItem","itemPanelAspectRatio","fixedHeight","_root$ref","previewAspectRatio","previewHeightMax","itemWidth","previewHeight","didResizeView","shouldRescale","didCalculatePreviewSize","shouldDrawPreview","registerWriter","DID_RESIZE_ROOT","DID_STOP_RESIZE","DID_LOAD_ITEM","DID_IMAGE_PREVIEW_CALCULATE_SIZE","requestAnimationFrame","options","allowImagePreview","BOOLEAN","imagePreviewFilterItem","FUNCTION","imagePreviewHeight","INT","imagePreviewMinHeight","imagePreviewMaxHeight","imagePreviewMaxFileSize","imagePreviewZoomFactor","imagePreviewUpscale","imagePreviewMaxInstantPreviewFileSize","imagePreviewTransparencyIndicator","STRING","imagePreviewCalculateAverageImageColor","imagePreviewMarkupShow","imagePreviewMarkupFilter","isBrowser","dispatchEvent","CustomEvent","detail"],"sources":["/Users/marija/Documents/GitHub/marija_cv_website/node_modules/filepond-plugin-image-preview/dist/filepond-plugin-image-preview.js"],"sourcesContent":["/*!\n * FilePondPluginImagePreview 4.6.11\n * Licensed under MIT, https://opensource.org/licenses/MIT/\n * Please visit https://pqina.nl/filepond/ for details.\n */\n\n/* eslint-disable */\n\n(function(global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined'\n    ? (module.exports = factory())\n    : typeof define === 'function' && define.amd\n    ? define(factory)\n    : ((global = global || self),\n      (global.FilePondPluginImagePreview = factory()));\n})(this, function() {\n  'use strict';\n\n  // test if file is of type image and can be viewed in canvas\n  var isPreviewableImage = function isPreviewableImage(file) {\n    return /^image/.test(file.type);\n  };\n\n  function _typeof(obj) {\n    if (typeof Symbol === 'function' && typeof Symbol.iterator === 'symbol') {\n      _typeof = function(obj) {\n        return typeof obj;\n      };\n    } else {\n      _typeof = function(obj) {\n        return obj &&\n          typeof Symbol === 'function' &&\n          obj.constructor === Symbol &&\n          obj !== Symbol.prototype\n          ? 'symbol'\n          : typeof obj;\n      };\n    }\n\n    return _typeof(obj);\n  }\n\n  var REACT_ELEMENT_TYPE;\n\n  function _jsx(type, props, key, children) {\n    if (!REACT_ELEMENT_TYPE) {\n      REACT_ELEMENT_TYPE =\n        (typeof Symbol === 'function' &&\n          Symbol.for &&\n          Symbol.for('react.element')) ||\n        0xeac7;\n    }\n\n    var defaultProps = type && type.defaultProps;\n    var childrenLength = arguments.length - 3;\n\n    if (!props && childrenLength !== 0) {\n      props = {\n        children: void 0\n      };\n    }\n\n    if (props && defaultProps) {\n      for (var propName in defaultProps) {\n        if (props[propName] === void 0) {\n          props[propName] = defaultProps[propName];\n        }\n      }\n    } else if (!props) {\n      props = defaultProps || {};\n    }\n\n    if (childrenLength === 1) {\n      props.children = children;\n    } else if (childrenLength > 1) {\n      var childArray = new Array(childrenLength);\n\n      for (var i = 0; i < childrenLength; i++) {\n        childArray[i] = arguments[i + 3];\n      }\n\n      props.children = childArray;\n    }\n\n    return {\n      $$typeof: REACT_ELEMENT_TYPE,\n      type: type,\n      key: key === undefined ? null : '' + key,\n      ref: null,\n      props: props,\n      _owner: null\n    };\n  }\n\n  function _asyncIterator(iterable) {\n    var method;\n\n    if (typeof Symbol === 'function') {\n      if (Symbol.asyncIterator) {\n        method = iterable[Symbol.asyncIterator];\n        if (method != null) return method.call(iterable);\n      }\n\n      if (Symbol.iterator) {\n        method = iterable[Symbol.iterator];\n        if (method != null) return method.call(iterable);\n      }\n    }\n\n    throw new TypeError('Object is not async iterable');\n  }\n\n  function _AwaitValue(value) {\n    this.wrapped = value;\n  }\n\n  function _AsyncGenerator(gen) {\n    var front, back;\n\n    function send(key, arg) {\n      return new Promise(function(resolve, reject) {\n        var request = {\n          key: key,\n          arg: arg,\n          resolve: resolve,\n          reject: reject,\n          next: null\n        };\n\n        if (back) {\n          back = back.next = request;\n        } else {\n          front = back = request;\n          resume(key, arg);\n        }\n      });\n    }\n\n    function resume(key, arg) {\n      try {\n        var result = gen[key](arg);\n        var value = result.value;\n        var wrappedAwait = value instanceof _AwaitValue;\n        Promise.resolve(wrappedAwait ? value.wrapped : value).then(\n          function(arg) {\n            if (wrappedAwait) {\n              resume('next', arg);\n              return;\n            }\n\n            settle(result.done ? 'return' : 'normal', arg);\n          },\n          function(err) {\n            resume('throw', err);\n          }\n        );\n      } catch (err) {\n        settle('throw', err);\n      }\n    }\n\n    function settle(type, value) {\n      switch (type) {\n        case 'return':\n          front.resolve({\n            value: value,\n            done: true\n          });\n          break;\n\n        case 'throw':\n          front.reject(value);\n          break;\n\n        default:\n          front.resolve({\n            value: value,\n            done: false\n          });\n          break;\n      }\n\n      front = front.next;\n\n      if (front) {\n        resume(front.key, front.arg);\n      } else {\n        back = null;\n      }\n    }\n\n    this._invoke = send;\n\n    if (typeof gen.return !== 'function') {\n      this.return = undefined;\n    }\n  }\n\n  if (typeof Symbol === 'function' && Symbol.asyncIterator) {\n    _AsyncGenerator.prototype[Symbol.asyncIterator] = function() {\n      return this;\n    };\n  }\n\n  _AsyncGenerator.prototype.next = function(arg) {\n    return this._invoke('next', arg);\n  };\n\n  _AsyncGenerator.prototype.throw = function(arg) {\n    return this._invoke('throw', arg);\n  };\n\n  _AsyncGenerator.prototype.return = function(arg) {\n    return this._invoke('return', arg);\n  };\n\n  function _wrapAsyncGenerator(fn) {\n    return function() {\n      return new _AsyncGenerator(fn.apply(this, arguments));\n    };\n  }\n\n  function _awaitAsyncGenerator(value) {\n    return new _AwaitValue(value);\n  }\n\n  function _asyncGeneratorDelegate(inner, awaitWrap) {\n    var iter = {},\n      waiting = false;\n\n    function pump(key, value) {\n      waiting = true;\n      value = new Promise(function(resolve) {\n        resolve(inner[key](value));\n      });\n      return {\n        done: false,\n        value: awaitWrap(value)\n      };\n    }\n\n    if (typeof Symbol === 'function' && Symbol.iterator) {\n      iter[Symbol.iterator] = function() {\n        return this;\n      };\n    }\n\n    iter.next = function(value) {\n      if (waiting) {\n        waiting = false;\n        return value;\n      }\n\n      return pump('next', value);\n    };\n\n    if (typeof inner.throw === 'function') {\n      iter.throw = function(value) {\n        if (waiting) {\n          waiting = false;\n          throw value;\n        }\n\n        return pump('throw', value);\n      };\n    }\n\n    if (typeof inner.return === 'function') {\n      iter.return = function(value) {\n        return pump('return', value);\n      };\n    }\n\n    return iter;\n  }\n\n  function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n    try {\n      var info = gen[key](arg);\n      var value = info.value;\n    } catch (error) {\n      reject(error);\n      return;\n    }\n\n    if (info.done) {\n      resolve(value);\n    } else {\n      Promise.resolve(value).then(_next, _throw);\n    }\n  }\n\n  function _asyncToGenerator(fn) {\n    return function() {\n      var self = this,\n        args = arguments;\n      return new Promise(function(resolve, reject) {\n        var gen = fn.apply(self, args);\n\n        function _next(value) {\n          asyncGeneratorStep(\n            gen,\n            resolve,\n            reject,\n            _next,\n            _throw,\n            'next',\n            value\n          );\n        }\n\n        function _throw(err) {\n          asyncGeneratorStep(gen, resolve, reject, _next, _throw, 'throw', err);\n        }\n\n        _next(undefined);\n      });\n    };\n  }\n\n  function _classCallCheck(instance, Constructor) {\n    if (!(instance instanceof Constructor)) {\n      throw new TypeError('Cannot call a class as a function');\n    }\n  }\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if ('value' in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  function _createClass(Constructor, protoProps, staticProps) {\n    if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) _defineProperties(Constructor, staticProps);\n    return Constructor;\n  }\n\n  function _defineEnumerableProperties(obj, descs) {\n    for (var key in descs) {\n      var desc = descs[key];\n      desc.configurable = desc.enumerable = true;\n      if ('value' in desc) desc.writable = true;\n      Object.defineProperty(obj, key, desc);\n    }\n\n    if (Object.getOwnPropertySymbols) {\n      var objectSymbols = Object.getOwnPropertySymbols(descs);\n\n      for (var i = 0; i < objectSymbols.length; i++) {\n        var sym = objectSymbols[i];\n        var desc = descs[sym];\n        desc.configurable = desc.enumerable = true;\n        if ('value' in desc) desc.writable = true;\n        Object.defineProperty(obj, sym, desc);\n      }\n    }\n\n    return obj;\n  }\n\n  function _defaults(obj, defaults) {\n    var keys = Object.getOwnPropertyNames(defaults);\n\n    for (var i = 0; i < keys.length; i++) {\n      var key = keys[i];\n      var value = Object.getOwnPropertyDescriptor(defaults, key);\n\n      if (value && value.configurable && obj[key] === undefined) {\n        Object.defineProperty(obj, key, value);\n      }\n    }\n\n    return obj;\n  }\n\n  function _defineProperty(obj, key, value) {\n    if (key in obj) {\n      Object.defineProperty(obj, key, {\n        value: value,\n        enumerable: true,\n        configurable: true,\n        writable: true\n      });\n    } else {\n      obj[key] = value;\n    }\n\n    return obj;\n  }\n\n  function _extends() {\n    _extends =\n      Object.assign ||\n      function(target) {\n        for (var i = 1; i < arguments.length; i++) {\n          var source = arguments[i];\n\n          for (var key in source) {\n            if (Object.prototype.hasOwnProperty.call(source, key)) {\n              target[key] = source[key];\n            }\n          }\n        }\n\n        return target;\n      };\n\n    return _extends.apply(this, arguments);\n  }\n\n  function _objectSpread(target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i] != null ? arguments[i] : {};\n      var ownKeys = Object.keys(source);\n\n      if (typeof Object.getOwnPropertySymbols === 'function') {\n        ownKeys = ownKeys.concat(\n          Object.getOwnPropertySymbols(source).filter(function(sym) {\n            return Object.getOwnPropertyDescriptor(source, sym).enumerable;\n          })\n        );\n      }\n\n      ownKeys.forEach(function(key) {\n        _defineProperty(target, key, source[key]);\n      });\n    }\n\n    return target;\n  }\n\n  function _inherits(subClass, superClass) {\n    if (typeof superClass !== 'function' && superClass !== null) {\n      throw new TypeError('Super expression must either be null or a function');\n    }\n\n    subClass.prototype = Object.create(superClass && superClass.prototype, {\n      constructor: {\n        value: subClass,\n        writable: true,\n        configurable: true\n      }\n    });\n    if (superClass) _setPrototypeOf(subClass, superClass);\n  }\n\n  function _inheritsLoose(subClass, superClass) {\n    subClass.prototype = Object.create(superClass.prototype);\n    subClass.prototype.constructor = subClass;\n    subClass.__proto__ = superClass;\n  }\n\n  function _getPrototypeOf(o) {\n    _getPrototypeOf = Object.setPrototypeOf\n      ? Object.getPrototypeOf\n      : function _getPrototypeOf(o) {\n          return o.__proto__ || Object.getPrototypeOf(o);\n        };\n    return _getPrototypeOf(o);\n  }\n\n  function _setPrototypeOf(o, p) {\n    _setPrototypeOf =\n      Object.setPrototypeOf ||\n      function _setPrototypeOf(o, p) {\n        o.__proto__ = p;\n        return o;\n      };\n\n    return _setPrototypeOf(o, p);\n  }\n\n  function isNativeReflectConstruct() {\n    if (typeof Reflect === 'undefined' || !Reflect.construct) return false;\n    if (Reflect.construct.sham) return false;\n    if (typeof Proxy === 'function') return true;\n\n    try {\n      Date.prototype.toString.call(Reflect.construct(Date, [], function() {}));\n      return true;\n    } catch (e) {\n      return false;\n    }\n  }\n\n  function _construct(Parent, args, Class) {\n    if (isNativeReflectConstruct()) {\n      _construct = Reflect.construct;\n    } else {\n      _construct = function _construct(Parent, args, Class) {\n        var a = [null];\n        a.push.apply(a, args);\n        var Constructor = Function.bind.apply(Parent, a);\n        var instance = new Constructor();\n        if (Class) _setPrototypeOf(instance, Class.prototype);\n        return instance;\n      };\n    }\n\n    return _construct.apply(null, arguments);\n  }\n\n  function _isNativeFunction(fn) {\n    return Function.toString.call(fn).indexOf('[native code]') !== -1;\n  }\n\n  function _wrapNativeSuper(Class) {\n    var _cache = typeof Map === 'function' ? new Map() : undefined;\n\n    _wrapNativeSuper = function _wrapNativeSuper(Class) {\n      if (Class === null || !_isNativeFunction(Class)) return Class;\n\n      if (typeof Class !== 'function') {\n        throw new TypeError(\n          'Super expression must either be null or a function'\n        );\n      }\n\n      if (typeof _cache !== 'undefined') {\n        if (_cache.has(Class)) return _cache.get(Class);\n\n        _cache.set(Class, Wrapper);\n      }\n\n      function Wrapper() {\n        return _construct(Class, arguments, _getPrototypeOf(this).constructor);\n      }\n\n      Wrapper.prototype = Object.create(Class.prototype, {\n        constructor: {\n          value: Wrapper,\n          enumerable: false,\n          writable: true,\n          configurable: true\n        }\n      });\n      return _setPrototypeOf(Wrapper, Class);\n    };\n\n    return _wrapNativeSuper(Class);\n  }\n\n  function _instanceof(left, right) {\n    if (\n      right != null &&\n      typeof Symbol !== 'undefined' &&\n      right[Symbol.hasInstance]\n    ) {\n      return right[Symbol.hasInstance](left);\n    } else {\n      return left instanceof right;\n    }\n  }\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule\n      ? obj\n      : {\n          default: obj\n        };\n  }\n\n  function _interopRequireWildcard(obj) {\n    if (obj && obj.__esModule) {\n      return obj;\n    } else {\n      var newObj = {};\n\n      if (obj != null) {\n        for (var key in obj) {\n          if (Object.prototype.hasOwnProperty.call(obj, key)) {\n            var desc =\n              Object.defineProperty && Object.getOwnPropertyDescriptor\n                ? Object.getOwnPropertyDescriptor(obj, key)\n                : {};\n\n            if (desc.get || desc.set) {\n              Object.defineProperty(newObj, key, desc);\n            } else {\n              newObj[key] = obj[key];\n            }\n          }\n        }\n      }\n\n      newObj.default = obj;\n      return newObj;\n    }\n  }\n\n  function _newArrowCheck(innerThis, boundThis) {\n    if (innerThis !== boundThis) {\n      throw new TypeError('Cannot instantiate an arrow function');\n    }\n  }\n\n  function _objectDestructuringEmpty(obj) {\n    if (obj == null) throw new TypeError('Cannot destructure undefined');\n  }\n\n  function _objectWithoutPropertiesLoose(source, excluded) {\n    if (source == null) return {};\n    var target = {};\n    var sourceKeys = Object.keys(source);\n    var key, i;\n\n    for (i = 0; i < sourceKeys.length; i++) {\n      key = sourceKeys[i];\n      if (excluded.indexOf(key) >= 0) continue;\n      target[key] = source[key];\n    }\n\n    return target;\n  }\n\n  function _objectWithoutProperties(source, excluded) {\n    if (source == null) return {};\n\n    var target = _objectWithoutPropertiesLoose(source, excluded);\n\n    var key, i;\n\n    if (Object.getOwnPropertySymbols) {\n      var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n\n      for (i = 0; i < sourceSymbolKeys.length; i++) {\n        key = sourceSymbolKeys[i];\n        if (excluded.indexOf(key) >= 0) continue;\n        if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n        target[key] = source[key];\n      }\n    }\n\n    return target;\n  }\n\n  function _assertThisInitialized(self) {\n    if (self === void 0) {\n      throw new ReferenceError(\n        \"this hasn't been initialised - super() hasn't been called\"\n      );\n    }\n\n    return self;\n  }\n\n  function _possibleConstructorReturn(self, call) {\n    if (call && (typeof call === 'object' || typeof call === 'function')) {\n      return call;\n    }\n\n    return _assertThisInitialized(self);\n  }\n\n  function _superPropBase(object, property) {\n    while (!Object.prototype.hasOwnProperty.call(object, property)) {\n      object = _getPrototypeOf(object);\n      if (object === null) break;\n    }\n\n    return object;\n  }\n\n  function _get(target, property, receiver) {\n    if (typeof Reflect !== 'undefined' && Reflect.get) {\n      _get = Reflect.get;\n    } else {\n      _get = function _get(target, property, receiver) {\n        var base = _superPropBase(target, property);\n\n        if (!base) return;\n        var desc = Object.getOwnPropertyDescriptor(base, property);\n\n        if (desc.get) {\n          return desc.get.call(receiver);\n        }\n\n        return desc.value;\n      };\n    }\n\n    return _get(target, property, receiver || target);\n  }\n\n  function set(target, property, value, receiver) {\n    if (typeof Reflect !== 'undefined' && Reflect.set) {\n      set = Reflect.set;\n    } else {\n      set = function set(target, property, value, receiver) {\n        var base = _superPropBase(target, property);\n\n        var desc;\n\n        if (base) {\n          desc = Object.getOwnPropertyDescriptor(base, property);\n\n          if (desc.set) {\n            desc.set.call(receiver, value);\n            return true;\n          } else if (!desc.writable) {\n            return false;\n          }\n        }\n\n        desc = Object.getOwnPropertyDescriptor(receiver, property);\n\n        if (desc) {\n          if (!desc.writable) {\n            return false;\n          }\n\n          desc.value = value;\n          Object.defineProperty(receiver, property, desc);\n        } else {\n          _defineProperty(receiver, property, value);\n        }\n\n        return true;\n      };\n    }\n\n    return set(target, property, value, receiver);\n  }\n\n  function _set(target, property, value, receiver, isStrict) {\n    var s = set(target, property, value, receiver || target);\n\n    if (!s && isStrict) {\n      throw new Error('failed to set property');\n    }\n\n    return value;\n  }\n\n  function _taggedTemplateLiteral(strings, raw) {\n    if (!raw) {\n      raw = strings.slice(0);\n    }\n\n    return Object.freeze(\n      Object.defineProperties(strings, {\n        raw: {\n          value: Object.freeze(raw)\n        }\n      })\n    );\n  }\n\n  function _taggedTemplateLiteralLoose(strings, raw) {\n    if (!raw) {\n      raw = strings.slice(0);\n    }\n\n    strings.raw = raw;\n    return strings;\n  }\n\n  function _temporalRef(val, name) {\n    if (val === _temporalUndefined) {\n      throw new ReferenceError(name + ' is not defined - temporal dead zone');\n    } else {\n      return val;\n    }\n  }\n\n  function _readOnlyError(name) {\n    throw new Error('\"' + name + '\" is read-only');\n  }\n\n  function _classNameTDZError(name) {\n    throw new Error(\n      'Class \"' + name + '\" cannot be referenced in computed property keys.'\n    );\n  }\n\n  var _temporalUndefined = {};\n\n  function _slicedToArray(arr, i) {\n    return (\n      _arrayWithHoles(arr) ||\n      _iterableToArrayLimit(arr, i) ||\n      _nonIterableRest()\n    );\n  }\n\n  function _slicedToArrayLoose(arr, i) {\n    return (\n      _arrayWithHoles(arr) ||\n      _iterableToArrayLimitLoose(arr, i) ||\n      _nonIterableRest()\n    );\n  }\n\n  function _toArray(arr) {\n    return _arrayWithHoles(arr) || _iterableToArray(arr) || _nonIterableRest();\n  }\n\n  function _toConsumableArray(arr) {\n    return (\n      _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread()\n    );\n  }\n\n  function _arrayWithoutHoles(arr) {\n    if (Array.isArray(arr)) {\n      for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++)\n        arr2[i] = arr[i];\n\n      return arr2;\n    }\n  }\n\n  function _arrayWithHoles(arr) {\n    if (Array.isArray(arr)) return arr;\n  }\n\n  function _iterableToArray(iter) {\n    if (\n      Symbol.iterator in Object(iter) ||\n      Object.prototype.toString.call(iter) === '[object Arguments]'\n    )\n      return Array.from(iter);\n  }\n\n  function _iterableToArrayLimit(arr, i) {\n    var _arr = [];\n    var _n = true;\n    var _d = false;\n    var _e = undefined;\n\n    try {\n      for (\n        var _i = arr[Symbol.iterator](), _s;\n        !(_n = (_s = _i.next()).done);\n        _n = true\n      ) {\n        _arr.push(_s.value);\n\n        if (i && _arr.length === i) break;\n      }\n    } catch (err) {\n      _d = true;\n      _e = err;\n    } finally {\n      try {\n        if (!_n && _i['return'] != null) _i['return']();\n      } finally {\n        if (_d) throw _e;\n      }\n    }\n\n    return _arr;\n  }\n\n  function _iterableToArrayLimitLoose(arr, i) {\n    var _arr = [];\n\n    for (\n      var _iterator = arr[Symbol.iterator](), _step;\n      !(_step = _iterator.next()).done;\n\n    ) {\n      _arr.push(_step.value);\n\n      if (i && _arr.length === i) break;\n    }\n\n    return _arr;\n  }\n\n  function _nonIterableSpread() {\n    throw new TypeError('Invalid attempt to spread non-iterable instance');\n  }\n\n  function _nonIterableRest() {\n    throw new TypeError('Invalid attempt to destructure non-iterable instance');\n  }\n\n  function _skipFirstGeneratorNext(fn) {\n    return function() {\n      var it = fn.apply(this, arguments);\n      it.next();\n      return it;\n    };\n  }\n\n  function _toPrimitive(input, hint) {\n    if (typeof input !== 'object' || input === null) return input;\n    var prim = input[Symbol.toPrimitive];\n\n    if (prim !== undefined) {\n      var res = prim.call(input, hint || 'default');\n      if (typeof res !== 'object') return res;\n      throw new TypeError('@@toPrimitive must return a primitive value.');\n    }\n\n    return (hint === 'string' ? String : Number)(input);\n  }\n\n  function _toPropertyKey(arg) {\n    var key = _toPrimitive(arg, 'string');\n\n    return typeof key === 'symbol' ? key : String(key);\n  }\n\n  function _initializerWarningHelper(descriptor, context) {\n    throw new Error(\n      'Decorating class property failed. Please ensure that ' +\n        'proposal-class-properties is enabled and set to use loose mode. ' +\n        'To use proposal-class-properties in spec mode with decorators, wait for ' +\n        'the next major version of decorators in stage 2.'\n    );\n  }\n\n  function _initializerDefineProperty(target, property, descriptor, context) {\n    if (!descriptor) return;\n    Object.defineProperty(target, property, {\n      enumerable: descriptor.enumerable,\n      configurable: descriptor.configurable,\n      writable: descriptor.writable,\n      value: descriptor.initializer\n        ? descriptor.initializer.call(context)\n        : void 0\n    });\n  }\n\n  function _applyDecoratedDescriptor(\n    target,\n    property,\n    decorators,\n    descriptor,\n    context\n  ) {\n    var desc = {};\n    Object.keys(descriptor).forEach(function(key) {\n      desc[key] = descriptor[key];\n    });\n    desc.enumerable = !!desc.enumerable;\n    desc.configurable = !!desc.configurable;\n\n    if ('value' in desc || desc.initializer) {\n      desc.writable = true;\n    }\n\n    desc = decorators\n      .slice()\n      .reverse()\n      .reduce(function(desc, decorator) {\n        return decorator(target, property, desc) || desc;\n      }, desc);\n\n    if (context && desc.initializer !== void 0) {\n      desc.value = desc.initializer ? desc.initializer.call(context) : void 0;\n      desc.initializer = undefined;\n    }\n\n    if (desc.initializer === void 0) {\n      Object.defineProperty(target, property, desc);\n      desc = null;\n    }\n\n    return desc;\n  }\n\n  var id = 0;\n\n  function _classPrivateFieldLooseKey(name) {\n    return '__private_' + id++ + '_' + name;\n  }\n\n  function _classPrivateFieldLooseBase(receiver, privateKey) {\n    if (!Object.prototype.hasOwnProperty.call(receiver, privateKey)) {\n      throw new TypeError('attempted to use private field on non-instance');\n    }\n\n    return receiver;\n  }\n\n  function _classPrivateFieldGet(receiver, privateMap) {\n    if (!privateMap.has(receiver)) {\n      throw new TypeError('attempted to get private field on non-instance');\n    }\n\n    var descriptor = privateMap.get(receiver);\n\n    if (descriptor.get) {\n      return descriptor.get.call(receiver);\n    }\n\n    return descriptor.value;\n  }\n\n  function _classPrivateFieldSet(receiver, privateMap, value) {\n    if (!privateMap.has(receiver)) {\n      throw new TypeError('attempted to set private field on non-instance');\n    }\n\n    var descriptor = privateMap.get(receiver);\n\n    if (descriptor.set) {\n      descriptor.set.call(receiver, value);\n    } else {\n      if (!descriptor.writable) {\n        throw new TypeError('attempted to set read only private field');\n      }\n\n      descriptor.value = value;\n    }\n\n    return value;\n  }\n\n  function _classStaticPrivateFieldSpecGet(\n    receiver,\n    classConstructor,\n    descriptor\n  ) {\n    if (receiver !== classConstructor) {\n      throw new TypeError('Private static access of wrong provenance');\n    }\n\n    return descriptor.value;\n  }\n\n  function _classStaticPrivateFieldSpecSet(\n    receiver,\n    classConstructor,\n    descriptor,\n    value\n  ) {\n    if (receiver !== classConstructor) {\n      throw new TypeError('Private static access of wrong provenance');\n    }\n\n    if (!descriptor.writable) {\n      throw new TypeError('attempted to set read only private field');\n    }\n\n    descriptor.value = value;\n    return value;\n  }\n\n  function _classStaticPrivateMethodGet(receiver, classConstructor, method) {\n    if (receiver !== classConstructor) {\n      throw new TypeError('Private static access of wrong provenance');\n    }\n\n    return method;\n  }\n\n  function _classStaticPrivateMethodSet() {\n    throw new TypeError('attempted to set read only static private field');\n  }\n\n  function _decorate(decorators, factory, superClass, mixins) {\n    var api = _getDecoratorsApi();\n\n    if (mixins) {\n      for (var i = 0; i < mixins.length; i++) {\n        api = mixins[i](api);\n      }\n    }\n\n    var r = factory(function initialize(O) {\n      api.initializeInstanceElements(O, decorated.elements);\n    }, superClass);\n    var decorated = api.decorateClass(\n      _coalesceClassElements(r.d.map(_createElementDescriptor)),\n      decorators\n    );\n    api.initializeClassElements(r.F, decorated.elements);\n    return api.runClassFinishers(r.F, decorated.finishers);\n  }\n\n  function _getDecoratorsApi() {\n    _getDecoratorsApi = function() {\n      return api;\n    };\n\n    var api = {\n      elementsDefinitionOrder: [['method'], ['field']],\n      initializeInstanceElements: function(O, elements) {\n        ['method', 'field'].forEach(function(kind) {\n          elements.forEach(function(element) {\n            if (element.kind === kind && element.placement === 'own') {\n              this.defineClassElement(O, element);\n            }\n          }, this);\n        }, this);\n      },\n      initializeClassElements: function(F, elements) {\n        var proto = F.prototype;\n        ['method', 'field'].forEach(function(kind) {\n          elements.forEach(function(element) {\n            var placement = element.placement;\n\n            if (\n              element.kind === kind &&\n              (placement === 'static' || placement === 'prototype')\n            ) {\n              var receiver = placement === 'static' ? F : proto;\n              this.defineClassElement(receiver, element);\n            }\n          }, this);\n        }, this);\n      },\n      defineClassElement: function(receiver, element) {\n        var descriptor = element.descriptor;\n\n        if (element.kind === 'field') {\n          var initializer = element.initializer;\n          descriptor = {\n            enumerable: descriptor.enumerable,\n            writable: descriptor.writable,\n            configurable: descriptor.configurable,\n            value: initializer === void 0 ? void 0 : initializer.call(receiver)\n          };\n        }\n\n        Object.defineProperty(receiver, element.key, descriptor);\n      },\n      decorateClass: function(elements, decorators) {\n        var newElements = [];\n        var finishers = [];\n        var placements = {\n          static: [],\n          prototype: [],\n          own: []\n        };\n        elements.forEach(function(element) {\n          this.addElementPlacement(element, placements);\n        }, this);\n        elements.forEach(function(element) {\n          if (!_hasDecorators(element)) return newElements.push(element);\n          var elementFinishersExtras = this.decorateElement(\n            element,\n            placements\n          );\n          newElements.push(elementFinishersExtras.element);\n          newElements.push.apply(newElements, elementFinishersExtras.extras);\n          finishers.push.apply(finishers, elementFinishersExtras.finishers);\n        }, this);\n\n        if (!decorators) {\n          return {\n            elements: newElements,\n            finishers: finishers\n          };\n        }\n\n        var result = this.decorateConstructor(newElements, decorators);\n        finishers.push.apply(finishers, result.finishers);\n        result.finishers = finishers;\n        return result;\n      },\n      addElementPlacement: function(element, placements, silent) {\n        var keys = placements[element.placement];\n\n        if (!silent && keys.indexOf(element.key) !== -1) {\n          throw new TypeError('Duplicated element (' + element.key + ')');\n        }\n\n        keys.push(element.key);\n      },\n      decorateElement: function(element, placements) {\n        var extras = [];\n        var finishers = [];\n\n        for (\n          var decorators = element.decorators, i = decorators.length - 1;\n          i >= 0;\n          i--\n        ) {\n          var keys = placements[element.placement];\n          keys.splice(keys.indexOf(element.key), 1);\n          var elementObject = this.fromElementDescriptor(element);\n          var elementFinisherExtras = this.toElementFinisherExtras(\n            (0, decorators[i])(elementObject) || elementObject\n          );\n          element = elementFinisherExtras.element;\n          this.addElementPlacement(element, placements);\n\n          if (elementFinisherExtras.finisher) {\n            finishers.push(elementFinisherExtras.finisher);\n          }\n\n          var newExtras = elementFinisherExtras.extras;\n\n          if (newExtras) {\n            for (var j = 0; j < newExtras.length; j++) {\n              this.addElementPlacement(newExtras[j], placements);\n            }\n\n            extras.push.apply(extras, newExtras);\n          }\n        }\n\n        return {\n          element: element,\n          finishers: finishers,\n          extras: extras\n        };\n      },\n      decorateConstructor: function(elements, decorators) {\n        var finishers = [];\n\n        for (var i = decorators.length - 1; i >= 0; i--) {\n          var obj = this.fromClassDescriptor(elements);\n          var elementsAndFinisher = this.toClassDescriptor(\n            (0, decorators[i])(obj) || obj\n          );\n\n          if (elementsAndFinisher.finisher !== undefined) {\n            finishers.push(elementsAndFinisher.finisher);\n          }\n\n          if (elementsAndFinisher.elements !== undefined) {\n            elements = elementsAndFinisher.elements;\n\n            for (var j = 0; j < elements.length - 1; j++) {\n              for (var k = j + 1; k < elements.length; k++) {\n                if (\n                  elements[j].key === elements[k].key &&\n                  elements[j].placement === elements[k].placement\n                ) {\n                  throw new TypeError(\n                    'Duplicated element (' + elements[j].key + ')'\n                  );\n                }\n              }\n            }\n          }\n        }\n\n        return {\n          elements: elements,\n          finishers: finishers\n        };\n      },\n      fromElementDescriptor: function(element) {\n        var obj = {\n          kind: element.kind,\n          key: element.key,\n          placement: element.placement,\n          descriptor: element.descriptor\n        };\n        var desc = {\n          value: 'Descriptor',\n          configurable: true\n        };\n        Object.defineProperty(obj, Symbol.toStringTag, desc);\n        if (element.kind === 'field') obj.initializer = element.initializer;\n        return obj;\n      },\n      toElementDescriptors: function(elementObjects) {\n        if (elementObjects === undefined) return;\n        return _toArray(elementObjects).map(function(elementObject) {\n          var element = this.toElementDescriptor(elementObject);\n          this.disallowProperty(\n            elementObject,\n            'finisher',\n            'An element descriptor'\n          );\n          this.disallowProperty(\n            elementObject,\n            'extras',\n            'An element descriptor'\n          );\n          return element;\n        }, this);\n      },\n      toElementDescriptor: function(elementObject) {\n        var kind = String(elementObject.kind);\n\n        if (kind !== 'method' && kind !== 'field') {\n          throw new TypeError(\n            'An element descriptor\\'s .kind property must be either \"method\" or' +\n              ' \"field\", but a decorator created an element descriptor with' +\n              ' .kind \"' +\n              kind +\n              '\"'\n          );\n        }\n\n        var key = _toPropertyKey(elementObject.key);\n\n        var placement = String(elementObject.placement);\n\n        if (\n          placement !== 'static' &&\n          placement !== 'prototype' &&\n          placement !== 'own'\n        ) {\n          throw new TypeError(\n            'An element descriptor\\'s .placement property must be one of \"static\",' +\n              ' \"prototype\" or \"own\", but a decorator created an element descriptor' +\n              ' with .placement \"' +\n              placement +\n              '\"'\n          );\n        }\n\n        var descriptor = elementObject.descriptor;\n        this.disallowProperty(\n          elementObject,\n          'elements',\n          'An element descriptor'\n        );\n        var element = {\n          kind: kind,\n          key: key,\n          placement: placement,\n          descriptor: Object.assign({}, descriptor)\n        };\n\n        if (kind !== 'field') {\n          this.disallowProperty(\n            elementObject,\n            'initializer',\n            'A method descriptor'\n          );\n        } else {\n          this.disallowProperty(\n            descriptor,\n            'get',\n            'The property descriptor of a field descriptor'\n          );\n          this.disallowProperty(\n            descriptor,\n            'set',\n            'The property descriptor of a field descriptor'\n          );\n          this.disallowProperty(\n            descriptor,\n            'value',\n            'The property descriptor of a field descriptor'\n          );\n          element.initializer = elementObject.initializer;\n        }\n\n        return element;\n      },\n      toElementFinisherExtras: function(elementObject) {\n        var element = this.toElementDescriptor(elementObject);\n\n        var finisher = _optionalCallableProperty(elementObject, 'finisher');\n\n        var extras = this.toElementDescriptors(elementObject.extras);\n        return {\n          element: element,\n          finisher: finisher,\n          extras: extras\n        };\n      },\n      fromClassDescriptor: function(elements) {\n        var obj = {\n          kind: 'class',\n          elements: elements.map(this.fromElementDescriptor, this)\n        };\n        var desc = {\n          value: 'Descriptor',\n          configurable: true\n        };\n        Object.defineProperty(obj, Symbol.toStringTag, desc);\n        return obj;\n      },\n      toClassDescriptor: function(obj) {\n        var kind = String(obj.kind);\n\n        if (kind !== 'class') {\n          throw new TypeError(\n            'A class descriptor\\'s .kind property must be \"class\", but a decorator' +\n              ' created a class descriptor with .kind \"' +\n              kind +\n              '\"'\n          );\n        }\n\n        this.disallowProperty(obj, 'key', 'A class descriptor');\n        this.disallowProperty(obj, 'placement', 'A class descriptor');\n        this.disallowProperty(obj, 'descriptor', 'A class descriptor');\n        this.disallowProperty(obj, 'initializer', 'A class descriptor');\n        this.disallowProperty(obj, 'extras', 'A class descriptor');\n\n        var finisher = _optionalCallableProperty(obj, 'finisher');\n\n        var elements = this.toElementDescriptors(obj.elements);\n        return {\n          elements: elements,\n          finisher: finisher\n        };\n      },\n      runClassFinishers: function(constructor, finishers) {\n        for (var i = 0; i < finishers.length; i++) {\n          var newConstructor = (0, finishers[i])(constructor);\n\n          if (newConstructor !== undefined) {\n            if (typeof newConstructor !== 'function') {\n              throw new TypeError('Finishers must return a constructor.');\n            }\n\n            constructor = newConstructor;\n          }\n        }\n\n        return constructor;\n      },\n      disallowProperty: function(obj, name, objectType) {\n        if (obj[name] !== undefined) {\n          throw new TypeError(\n            objectType + \" can't have a .\" + name + ' property.'\n          );\n        }\n      }\n    };\n    return api;\n  }\n\n  function _createElementDescriptor(def) {\n    var key = _toPropertyKey(def.key);\n\n    var descriptor;\n\n    if (def.kind === 'method') {\n      descriptor = {\n        value: def.value,\n        writable: true,\n        configurable: true,\n        enumerable: false\n      };\n    } else if (def.kind === 'get') {\n      descriptor = {\n        get: def.value,\n        configurable: true,\n        enumerable: false\n      };\n    } else if (def.kind === 'set') {\n      descriptor = {\n        set: def.value,\n        configurable: true,\n        enumerable: false\n      };\n    } else if (def.kind === 'field') {\n      descriptor = {\n        configurable: true,\n        writable: true,\n        enumerable: true\n      };\n    }\n\n    var element = {\n      kind: def.kind === 'field' ? 'field' : 'method',\n      key: key,\n      placement: def.static\n        ? 'static'\n        : def.kind === 'field'\n        ? 'own'\n        : 'prototype',\n      descriptor: descriptor\n    };\n    if (def.decorators) element.decorators = def.decorators;\n    if (def.kind === 'field') element.initializer = def.value;\n    return element;\n  }\n\n  function _coalesceGetterSetter(element, other) {\n    if (element.descriptor.get !== undefined) {\n      other.descriptor.get = element.descriptor.get;\n    } else {\n      other.descriptor.set = element.descriptor.set;\n    }\n  }\n\n  function _coalesceClassElements(elements) {\n    var newElements = [];\n\n    var isSameElement = function(other) {\n      return (\n        other.kind === 'method' &&\n        other.key === element.key &&\n        other.placement === element.placement\n      );\n    };\n\n    for (var i = 0; i < elements.length; i++) {\n      var element = elements[i];\n      var other;\n\n      if (\n        element.kind === 'method' &&\n        (other = newElements.find(isSameElement))\n      ) {\n        if (\n          _isDataDescriptor(element.descriptor) ||\n          _isDataDescriptor(other.descriptor)\n        ) {\n          if (_hasDecorators(element) || _hasDecorators(other)) {\n            throw new ReferenceError(\n              'Duplicated methods (' + element.key + \") can't be decorated.\"\n            );\n          }\n\n          other.descriptor = element.descriptor;\n        } else {\n          if (_hasDecorators(element)) {\n            if (_hasDecorators(other)) {\n              throw new ReferenceError(\n                \"Decorators can't be placed on different accessors with for \" +\n                  'the same property (' +\n                  element.key +\n                  ').'\n              );\n            }\n\n            other.decorators = element.decorators;\n          }\n\n          _coalesceGetterSetter(element, other);\n        }\n      } else {\n        newElements.push(element);\n      }\n    }\n\n    return newElements;\n  }\n\n  function _hasDecorators(element) {\n    return element.decorators && element.decorators.length;\n  }\n\n  function _isDataDescriptor(desc) {\n    return (\n      desc !== undefined &&\n      !(desc.value === undefined && desc.writable === undefined)\n    );\n  }\n\n  function _optionalCallableProperty(obj, name) {\n    var value = obj[name];\n\n    if (value !== undefined && typeof value !== 'function') {\n      throw new TypeError(\"Expected '\" + name + \"' to be a function\");\n    }\n\n    return value;\n  }\n\n  function _classPrivateMethodGet(receiver, privateSet, fn) {\n    if (!privateSet.has(receiver)) {\n      throw new TypeError('attempted to get private field on non-instance');\n    }\n\n    return fn;\n  }\n\n  function _classPrivateMethodSet() {\n    throw new TypeError('attempted to reassign private method');\n  }\n\n  function _wrapRegExp(re, groups) {\n    _wrapRegExp = function(re, groups) {\n      return new BabelRegExp(re, groups);\n    };\n\n    var _RegExp = _wrapNativeSuper(RegExp);\n\n    var _super = RegExp.prototype;\n\n    var _groups = new WeakMap();\n\n    function BabelRegExp(re, groups) {\n      var _this = _RegExp.call(this, re);\n\n      _groups.set(_this, groups);\n\n      return _this;\n    }\n\n    _inherits(BabelRegExp, _RegExp);\n\n    BabelRegExp.prototype.exec = function(str) {\n      var result = _super.exec.call(this, str);\n\n      if (result) result.groups = buildGroups(result, this);\n      return result;\n    };\n\n    BabelRegExp.prototype[Symbol.replace] = function(str, substitution) {\n      if (typeof substitution === 'string') {\n        var groups = _groups.get(this);\n\n        return _super[Symbol.replace].call(\n          this,\n          str,\n          substitution.replace(/\\$<([^>]+)>/g, function(_, name) {\n            return '$' + groups[name];\n          })\n        );\n      } else if (typeof substitution === 'function') {\n        var _this = this;\n\n        return _super[Symbol.replace].call(this, str, function() {\n          var args = [];\n          args.push.apply(args, arguments);\n\n          if (typeof args[args.length - 1] !== 'object') {\n            args.push(buildGroups(args, _this));\n          }\n\n          return substitution.apply(this, args);\n        });\n      } else {\n        return _super[Symbol.replace].call(this, str, substitution);\n      }\n    };\n\n    function buildGroups(result, re) {\n      var g = _groups.get(re);\n\n      return Object.keys(g).reduce(function(groups, name) {\n        groups[name] = result[g[name]];\n        return groups;\n      }, Object.create(null));\n    }\n\n    return _wrapRegExp.apply(this, arguments);\n  }\n\n  var vectorMultiply = function vectorMultiply(v, amount) {\n    return createVector(v.x * amount, v.y * amount);\n  };\n\n  var vectorAdd = function vectorAdd(a, b) {\n    return createVector(a.x + b.x, a.y + b.y);\n  };\n\n  var vectorNormalize = function vectorNormalize(v) {\n    var l = Math.sqrt(v.x * v.x + v.y * v.y);\n    if (l === 0) {\n      return {\n        x: 0,\n        y: 0\n      };\n    }\n    return createVector(v.x / l, v.y / l);\n  };\n\n  var vectorRotate = function vectorRotate(v, radians, origin) {\n    var cos = Math.cos(radians);\n    var sin = Math.sin(radians);\n    var t = createVector(v.x - origin.x, v.y - origin.y);\n    return createVector(\n      origin.x + cos * t.x - sin * t.y,\n      origin.y + sin * t.x + cos * t.y\n    );\n  };\n\n  var createVector = function createVector() {\n    var x =\n      arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n    var y =\n      arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n    return { x: x, y: y };\n  };\n\n  var getMarkupValue = function getMarkupValue(value, size) {\n    var scalar =\n      arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 1;\n    var axis = arguments.length > 3 ? arguments[3] : undefined;\n    if (typeof value === 'string') {\n      return parseFloat(value) * scalar;\n    }\n    if (typeof value === 'number') {\n      return value * (axis ? size[axis] : Math.min(size.width, size.height));\n    }\n    return;\n  };\n\n  var getMarkupStyles = function getMarkupStyles(markup, size, scale) {\n    var lineStyle = markup.borderStyle || markup.lineStyle || 'solid';\n    var fill = markup.backgroundColor || markup.fontColor || 'transparent';\n    var stroke = markup.borderColor || markup.lineColor || 'transparent';\n    var strokeWidth = getMarkupValue(\n      markup.borderWidth || markup.lineWidth,\n      size,\n      scale\n    );\n    var lineCap = markup.lineCap || 'round';\n    var lineJoin = markup.lineJoin || 'round';\n    var dashes =\n      typeof lineStyle === 'string'\n        ? ''\n        : lineStyle\n            .map(function(v) {\n              return getMarkupValue(v, size, scale);\n            })\n            .join(',');\n    var opacity = markup.opacity || 1;\n    return {\n      'stroke-linecap': lineCap,\n      'stroke-linejoin': lineJoin,\n      'stroke-width': strokeWidth || 0,\n      'stroke-dasharray': dashes,\n      stroke: stroke,\n      fill: fill,\n      opacity: opacity\n    };\n  };\n\n  var isDefined = function isDefined(value) {\n    return value != null;\n  };\n\n  var getMarkupRect = function getMarkupRect(rect, size) {\n    var scalar =\n      arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 1;\n\n    var left =\n      getMarkupValue(rect.x, size, scalar, 'width') ||\n      getMarkupValue(rect.left, size, scalar, 'width');\n    var top =\n      getMarkupValue(rect.y, size, scalar, 'height') ||\n      getMarkupValue(rect.top, size, scalar, 'height');\n    var width = getMarkupValue(rect.width, size, scalar, 'width');\n    var height = getMarkupValue(rect.height, size, scalar, 'height');\n    var right = getMarkupValue(rect.right, size, scalar, 'width');\n    var bottom = getMarkupValue(rect.bottom, size, scalar, 'height');\n\n    if (!isDefined(top)) {\n      if (isDefined(height) && isDefined(bottom)) {\n        top = size.height - height - bottom;\n      } else {\n        top = bottom;\n      }\n    }\n\n    if (!isDefined(left)) {\n      if (isDefined(width) && isDefined(right)) {\n        left = size.width - width - right;\n      } else {\n        left = right;\n      }\n    }\n\n    if (!isDefined(width)) {\n      if (isDefined(left) && isDefined(right)) {\n        width = size.width - left - right;\n      } else {\n        width = 0;\n      }\n    }\n\n    if (!isDefined(height)) {\n      if (isDefined(top) && isDefined(bottom)) {\n        height = size.height - top - bottom;\n      } else {\n        height = 0;\n      }\n    }\n\n    return {\n      x: left || 0,\n      y: top || 0,\n      width: width || 0,\n      height: height || 0\n    };\n  };\n\n  var pointsToPathShape = function pointsToPathShape(points) {\n    return points\n      .map(function(point, index) {\n        return ''\n          .concat(index === 0 ? 'M' : 'L', ' ')\n          .concat(point.x, ' ')\n          .concat(point.y);\n      })\n      .join(' ');\n  };\n\n  var setAttributes = function setAttributes(element, attr) {\n    return Object.keys(attr).forEach(function(key) {\n      return element.setAttribute(key, attr[key]);\n    });\n  };\n\n  var ns = 'http://www.w3.org/2000/svg';\n  var svg = function svg(tag, attr) {\n    var element = document.createElementNS(ns, tag);\n    if (attr) {\n      setAttributes(element, attr);\n    }\n    return element;\n  };\n\n  var updateRect = function updateRect(element) {\n    return setAttributes(\n      element,\n      Object.assign({}, element.rect, element.styles)\n    );\n  };\n\n  var updateEllipse = function updateEllipse(element) {\n    var cx = element.rect.x + element.rect.width * 0.5;\n    var cy = element.rect.y + element.rect.height * 0.5;\n    var rx = element.rect.width * 0.5;\n    var ry = element.rect.height * 0.5;\n    return setAttributes(\n      element,\n      Object.assign(\n        {\n          cx: cx,\n          cy: cy,\n          rx: rx,\n          ry: ry\n        },\n        element.styles\n      )\n    );\n  };\n\n  var IMAGE_FIT_STYLE = {\n    contain: 'xMidYMid meet',\n    cover: 'xMidYMid slice'\n  };\n\n  var updateImage = function updateImage(element, markup) {\n    setAttributes(\n      element,\n      Object.assign({}, element.rect, element.styles, {\n        preserveAspectRatio: IMAGE_FIT_STYLE[markup.fit] || 'none'\n      })\n    );\n  };\n\n  var TEXT_ANCHOR = {\n    left: 'start',\n    center: 'middle',\n    right: 'end'\n  };\n\n  var updateText = function updateText(element, markup, size, scale) {\n    var fontSize = getMarkupValue(markup.fontSize, size, scale);\n    var fontFamily = markup.fontFamily || 'sans-serif';\n    var fontWeight = markup.fontWeight || 'normal';\n    var textAlign = TEXT_ANCHOR[markup.textAlign] || 'start';\n\n    setAttributes(\n      element,\n      Object.assign({}, element.rect, element.styles, {\n        'stroke-width': 0,\n        'font-weight': fontWeight,\n        'font-size': fontSize,\n        'font-family': fontFamily,\n        'text-anchor': textAlign\n      })\n    );\n\n    // update text\n    if (element.text !== markup.text) {\n      element.text = markup.text;\n      element.textContent = markup.text.length ? markup.text : ' ';\n    }\n  };\n\n  var updateLine = function updateLine(element, markup, size, scale) {\n    setAttributes(\n      element,\n      Object.assign({}, element.rect, element.styles, {\n        fill: 'none'\n      })\n    );\n\n    var line = element.childNodes[0];\n    var begin = element.childNodes[1];\n    var end = element.childNodes[2];\n\n    var origin = element.rect;\n\n    var target = {\n      x: element.rect.x + element.rect.width,\n      y: element.rect.y + element.rect.height\n    };\n\n    setAttributes(line, {\n      x1: origin.x,\n      y1: origin.y,\n      x2: target.x,\n      y2: target.y\n    });\n\n    if (!markup.lineDecoration) return;\n\n    begin.style.display = 'none';\n    end.style.display = 'none';\n\n    var v = vectorNormalize({\n      x: target.x - origin.x,\n      y: target.y - origin.y\n    });\n\n    var l = getMarkupValue(0.05, size, scale);\n\n    if (markup.lineDecoration.indexOf('arrow-begin') !== -1) {\n      var arrowBeginRotationPoint = vectorMultiply(v, l);\n      var arrowBeginCenter = vectorAdd(origin, arrowBeginRotationPoint);\n      var arrowBeginA = vectorRotate(origin, 2, arrowBeginCenter);\n      var arrowBeginB = vectorRotate(origin, -2, arrowBeginCenter);\n\n      setAttributes(begin, {\n        style: 'display:block;',\n        d: 'M'\n          .concat(arrowBeginA.x, ',')\n          .concat(arrowBeginA.y, ' L')\n          .concat(origin.x, ',')\n          .concat(origin.y, ' L')\n          .concat(arrowBeginB.x, ',')\n          .concat(arrowBeginB.y)\n      });\n    }\n\n    if (markup.lineDecoration.indexOf('arrow-end') !== -1) {\n      var arrowEndRotationPoint = vectorMultiply(v, -l);\n      var arrowEndCenter = vectorAdd(target, arrowEndRotationPoint);\n      var arrowEndA = vectorRotate(target, 2, arrowEndCenter);\n      var arrowEndB = vectorRotate(target, -2, arrowEndCenter);\n\n      setAttributes(end, {\n        style: 'display:block;',\n        d: 'M'\n          .concat(arrowEndA.x, ',')\n          .concat(arrowEndA.y, ' L')\n          .concat(target.x, ',')\n          .concat(target.y, ' L')\n          .concat(arrowEndB.x, ',')\n          .concat(arrowEndB.y)\n      });\n    }\n  };\n\n  var updatePath = function updatePath(element, markup, size, scale) {\n    setAttributes(\n      element,\n      Object.assign({}, element.styles, {\n        fill: 'none',\n        d: pointsToPathShape(\n          markup.points.map(function(point) {\n            return {\n              x: getMarkupValue(point.x, size, scale, 'width'),\n              y: getMarkupValue(point.y, size, scale, 'height')\n            };\n          })\n        )\n      })\n    );\n  };\n\n  var createShape = function createShape(node) {\n    return function(markup) {\n      return svg(node, { id: markup.id });\n    };\n  };\n\n  var createImage = function createImage(markup) {\n    var shape = svg('image', {\n      id: markup.id,\n      'stroke-linecap': 'round',\n      'stroke-linejoin': 'round',\n      opacity: '0'\n    });\n\n    shape.onload = function() {\n      shape.setAttribute('opacity', markup.opacity || 1);\n    };\n    shape.setAttributeNS(\n      'http://www.w3.org/1999/xlink',\n      'xlink:href',\n      markup.src\n    );\n    return shape;\n  };\n\n  var createLine = function createLine(markup) {\n    var shape = svg('g', {\n      id: markup.id,\n      'stroke-linecap': 'round',\n      'stroke-linejoin': 'round'\n    });\n\n    var line = svg('line');\n    shape.appendChild(line);\n\n    var begin = svg('path');\n    shape.appendChild(begin);\n\n    var end = svg('path');\n    shape.appendChild(end);\n\n    return shape;\n  };\n\n  var CREATE_TYPE_ROUTES = {\n    image: createImage,\n    rect: createShape('rect'),\n    ellipse: createShape('ellipse'),\n    text: createShape('text'),\n    path: createShape('path'),\n    line: createLine\n  };\n\n  var UPDATE_TYPE_ROUTES = {\n    rect: updateRect,\n    ellipse: updateEllipse,\n    image: updateImage,\n    text: updateText,\n    path: updatePath,\n    line: updateLine\n  };\n\n  var createMarkupByType = function createMarkupByType(type, markup) {\n    return CREATE_TYPE_ROUTES[type](markup);\n  };\n\n  var updateMarkupByType = function updateMarkupByType(\n    element,\n    type,\n    markup,\n    size,\n    scale\n  ) {\n    if (type !== 'path') {\n      element.rect = getMarkupRect(markup, size, scale);\n    }\n    element.styles = getMarkupStyles(markup, size, scale);\n    UPDATE_TYPE_ROUTES[type](element, markup, size, scale);\n  };\n\n  var MARKUP_RECT = [\n    'x',\n    'y',\n    'left',\n    'top',\n    'right',\n    'bottom',\n    'width',\n    'height'\n  ];\n\n  var toOptionalFraction = function toOptionalFraction(value) {\n    return typeof value === 'string' && /%/.test(value)\n      ? parseFloat(value) / 100\n      : value;\n  };\n\n  // adds default markup properties, clones markup\n  var prepareMarkup = function prepareMarkup(markup) {\n    var _markup = _slicedToArray(markup, 2),\n      type = _markup[0],\n      props = _markup[1];\n\n    var rect = props.points\n      ? {}\n      : MARKUP_RECT.reduce(function(prev, curr) {\n          prev[curr] = toOptionalFraction(props[curr]);\n          return prev;\n        }, {});\n\n    return [\n      type,\n      Object.assign(\n        {\n          zIndex: 0\n        },\n        props,\n        rect\n      )\n    ];\n  };\n\n  var sortMarkupByZIndex = function sortMarkupByZIndex(a, b) {\n    if (a[1].zIndex > b[1].zIndex) {\n      return 1;\n    }\n    if (a[1].zIndex < b[1].zIndex) {\n      return -1;\n    }\n    return 0;\n  };\n\n  var createMarkupView = function createMarkupView(_) {\n    return _.utils.createView({\n      name: 'image-preview-markup',\n      tag: 'svg',\n      ignoreRect: true,\n      mixins: {\n        apis: ['width', 'height', 'crop', 'markup', 'resize', 'dirty']\n      },\n\n      write: function write(_ref) {\n        var root = _ref.root,\n          props = _ref.props;\n\n        if (!props.dirty) return;\n        var crop = props.crop,\n          resize = props.resize,\n          markup = props.markup;\n\n        var viewWidth = props.width;\n        var viewHeight = props.height;\n\n        var cropWidth = crop.width;\n        var cropHeight = crop.height;\n\n        if (resize) {\n          var _size = resize.size;\n\n          var outputWidth = _size && _size.width;\n          var outputHeight = _size && _size.height;\n          var outputFit = resize.mode;\n          var outputUpscale = resize.upscale;\n\n          if (outputWidth && !outputHeight) outputHeight = outputWidth;\n          if (outputHeight && !outputWidth) outputWidth = outputHeight;\n\n          var shouldUpscale =\n            cropWidth < outputWidth && cropHeight < outputHeight;\n\n          if (!shouldUpscale || (shouldUpscale && outputUpscale)) {\n            var scalarWidth = outputWidth / cropWidth;\n            var scalarHeight = outputHeight / cropHeight;\n\n            if (outputFit === 'force') {\n              cropWidth = outputWidth;\n              cropHeight = outputHeight;\n            } else {\n              var scalar;\n              if (outputFit === 'cover') {\n                scalar = Math.max(scalarWidth, scalarHeight);\n              } else if (outputFit === 'contain') {\n                scalar = Math.min(scalarWidth, scalarHeight);\n              }\n              cropWidth = cropWidth * scalar;\n              cropHeight = cropHeight * scalar;\n            }\n          }\n        }\n\n        var size = {\n          width: viewWidth,\n          height: viewHeight\n        };\n\n        root.element.setAttribute('width', size.width);\n        root.element.setAttribute('height', size.height);\n\n        var scale = Math.min(viewWidth / cropWidth, viewHeight / cropHeight);\n\n        // clear\n        root.element.innerHTML = '';\n\n        // get filter\n        var markupFilter = root.query('GET_IMAGE_PREVIEW_MARKUP_FILTER');\n\n        // draw new\n        markup\n          .filter(markupFilter)\n          .map(prepareMarkup)\n          .sort(sortMarkupByZIndex)\n          .forEach(function(markup) {\n            var _markup = _slicedToArray(markup, 2),\n              type = _markup[0],\n              settings = _markup[1];\n\n            // create\n            var element = createMarkupByType(type, settings);\n\n            // update\n            updateMarkupByType(element, type, settings, size, scale);\n\n            // add\n            root.element.appendChild(element);\n          });\n      }\n    });\n  };\n\n  var createVector$1 = function createVector(x, y) {\n    return { x: x, y: y };\n  };\n\n  var vectorDot = function vectorDot(a, b) {\n    return a.x * b.x + a.y * b.y;\n  };\n\n  var vectorSubtract = function vectorSubtract(a, b) {\n    return createVector$1(a.x - b.x, a.y - b.y);\n  };\n\n  var vectorDistanceSquared = function vectorDistanceSquared(a, b) {\n    return vectorDot(vectorSubtract(a, b), vectorSubtract(a, b));\n  };\n\n  var vectorDistance = function vectorDistance(a, b) {\n    return Math.sqrt(vectorDistanceSquared(a, b));\n  };\n\n  var getOffsetPointOnEdge = function getOffsetPointOnEdge(length, rotation) {\n    var a = length;\n\n    var A = 1.5707963267948966;\n    var B = rotation;\n    var C = 1.5707963267948966 - rotation;\n\n    var sinA = Math.sin(A);\n    var sinB = Math.sin(B);\n    var sinC = Math.sin(C);\n    var cosC = Math.cos(C);\n    var ratio = a / sinA;\n    var b = ratio * sinB;\n    var c = ratio * sinC;\n\n    return createVector$1(cosC * b, cosC * c);\n  };\n\n  var getRotatedRectSize = function getRotatedRectSize(rect, rotation) {\n    var w = rect.width;\n    var h = rect.height;\n\n    var hor = getOffsetPointOnEdge(w, rotation);\n    var ver = getOffsetPointOnEdge(h, rotation);\n\n    var tl = createVector$1(rect.x + Math.abs(hor.x), rect.y - Math.abs(hor.y));\n\n    var tr = createVector$1(\n      rect.x + rect.width + Math.abs(ver.y),\n      rect.y + Math.abs(ver.x)\n    );\n\n    var bl = createVector$1(\n      rect.x - Math.abs(ver.y),\n      rect.y + rect.height - Math.abs(ver.x)\n    );\n\n    return {\n      width: vectorDistance(tl, tr),\n      height: vectorDistance(tl, bl)\n    };\n  };\n\n  var calculateCanvasSize = function calculateCanvasSize(\n    image,\n    canvasAspectRatio\n  ) {\n    var zoom =\n      arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 1;\n\n    var imageAspectRatio = image.height / image.width;\n\n    // determine actual pixels on x and y axis\n    var canvasWidth = 1;\n    var canvasHeight = canvasAspectRatio;\n    var imgWidth = 1;\n    var imgHeight = imageAspectRatio;\n    if (imgHeight > canvasHeight) {\n      imgHeight = canvasHeight;\n      imgWidth = imgHeight / imageAspectRatio;\n    }\n\n    var scalar = Math.max(canvasWidth / imgWidth, canvasHeight / imgHeight);\n    var width = image.width / (zoom * scalar * imgWidth);\n    var height = width * canvasAspectRatio;\n\n    return {\n      width: width,\n      height: height\n    };\n  };\n\n  var getImageRectZoomFactor = function getImageRectZoomFactor(\n    imageRect,\n    cropRect,\n    rotation,\n    center\n  ) {\n    // calculate available space round image center position\n    var cx = center.x > 0.5 ? 1 - center.x : center.x;\n    var cy = center.y > 0.5 ? 1 - center.y : center.y;\n    var imageWidth = cx * 2 * imageRect.width;\n    var imageHeight = cy * 2 * imageRect.height;\n\n    // calculate rotated crop rectangle size\n    var rotatedCropSize = getRotatedRectSize(cropRect, rotation);\n\n    // calculate scalar required to fit image\n    return Math.max(\n      rotatedCropSize.width / imageWidth,\n      rotatedCropSize.height / imageHeight\n    );\n  };\n\n  var getCenteredCropRect = function getCenteredCropRect(\n    container,\n    aspectRatio\n  ) {\n    var width = container.width;\n    var height = width * aspectRatio;\n    if (height > container.height) {\n      height = container.height;\n      width = height / aspectRatio;\n    }\n    var x = (container.width - width) * 0.5;\n    var y = (container.height - height) * 0.5;\n\n    return {\n      x: x,\n      y: y,\n      width: width,\n      height: height\n    };\n  };\n\n  var getCurrentCropSize = function getCurrentCropSize(imageSize) {\n    var crop =\n      arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var zoom = crop.zoom,\n      rotation = crop.rotation,\n      center = crop.center,\n      aspectRatio = crop.aspectRatio;\n\n    if (!aspectRatio) aspectRatio = imageSize.height / imageSize.width;\n\n    var canvasSize = calculateCanvasSize(imageSize, aspectRatio, zoom);\n\n    var canvasCenter = {\n      x: canvasSize.width * 0.5,\n      y: canvasSize.height * 0.5\n    };\n\n    var stage = {\n      x: 0,\n      y: 0,\n      width: canvasSize.width,\n      height: canvasSize.height,\n      center: canvasCenter\n    };\n\n    var shouldLimit = typeof crop.scaleToFit === 'undefined' || crop.scaleToFit;\n\n    var stageZoomFactor = getImageRectZoomFactor(\n      imageSize,\n      getCenteredCropRect(stage, aspectRatio),\n      rotation,\n      shouldLimit ? center : { x: 0.5, y: 0.5 }\n    );\n\n    var scale = zoom * stageZoomFactor;\n\n    // start drawing\n    return {\n      widthFloat: canvasSize.width / scale,\n      heightFloat: canvasSize.height / scale,\n      width: Math.round(canvasSize.width / scale),\n      height: Math.round(canvasSize.height / scale)\n    };\n  };\n\n  var IMAGE_SCALE_SPRING_PROPS = {\n    type: 'spring',\n    stiffness: 0.5,\n    damping: 0.45,\n    mass: 10\n  };\n\n  // does horizontal and vertical flipping\n  var createBitmapView = function createBitmapView(_) {\n    return _.utils.createView({\n      name: 'image-bitmap',\n      ignoreRect: true,\n      mixins: { styles: ['scaleX', 'scaleY'] },\n      create: function create(_ref) {\n        var root = _ref.root,\n          props = _ref.props;\n        root.appendChild(props.image);\n      }\n    });\n  };\n\n  // shifts and rotates image\n  var createImageCanvasWrapper = function createImageCanvasWrapper(_) {\n    return _.utils.createView({\n      name: 'image-canvas-wrapper',\n      tag: 'div',\n      ignoreRect: true,\n      mixins: {\n        apis: ['crop', 'width', 'height'],\n\n        styles: [\n          'originX',\n          'originY',\n          'translateX',\n          'translateY',\n          'scaleX',\n          'scaleY',\n          'rotateZ'\n        ],\n\n        animations: {\n          originX: IMAGE_SCALE_SPRING_PROPS,\n          originY: IMAGE_SCALE_SPRING_PROPS,\n          scaleX: IMAGE_SCALE_SPRING_PROPS,\n          scaleY: IMAGE_SCALE_SPRING_PROPS,\n          translateX: IMAGE_SCALE_SPRING_PROPS,\n          translateY: IMAGE_SCALE_SPRING_PROPS,\n          rotateZ: IMAGE_SCALE_SPRING_PROPS\n        }\n      },\n\n      create: function create(_ref2) {\n        var root = _ref2.root,\n          props = _ref2.props;\n        props.width = props.image.width;\n        props.height = props.image.height;\n        root.ref.bitmap = root.appendChildView(\n          root.createChildView(createBitmapView(_), { image: props.image })\n        );\n      },\n      write: function write(_ref3) {\n        var root = _ref3.root,\n          props = _ref3.props;\n        var flip = props.crop.flip;\n        var bitmap = root.ref.bitmap;\n        bitmap.scaleX = flip.horizontal ? -1 : 1;\n        bitmap.scaleY = flip.vertical ? -1 : 1;\n      }\n    });\n  };\n\n  // clips canvas to correct aspect ratio\n  var createClipView = function createClipView(_) {\n    return _.utils.createView({\n      name: 'image-clip',\n      tag: 'div',\n      ignoreRect: true,\n      mixins: {\n        apis: [\n          'crop',\n          'markup',\n          'resize',\n          'width',\n          'height',\n          'dirty',\n          'background'\n        ],\n\n        styles: ['width', 'height', 'opacity'],\n        animations: {\n          opacity: { type: 'tween', duration: 250 }\n        }\n      },\n\n      didWriteView: function didWriteView(_ref4) {\n        var root = _ref4.root,\n          props = _ref4.props;\n        if (!props.background) return;\n        root.element.style.backgroundColor = props.background;\n      },\n      create: function create(_ref5) {\n        var root = _ref5.root,\n          props = _ref5.props;\n\n        root.ref.image = root.appendChildView(\n          root.createChildView(\n            createImageCanvasWrapper(_),\n            Object.assign({}, props)\n          )\n        );\n\n        root.ref.createMarkup = function() {\n          if (root.ref.markup) return;\n          root.ref.markup = root.appendChildView(\n            root.createChildView(createMarkupView(_), Object.assign({}, props))\n          );\n        };\n\n        root.ref.destroyMarkup = function() {\n          if (!root.ref.markup) return;\n          root.removeChildView(root.ref.markup);\n          root.ref.markup = null;\n        };\n\n        // set up transparency grid\n        var transparencyIndicator = root.query(\n          'GET_IMAGE_PREVIEW_TRANSPARENCY_INDICATOR'\n        );\n        if (transparencyIndicator === null) return;\n\n        // grid pattern\n        if (transparencyIndicator === 'grid') {\n          root.element.dataset.transparencyIndicator = transparencyIndicator;\n        }\n        // basic color\n        else {\n          root.element.dataset.transparencyIndicator = 'color';\n        }\n      },\n      write: function write(_ref6) {\n        var root = _ref6.root,\n          props = _ref6.props,\n          shouldOptimize = _ref6.shouldOptimize;\n        var crop = props.crop,\n          markup = props.markup,\n          resize = props.resize,\n          dirty = props.dirty,\n          width = props.width,\n          height = props.height;\n\n        root.ref.image.crop = crop;\n\n        var stage = {\n          x: 0,\n          y: 0,\n          width: width,\n          height: height,\n          center: {\n            x: width * 0.5,\n            y: height * 0.5\n          }\n        };\n\n        var image = {\n          width: root.ref.image.width,\n          height: root.ref.image.height\n        };\n\n        var origin = {\n          x: crop.center.x * image.width,\n          y: crop.center.y * image.height\n        };\n\n        var translation = {\n          x: stage.center.x - image.width * crop.center.x,\n          y: stage.center.y - image.height * crop.center.y\n        };\n\n        var rotation = Math.PI * 2 + (crop.rotation % (Math.PI * 2));\n\n        var cropAspectRatio = crop.aspectRatio || image.height / image.width;\n\n        var shouldLimit =\n          typeof crop.scaleToFit === 'undefined' || crop.scaleToFit;\n\n        var stageZoomFactor = getImageRectZoomFactor(\n          image,\n          getCenteredCropRect(stage, cropAspectRatio),\n\n          rotation,\n          shouldLimit ? crop.center : { x: 0.5, y: 0.5 }\n        );\n\n        var scale = crop.zoom * stageZoomFactor;\n\n        // update markup view\n        if (markup && markup.length) {\n          root.ref.createMarkup();\n          root.ref.markup.width = width;\n          root.ref.markup.height = height;\n          root.ref.markup.resize = resize;\n          root.ref.markup.dirty = dirty;\n          root.ref.markup.markup = markup;\n          root.ref.markup.crop = getCurrentCropSize(image, crop);\n        } else if (root.ref.markup) {\n          root.ref.destroyMarkup();\n        }\n\n        // update image view\n        var imageView = root.ref.image;\n\n        // don't update clip layout\n        if (shouldOptimize) {\n          imageView.originX = null;\n          imageView.originY = null;\n          imageView.translateX = null;\n          imageView.translateY = null;\n          imageView.rotateZ = null;\n          imageView.scaleX = null;\n          imageView.scaleY = null;\n          return;\n        }\n\n        imageView.originX = origin.x;\n        imageView.originY = origin.y;\n        imageView.translateX = translation.x;\n        imageView.translateY = translation.y;\n        imageView.rotateZ = rotation;\n        imageView.scaleX = scale;\n        imageView.scaleY = scale;\n      }\n    });\n  };\n\n  var createImageView = function createImageView(_) {\n    return _.utils.createView({\n      name: 'image-preview',\n      tag: 'div',\n      ignoreRect: true,\n      mixins: {\n        apis: ['image', 'crop', 'markup', 'resize', 'dirty', 'background'],\n\n        styles: ['translateY', 'scaleX', 'scaleY', 'opacity'],\n\n        animations: {\n          scaleX: IMAGE_SCALE_SPRING_PROPS,\n          scaleY: IMAGE_SCALE_SPRING_PROPS,\n          translateY: IMAGE_SCALE_SPRING_PROPS,\n          opacity: { type: 'tween', duration: 400 }\n        }\n      },\n\n      create: function create(_ref7) {\n        var root = _ref7.root,\n          props = _ref7.props;\n        root.ref.clip = root.appendChildView(\n          root.createChildView(createClipView(_), {\n            id: props.id,\n            image: props.image,\n            crop: props.crop,\n            markup: props.markup,\n            resize: props.resize,\n            dirty: props.dirty,\n            background: props.background\n          })\n        );\n      },\n      write: function write(_ref8) {\n        var root = _ref8.root,\n          props = _ref8.props,\n          shouldOptimize = _ref8.shouldOptimize;\n        var clip = root.ref.clip;\n        var image = props.image,\n          crop = props.crop,\n          markup = props.markup,\n          resize = props.resize,\n          dirty = props.dirty;\n\n        clip.crop = crop;\n        clip.markup = markup;\n        clip.resize = resize;\n        clip.dirty = dirty;\n\n        // don't update clip layout\n        clip.opacity = shouldOptimize ? 0 : 1;\n\n        // don't re-render if optimizing or hidden (width will be zero resulting in weird animations)\n        if (shouldOptimize || root.rect.element.hidden) return;\n\n        // calculate scaled preview image size\n        var imageAspectRatio = image.height / image.width;\n        var aspectRatio = crop.aspectRatio || imageAspectRatio;\n\n        // calculate container size\n        var containerWidth = root.rect.inner.width;\n        var containerHeight = root.rect.inner.height;\n\n        var fixedPreviewHeight = root.query('GET_IMAGE_PREVIEW_HEIGHT');\n        var minPreviewHeight = root.query('GET_IMAGE_PREVIEW_MIN_HEIGHT');\n        var maxPreviewHeight = root.query('GET_IMAGE_PREVIEW_MAX_HEIGHT');\n\n        var panelAspectRatio = root.query('GET_PANEL_ASPECT_RATIO');\n        var allowMultiple = root.query('GET_ALLOW_MULTIPLE');\n\n        if (panelAspectRatio && !allowMultiple) {\n          fixedPreviewHeight = containerWidth * panelAspectRatio;\n          aspectRatio = panelAspectRatio;\n        }\n\n        // determine clip width and height\n        var clipHeight =\n          fixedPreviewHeight !== null\n            ? fixedPreviewHeight\n            : Math.max(\n                minPreviewHeight,\n                Math.min(containerWidth * aspectRatio, maxPreviewHeight)\n              );\n\n        var clipWidth = clipHeight / aspectRatio;\n        if (clipWidth > containerWidth) {\n          clipWidth = containerWidth;\n          clipHeight = clipWidth * aspectRatio;\n        }\n\n        if (clipHeight > containerHeight) {\n          clipHeight = containerHeight;\n          clipWidth = containerHeight / aspectRatio;\n        }\n\n        clip.width = clipWidth;\n        clip.height = clipHeight;\n      }\n    });\n  };\n\n  var SVG_MASK =\n    '<svg width=\"500\" height=\"200\" viewBox=\"0 0 500 200\" preserveAspectRatio=\"none\">\\n    <defs>\\n        <radialGradient id=\"gradient-__UID__\" cx=\".5\" cy=\"1.25\" r=\"1.15\">\\n            <stop offset=\\'50%\\' stop-color=\\'#000000\\'/>\\n            <stop offset=\\'56%\\' stop-color=\\'#0a0a0a\\'/>\\n            <stop offset=\\'63%\\' stop-color=\\'#262626\\'/>\\n            <stop offset=\\'69%\\' stop-color=\\'#4f4f4f\\'/>\\n            <stop offset=\\'75%\\' stop-color=\\'#808080\\'/>\\n            <stop offset=\\'81%\\' stop-color=\\'#b1b1b1\\'/>\\n            <stop offset=\\'88%\\' stop-color=\\'#dadada\\'/>\\n            <stop offset=\\'94%\\' stop-color=\\'#f6f6f6\\'/>\\n            <stop offset=\\'100%\\' stop-color=\\'#ffffff\\'/>\\n        </radialGradient>\\n        <mask id=\"mask-__UID__\">\\n            <rect x=\"0\" y=\"0\" width=\"500\" height=\"200\" fill=\"url(#gradient-__UID__)\"></rect>\\n        </mask>\\n    </defs>\\n    <rect x=\"0\" width=\"500\" height=\"200\" fill=\"currentColor\" mask=\"url(#mask-__UID__)\"></rect>\\n</svg>';\n\n  var SVGMaskUniqueId = 0;\n\n  var createImageOverlayView = function createImageOverlayView(fpAPI) {\n    return fpAPI.utils.createView({\n      name: 'image-preview-overlay',\n      tag: 'div',\n      ignoreRect: true,\n      create: function create(_ref) {\n        var root = _ref.root,\n          props = _ref.props;\n        var mask = SVG_MASK;\n        if (document.querySelector('base')) {\n          var url = new URL(\n            window.location.href.replace(window.location.hash, '')\n          ).href;\n          mask = mask.replace(/url\\(\\#/g, 'url(' + url + '#');\n        }\n\n        SVGMaskUniqueId++;\n        root.element.classList.add(\n          'filepond--image-preview-overlay-'.concat(props.status)\n        );\n\n        root.element.innerHTML = mask.replace(/__UID__/g, SVGMaskUniqueId);\n      },\n      mixins: {\n        styles: ['opacity'],\n        animations: {\n          opacity: { type: 'spring', mass: 25 }\n        }\n      }\n    });\n  };\n\n  /**\n   * Bitmap Worker\n   */\n  var BitmapWorker = function BitmapWorker() {\n    self.onmessage = function(e) {\n      createImageBitmap(e.data.message.file).then(function(bitmap) {\n        self.postMessage({ id: e.data.id, message: bitmap }, [bitmap]);\n      });\n    };\n  };\n\n  /**\n   * ColorMatrix Worker\n   */\n  var ColorMatrixWorker = function ColorMatrixWorker() {\n    self.onmessage = function(e) {\n      var imageData = e.data.message.imageData;\n      var matrix = e.data.message.colorMatrix;\n\n      var data = imageData.data;\n      var l = data.length;\n\n      var m11 = matrix[0];\n      var m12 = matrix[1];\n      var m13 = matrix[2];\n      var m14 = matrix[3];\n      var m15 = matrix[4];\n\n      var m21 = matrix[5];\n      var m22 = matrix[6];\n      var m23 = matrix[7];\n      var m24 = matrix[8];\n      var m25 = matrix[9];\n\n      var m31 = matrix[10];\n      var m32 = matrix[11];\n      var m33 = matrix[12];\n      var m34 = matrix[13];\n      var m35 = matrix[14];\n\n      var m41 = matrix[15];\n      var m42 = matrix[16];\n      var m43 = matrix[17];\n      var m44 = matrix[18];\n      var m45 = matrix[19];\n\n      var index = 0,\n        r = 0.0,\n        g = 0.0,\n        b = 0.0,\n        a = 0.0;\n\n      for (; index < l; index += 4) {\n        r = data[index] / 255;\n        g = data[index + 1] / 255;\n        b = data[index + 2] / 255;\n        a = data[index + 3] / 255;\n        data[index] = Math.max(\n          0,\n          Math.min((r * m11 + g * m12 + b * m13 + a * m14 + m15) * 255, 255)\n        );\n        data[index + 1] = Math.max(\n          0,\n          Math.min((r * m21 + g * m22 + b * m23 + a * m24 + m25) * 255, 255)\n        );\n        data[index + 2] = Math.max(\n          0,\n          Math.min((r * m31 + g * m32 + b * m33 + a * m34 + m35) * 255, 255)\n        );\n        data[index + 3] = Math.max(\n          0,\n          Math.min((r * m41 + g * m42 + b * m43 + a * m44 + m45) * 255, 255)\n        );\n      }\n\n      self.postMessage({ id: e.data.id, message: imageData }, [\n        imageData.data.buffer\n      ]);\n    };\n  };\n\n  var getImageSize = function getImageSize(url, cb) {\n    var image = new Image();\n    image.onload = function() {\n      var width = image.naturalWidth;\n      var height = image.naturalHeight;\n      image = null;\n      cb(width, height);\n    };\n    image.src = url;\n  };\n\n  var transforms = {\n    1: function _() {\n      return [1, 0, 0, 1, 0, 0];\n    },\n    2: function _(width) {\n      return [-1, 0, 0, 1, width, 0];\n    },\n    3: function _(width, height) {\n      return [-1, 0, 0, -1, width, height];\n    },\n    4: function _(width, height) {\n      return [1, 0, 0, -1, 0, height];\n    },\n    5: function _() {\n      return [0, 1, 1, 0, 0, 0];\n    },\n    6: function _(width, height) {\n      return [0, 1, -1, 0, height, 0];\n    },\n    7: function _(width, height) {\n      return [0, -1, -1, 0, height, width];\n    },\n    8: function _(width) {\n      return [0, -1, 1, 0, 0, width];\n    }\n  };\n\n  var fixImageOrientation = function fixImageOrientation(\n    ctx,\n    width,\n    height,\n    orientation\n  ) {\n    // no orientation supplied\n    if (orientation === -1) {\n      return;\n    }\n\n    ctx.transform.apply(ctx, transforms[orientation](width, height));\n  };\n\n  // draws the preview image to canvas\n  var createPreviewImage = function createPreviewImage(\n    data,\n    width,\n    height,\n    orientation\n  ) {\n    // can't draw on half pixels\n    width = Math.round(width);\n    height = Math.round(height);\n\n    // draw image\n    var canvas = document.createElement('canvas');\n    canvas.width = width;\n    canvas.height = height;\n    var ctx = canvas.getContext('2d');\n\n    // if is rotated incorrectly swap width and height\n    if (orientation >= 5 && orientation <= 8) {\n      var _ref = [height, width];\n      width = _ref[0];\n      height = _ref[1];\n    }\n\n    // correct image orientation\n    fixImageOrientation(ctx, width, height, orientation);\n\n    // draw the image\n    ctx.drawImage(data, 0, 0, width, height);\n\n    return canvas;\n  };\n\n  var isBitmap = function isBitmap(file) {\n    return /^image/.test(file.type) && !/svg/.test(file.type);\n  };\n\n  var MAX_WIDTH = 10;\n  var MAX_HEIGHT = 10;\n\n  var calculateAverageColor = function calculateAverageColor(image) {\n    var scalar = Math.min(MAX_WIDTH / image.width, MAX_HEIGHT / image.height);\n\n    var canvas = document.createElement('canvas');\n    var ctx = canvas.getContext('2d');\n    var width = (canvas.width = Math.ceil(image.width * scalar));\n    var height = (canvas.height = Math.ceil(image.height * scalar));\n    ctx.drawImage(image, 0, 0, width, height);\n    var data = null;\n    try {\n      data = ctx.getImageData(0, 0, width, height).data;\n    } catch (e) {\n      return null;\n    }\n    var l = data.length;\n\n    var r = 0;\n    var g = 0;\n    var b = 0;\n    var i = 0;\n\n    for (; i < l; i += 4) {\n      r += data[i] * data[i];\n      g += data[i + 1] * data[i + 1];\n      b += data[i + 2] * data[i + 2];\n    }\n\n    r = averageColor(r, l);\n    g = averageColor(g, l);\n    b = averageColor(b, l);\n\n    return { r: r, g: g, b: b };\n  };\n\n  var averageColor = function averageColor(c, l) {\n    return Math.floor(Math.sqrt(c / (l / 4)));\n  };\n\n  var cloneCanvas = function cloneCanvas(origin, target) {\n    target = target || document.createElement('canvas');\n    target.width = origin.width;\n    target.height = origin.height;\n    var ctx = target.getContext('2d');\n    ctx.drawImage(origin, 0, 0);\n    return target;\n  };\n\n  var cloneImageData = function cloneImageData(imageData) {\n    var id;\n    try {\n      id = new ImageData(imageData.width, imageData.height);\n    } catch (e) {\n      var canvas = document.createElement('canvas');\n      var ctx = canvas.getContext('2d');\n      id = ctx.createImageData(imageData.width, imageData.height);\n    }\n    id.data.set(new Uint8ClampedArray(imageData.data));\n    return id;\n  };\n\n  var loadImage = function loadImage(url) {\n    return new Promise(function(resolve, reject) {\n      var img = new Image();\n      img.crossOrigin = 'Anonymous';\n      img.onload = function() {\n        resolve(img);\n      };\n      img.onerror = function(e) {\n        reject(e);\n      };\n      img.src = url;\n    });\n  };\n\n  var createImageWrapperView = function createImageWrapperView(_) {\n    // create overlay view\n    var OverlayView = createImageOverlayView(_);\n\n    var ImageView = createImageView(_);\n    var createWorker = _.utils.createWorker;\n\n    var applyFilter = function applyFilter(root, filter, target) {\n      return new Promise(function(resolve) {\n        // will store image data for future filter updates\n        if (!root.ref.imageData) {\n          root.ref.imageData = target\n            .getContext('2d')\n            .getImageData(0, 0, target.width, target.height);\n        }\n\n        // get image data reference\n        var imageData = cloneImageData(root.ref.imageData);\n\n        if (!filter || filter.length !== 20) {\n          target.getContext('2d').putImageData(imageData, 0, 0);\n          return resolve();\n        }\n\n        var worker = createWorker(ColorMatrixWorker);\n        worker.post(\n          {\n            imageData: imageData,\n            colorMatrix: filter\n          },\n\n          function(response) {\n            // apply filtered colors\n            target.getContext('2d').putImageData(response, 0, 0);\n\n            // stop worker\n            worker.terminate();\n\n            // done!\n            resolve();\n          },\n          [imageData.data.buffer]\n        );\n      });\n    };\n\n    var removeImageView = function removeImageView(root, imageView) {\n      root.removeChildView(imageView);\n      imageView.image.width = 1;\n      imageView.image.height = 1;\n      imageView._destroy();\n    };\n\n    // remove an image\n    var shiftImage = function shiftImage(_ref) {\n      var root = _ref.root;\n      var imageView = root.ref.images.shift();\n      imageView.opacity = 0;\n      imageView.translateY = -15;\n      root.ref.imageViewBin.push(imageView);\n      return imageView;\n    };\n\n    // add new image\n    var pushImage = function pushImage(_ref2) {\n      var root = _ref2.root,\n        props = _ref2.props,\n        image = _ref2.image;\n      var id = props.id;\n      var item = root.query('GET_ITEM', { id: id });\n      if (!item) return;\n\n      var crop = item.getMetadata('crop') || {\n        center: {\n          x: 0.5,\n          y: 0.5\n        },\n\n        flip: {\n          horizontal: false,\n          vertical: false\n        },\n\n        zoom: 1,\n        rotation: 0,\n        aspectRatio: null\n      };\n\n      var background = root.query(\n        'GET_IMAGE_TRANSFORM_CANVAS_BACKGROUND_COLOR'\n      );\n\n      var markup;\n      var resize;\n      var dirty = false;\n      if (root.query('GET_IMAGE_PREVIEW_MARKUP_SHOW')) {\n        markup = item.getMetadata('markup') || [];\n        resize = item.getMetadata('resize');\n        dirty = true;\n      }\n\n      // append image presenter\n      var imageView = root.appendChildView(\n        root.createChildView(ImageView, {\n          id: id,\n          image: image,\n          crop: crop,\n          resize: resize,\n          markup: markup,\n          dirty: dirty,\n          background: background,\n          opacity: 0,\n          scaleX: 1.15,\n          scaleY: 1.15,\n          translateY: 15\n        }),\n\n        root.childViews.length\n      );\n\n      root.ref.images.push(imageView);\n\n      // reveal the preview image\n      imageView.opacity = 1;\n      imageView.scaleX = 1;\n      imageView.scaleY = 1;\n      imageView.translateY = 0;\n\n      // the preview is now ready to be drawn\n      setTimeout(function() {\n        root.dispatch('DID_IMAGE_PREVIEW_SHOW', { id: id });\n      }, 250);\n    };\n\n    var updateImage = function updateImage(_ref3) {\n      var root = _ref3.root,\n        props = _ref3.props;\n      var item = root.query('GET_ITEM', { id: props.id });\n      if (!item) return;\n      var imageView = root.ref.images[root.ref.images.length - 1];\n      imageView.crop = item.getMetadata('crop');\n      imageView.background = root.query(\n        'GET_IMAGE_TRANSFORM_CANVAS_BACKGROUND_COLOR'\n      );\n\n      if (root.query('GET_IMAGE_PREVIEW_MARKUP_SHOW')) {\n        imageView.dirty = true;\n        imageView.resize = item.getMetadata('resize');\n        imageView.markup = item.getMetadata('markup');\n      }\n    };\n\n    // replace image preview\n    var didUpdateItemMetadata = function didUpdateItemMetadata(_ref4) {\n      var root = _ref4.root,\n        props = _ref4.props,\n        action = _ref4.action;\n      // only filter and crop trigger redraw\n      if (!/crop|filter|markup|resize/.test(action.change.key)) return;\n\n      // no images to update, exit\n      if (!root.ref.images.length) return;\n\n      // no item found, exit\n      var item = root.query('GET_ITEM', { id: props.id });\n      if (!item) return;\n\n      // for now, update existing image when filtering\n      if (/filter/.test(action.change.key)) {\n        var imageView = root.ref.images[root.ref.images.length - 1];\n        applyFilter(root, action.change.value, imageView.image);\n        return;\n      }\n\n      if (/crop|markup|resize/.test(action.change.key)) {\n        var crop = item.getMetadata('crop');\n        var image = root.ref.images[root.ref.images.length - 1];\n\n        // if aspect ratio has changed, we need to create a new image\n        if (\n          crop &&\n          crop.aspectRatio &&\n          image.crop &&\n          image.crop.aspectRatio &&\n          Math.abs(crop.aspectRatio - image.crop.aspectRatio) > 0.00001\n        ) {\n          var _imageView = shiftImage({ root: root });\n          pushImage({\n            root: root,\n            props: props,\n            image: cloneCanvas(_imageView.image)\n          });\n        }\n        // if not, we can update the current image\n        else {\n          updateImage({ root: root, props: props });\n        }\n      }\n    };\n\n    var canCreateImageBitmap = function canCreateImageBitmap(file) {\n      // Firefox versions before 58 will freeze when running createImageBitmap\n      // in a Web Worker so we detect those versions and return false for support\n      var userAgent = window.navigator.userAgent;\n      var isFirefox = userAgent.match(/Firefox\\/([0-9]+)\\./);\n      var firefoxVersion = isFirefox ? parseInt(isFirefox[1]) : null;\n      if (firefoxVersion <= 58) return false;\n\n      return 'createImageBitmap' in window && isBitmap(file);\n    };\n\n    /**\n     * Write handler for when preview container has been created\n     */\n    var didCreatePreviewContainer = function didCreatePreviewContainer(_ref5) {\n      var root = _ref5.root,\n        props = _ref5.props;\n      var id = props.id;\n\n      // we need to get the file data to determine the eventual image size\n      var item = root.query('GET_ITEM', id);\n      if (!item) return;\n\n      // get url to file (we'll revoke it later on when done)\n      var fileURL = URL.createObjectURL(item.file);\n\n      // determine image size of this item\n      getImageSize(fileURL, function(width, height) {\n        // we can now scale the panel to the final size\n        root.dispatch('DID_IMAGE_PREVIEW_CALCULATE_SIZE', {\n          id: id,\n          width: width,\n          height: height\n        });\n      });\n    };\n\n    var drawPreview = function drawPreview(_ref6) {\n      var root = _ref6.root,\n        props = _ref6.props;\n      var id = props.id;\n\n      // we need to get the file data to determine the eventual image size\n      var item = root.query('GET_ITEM', id);\n      if (!item) return;\n\n      // get url to file (we'll revoke it later on when done)\n      var fileURL = URL.createObjectURL(item.file);\n\n      // fallback\n      var loadPreviewFallback = function loadPreviewFallback() {\n        // let's scale the image in the main thread :(\n        loadImage(fileURL).then(previewImageLoaded);\n      };\n\n      // image is now ready\n      var previewImageLoaded = function previewImageLoaded(imageData) {\n        // the file url is no longer needed\n        URL.revokeObjectURL(fileURL);\n\n        // draw the scaled down version here and use that as source so bitmapdata can be closed\n        // orientation info\n        var exif = item.getMetadata('exif') || {};\n        var orientation = exif.orientation || -1;\n\n        // get width and height from action, and swap if orientation is incorrect\n        var width = imageData.width,\n          height = imageData.height;\n\n        // if no width or height, just return early.\n        if (!width || !height) return;\n\n        if (orientation >= 5 && orientation <= 8) {\n          var _ref7 = [height, width];\n          width = _ref7[0];\n          height = _ref7[1];\n        }\n\n        // scale canvas based on pixel density\n        // we multiply by .75 as that creates smaller but still clear images on screens with high res displays\n        var pixelDensityFactor = Math.max(1, window.devicePixelRatio * 0.75);\n\n        // we want as much pixels to work with as possible,\n        // this multiplies the minimum image resolution,\n        // so when zooming in it doesn't get too blurry\n        var zoomFactor = root.query('GET_IMAGE_PREVIEW_ZOOM_FACTOR');\n\n        // imaeg scale factor\n        var scaleFactor = zoomFactor * pixelDensityFactor;\n\n        // calculate scaled preview image size\n        var previewImageRatio = height / width;\n\n        // calculate image preview height and width\n        var previewContainerWidth = root.rect.element.width;\n        var previewContainerHeight = root.rect.element.height;\n\n        var imageWidth = previewContainerWidth;\n        var imageHeight = imageWidth * previewImageRatio;\n\n        if (previewImageRatio > 1) {\n          imageWidth = Math.min(width, previewContainerWidth * scaleFactor);\n          imageHeight = imageWidth * previewImageRatio;\n        } else {\n          imageHeight = Math.min(height, previewContainerHeight * scaleFactor);\n          imageWidth = imageHeight / previewImageRatio;\n        }\n\n        // transfer to image tag so no canvas memory wasted on iOS\n        var previewImage = createPreviewImage(\n          imageData,\n          imageWidth,\n          imageHeight,\n          orientation\n        );\n\n        // done\n        var done = function done() {\n          // calculate average image color, disabled for now\n          var averageColor = root.query(\n            'GET_IMAGE_PREVIEW_CALCULATE_AVERAGE_IMAGE_COLOR'\n          )\n            ? calculateAverageColor(data)\n            : null;\n          item.setMetadata('color', averageColor, true);\n\n          // data has been transferred to canvas ( if was ImageBitmap )\n          if ('close' in imageData) {\n            imageData.close();\n          }\n\n          // show the overlay\n          root.ref.overlayShadow.opacity = 1;\n\n          // create the first image\n          pushImage({ root: root, props: props, image: previewImage });\n        };\n\n        // apply filter\n        var filter = item.getMetadata('filter');\n        if (filter) {\n          applyFilter(root, filter, previewImage).then(done);\n        } else {\n          done();\n        }\n      };\n\n      // if we support scaling using createImageBitmap we use a worker\n      if (canCreateImageBitmap(item.file)) {\n        // let's scale the image in a worker\n        var worker = createWorker(BitmapWorker);\n\n        worker.post(\n          {\n            file: item.file\n          },\n\n          function(imageBitmap) {\n            // destroy worker\n            worker.terminate();\n\n            // no bitmap returned, must be something wrong,\n            // try the oldschool way\n            if (!imageBitmap) {\n              loadPreviewFallback();\n              return;\n            }\n\n            // yay we got our bitmap, let's continue showing the preview\n            previewImageLoaded(imageBitmap);\n          }\n        );\n      } else {\n        // create fallback preview\n        loadPreviewFallback();\n      }\n    };\n\n    /**\n     * Write handler for when the preview image is ready to be animated\n     */\n    var didDrawPreview = function didDrawPreview(_ref8) {\n      var root = _ref8.root;\n      // get last added image\n      var image = root.ref.images[root.ref.images.length - 1];\n      image.translateY = 0;\n      image.scaleX = 1.0;\n      image.scaleY = 1.0;\n      image.opacity = 1;\n    };\n\n    /**\n     * Write handler for when the preview has been loaded\n     */\n    var restoreOverlay = function restoreOverlay(_ref9) {\n      var root = _ref9.root;\n      root.ref.overlayShadow.opacity = 1;\n      root.ref.overlayError.opacity = 0;\n      root.ref.overlaySuccess.opacity = 0;\n    };\n\n    var didThrowError = function didThrowError(_ref10) {\n      var root = _ref10.root;\n      root.ref.overlayShadow.opacity = 0.25;\n      root.ref.overlayError.opacity = 1;\n    };\n\n    var didCompleteProcessing = function didCompleteProcessing(_ref11) {\n      var root = _ref11.root;\n      root.ref.overlayShadow.opacity = 0.25;\n      root.ref.overlaySuccess.opacity = 1;\n    };\n\n    /**\n     * Constructor\n     */\n    var create = function create(_ref12) {\n      var root = _ref12.root;\n      // image view\n      root.ref.images = [];\n\n      // the preview image data (we need this to filter the image)\n      root.ref.imageData = null;\n\n      // image bin\n      root.ref.imageViewBin = [];\n\n      // image overlays\n      root.ref.overlayShadow = root.appendChildView(\n        root.createChildView(OverlayView, {\n          opacity: 0,\n          status: 'idle'\n        })\n      );\n\n      root.ref.overlaySuccess = root.appendChildView(\n        root.createChildView(OverlayView, {\n          opacity: 0,\n          status: 'success'\n        })\n      );\n\n      root.ref.overlayError = root.appendChildView(\n        root.createChildView(OverlayView, {\n          opacity: 0,\n          status: 'failure'\n        })\n      );\n    };\n\n    return _.utils.createView({\n      name: 'image-preview-wrapper',\n      create: create,\n      styles: ['height'],\n      apis: ['height'],\n      destroy: function destroy(_ref13) {\n        var root = _ref13.root;\n        // we resize the image so memory on iOS 12 is released more quickly (it seems)\n        root.ref.images.forEach(function(imageView) {\n          imageView.image.width = 1;\n          imageView.image.height = 1;\n        });\n      },\n      didWriteView: function didWriteView(_ref14) {\n        var root = _ref14.root;\n        root.ref.images.forEach(function(imageView) {\n          imageView.dirty = false;\n        });\n      },\n      write: _.utils.createRoute(\n        {\n          // image preview stated\n          DID_IMAGE_PREVIEW_DRAW: didDrawPreview,\n          DID_IMAGE_PREVIEW_CONTAINER_CREATE: didCreatePreviewContainer,\n          DID_FINISH_CALCULATE_PREVIEWSIZE: drawPreview,\n          DID_UPDATE_ITEM_METADATA: didUpdateItemMetadata,\n\n          // file states\n          DID_THROW_ITEM_LOAD_ERROR: didThrowError,\n          DID_THROW_ITEM_PROCESSING_ERROR: didThrowError,\n          DID_THROW_ITEM_INVALID: didThrowError,\n          DID_COMPLETE_ITEM_PROCESSING: didCompleteProcessing,\n          DID_START_ITEM_PROCESSING: restoreOverlay,\n          DID_REVERT_ITEM_PROCESSING: restoreOverlay\n        },\n\n        function(_ref15) {\n          var root = _ref15.root;\n          // views on death row\n          var viewsToRemove = root.ref.imageViewBin.filter(function(imageView) {\n            return imageView.opacity === 0;\n          });\n\n          // views to retain\n          root.ref.imageViewBin = root.ref.imageViewBin.filter(function(\n            imageView\n          ) {\n            return imageView.opacity > 0;\n          });\n\n          // remove these views\n          viewsToRemove.forEach(function(imageView) {\n            return removeImageView(root, imageView);\n          });\n          viewsToRemove.length = 0;\n        }\n      )\n    });\n  };\n\n  /**\n   * Image Preview Plugin\n   */\n  var plugin = function plugin(fpAPI) {\n    var addFilter = fpAPI.addFilter,\n      utils = fpAPI.utils;\n    var Type = utils.Type,\n      createRoute = utils.createRoute,\n      isFile = utils.isFile;\n\n    // imagePreviewView\n    var imagePreviewView = createImageWrapperView(fpAPI);\n\n    // called for each view that is created right after the 'create' method\n    addFilter('CREATE_VIEW', function(viewAPI) {\n      // get reference to created view\n      var is = viewAPI.is,\n        view = viewAPI.view,\n        query = viewAPI.query;\n\n      // only hook up to item view and only if is enabled for this cropper\n      if (!is('file') || !query('GET_ALLOW_IMAGE_PREVIEW')) return;\n\n      // create the image preview plugin, but only do so if the item is an image\n      var didLoadItem = function didLoadItem(_ref) {\n        var root = _ref.root,\n          props = _ref.props;\n        var id = props.id;\n        var item = query('GET_ITEM', id);\n\n        // item could theoretically have been removed in the mean time\n        if (!item || !isFile(item.file) || item.archived) return;\n\n        // get the file object\n        var file = item.file;\n\n        // exit if this is not an image\n        if (!isPreviewableImage(file)) return;\n\n        // test if is filtered\n        if (!query('GET_IMAGE_PREVIEW_FILTER_ITEM')(item)) return;\n\n        // exit if image size is too high and no createImageBitmap support\n        // this would simply bring the browser to its knees and that is not what we want\n        var supportsCreateImageBitmap = 'createImageBitmap' in (window || {});\n        var maxPreviewFileSize = query('GET_IMAGE_PREVIEW_MAX_FILE_SIZE');\n        if (\n          !supportsCreateImageBitmap &&\n          maxPreviewFileSize &&\n          file.size > maxPreviewFileSize\n        )\n          return;\n\n        // set preview view\n        root.ref.imagePreview = view.appendChildView(\n          view.createChildView(imagePreviewView, { id: id })\n        );\n\n        // update height if is fixed\n        var fixedPreviewHeight = root.query('GET_IMAGE_PREVIEW_HEIGHT');\n        if (fixedPreviewHeight) {\n          root.dispatch('DID_UPDATE_PANEL_HEIGHT', {\n            id: item.id,\n            height: fixedPreviewHeight\n          });\n        }\n\n        // now ready\n        var queue =\n          !supportsCreateImageBitmap &&\n          file.size > query('GET_IMAGE_PREVIEW_MAX_INSTANT_PREVIEW_FILE_SIZE');\n        root.dispatch('DID_IMAGE_PREVIEW_CONTAINER_CREATE', { id: id }, queue);\n      };\n\n      var rescaleItem = function rescaleItem(root, props) {\n        if (!root.ref.imagePreview) return;\n        var id = props.id;\n\n        // get item\n        var item = root.query('GET_ITEM', { id: id });\n        if (!item) return;\n\n        // if is fixed height or panel has aspect ratio, exit here, height has already been defined\n        var panelAspectRatio = root.query('GET_PANEL_ASPECT_RATIO');\n        var itemPanelAspectRatio = root.query('GET_ITEM_PANEL_ASPECT_RATIO');\n        var fixedHeight = root.query('GET_IMAGE_PREVIEW_HEIGHT');\n        if (panelAspectRatio || itemPanelAspectRatio || fixedHeight) return;\n\n        // no data!\n        var _root$ref = root.ref,\n          imageWidth = _root$ref.imageWidth,\n          imageHeight = _root$ref.imageHeight;\n        if (!imageWidth || !imageHeight) return;\n\n        // get height min and max\n        var minPreviewHeight = root.query('GET_IMAGE_PREVIEW_MIN_HEIGHT');\n        var maxPreviewHeight = root.query('GET_IMAGE_PREVIEW_MAX_HEIGHT');\n\n        // orientation info\n        var exif = item.getMetadata('exif') || {};\n        var orientation = exif.orientation || -1;\n\n        // get width and height from action, and swap of orientation is incorrect\n        if (orientation >= 5 && orientation <= 8) {\n          var _ref2 = [imageHeight, imageWidth];\n          imageWidth = _ref2[0];\n          imageHeight = _ref2[1];\n        }\n\n        // scale up width and height when we're dealing with an SVG\n        if (!isBitmap(item.file) || root.query('GET_IMAGE_PREVIEW_UPSCALE')) {\n          var scalar = 2048 / imageWidth;\n          imageWidth *= scalar;\n          imageHeight *= scalar;\n        }\n\n        // image aspect ratio\n        var imageAspectRatio = imageHeight / imageWidth;\n\n        // we need the item to get to the crop size\n        var previewAspectRatio =\n          (item.getMetadata('crop') || {}).aspectRatio || imageAspectRatio;\n\n        // preview height range\n        var previewHeightMax = Math.max(\n          minPreviewHeight,\n          Math.min(imageHeight, maxPreviewHeight)\n        );\n\n        var itemWidth = root.rect.element.width;\n        var previewHeight = Math.min(\n          itemWidth * previewAspectRatio,\n          previewHeightMax\n        );\n\n        // request update to panel height\n        root.dispatch('DID_UPDATE_PANEL_HEIGHT', {\n          id: item.id,\n          height: previewHeight\n        });\n      };\n\n      var didResizeView = function didResizeView(_ref3) {\n        var root = _ref3.root;\n        // actions in next write operation\n        root.ref.shouldRescale = true;\n      };\n\n      var didUpdateItemMetadata = function didUpdateItemMetadata(_ref4) {\n        var root = _ref4.root,\n          action = _ref4.action;\n        if (action.change.key !== 'crop') return;\n\n        // actions in next write operation\n        root.ref.shouldRescale = true;\n      };\n\n      var didCalculatePreviewSize = function didCalculatePreviewSize(_ref5) {\n        var root = _ref5.root,\n          action = _ref5.action;\n        // remember dimensions\n        root.ref.imageWidth = action.width;\n        root.ref.imageHeight = action.height;\n\n        // actions in next write operation\n        root.ref.shouldRescale = true;\n        root.ref.shouldDrawPreview = true;\n\n        // as image load could take a while and fire when draw loop is resting we need to give it a kick\n        root.dispatch('KICK');\n      };\n\n      // start writing\n      view.registerWriter(\n        createRoute(\n          {\n            DID_RESIZE_ROOT: didResizeView,\n            DID_STOP_RESIZE: didResizeView,\n            DID_LOAD_ITEM: didLoadItem,\n            DID_IMAGE_PREVIEW_CALCULATE_SIZE: didCalculatePreviewSize,\n            DID_UPDATE_ITEM_METADATA: didUpdateItemMetadata\n          },\n\n          function(_ref6) {\n            var root = _ref6.root,\n              props = _ref6.props;\n            // no preview view attached\n            if (!root.ref.imagePreview) return;\n\n            // don't do anything while hidden\n            if (root.rect.element.hidden) return;\n\n            // resize the item panel\n            if (root.ref.shouldRescale) {\n              rescaleItem(root, props);\n              root.ref.shouldRescale = false;\n            }\n\n            if (root.ref.shouldDrawPreview) {\n              // queue till next frame so we're sure the height has been applied this forces the draw image call inside the wrapper view to use the correct height\n              requestAnimationFrame(function() {\n                // this requestAnimationFrame nesting is horrible but it fixes an issue with 100hz displays on Chrome\n                // https://github.com/pqina/filepond-plugin-image-preview/issues/57\n                requestAnimationFrame(function() {\n                  root.dispatch('DID_FINISH_CALCULATE_PREVIEWSIZE', {\n                    id: props.id\n                  });\n                });\n              });\n\n              root.ref.shouldDrawPreview = false;\n            }\n          }\n        )\n      );\n    });\n\n    // expose plugin\n    return {\n      options: {\n        // Enable or disable image preview\n        allowImagePreview: [true, Type.BOOLEAN],\n\n        // filters file items to determine which are shown as preview\n        imagePreviewFilterItem: [\n          function() {\n            return true;\n          },\n          Type.FUNCTION\n        ],\n\n        // Fixed preview height\n        imagePreviewHeight: [null, Type.INT],\n\n        // Min image height\n        imagePreviewMinHeight: [44, Type.INT],\n\n        // Max image height\n        imagePreviewMaxHeight: [256, Type.INT],\n\n        // Max size of preview file for when createImageBitmap is not supported\n        imagePreviewMaxFileSize: [null, Type.INT],\n\n        // The amount of extra pixels added to the image preview to allow comfortable zooming\n        imagePreviewZoomFactor: [2, Type.INT],\n\n        // Should we upscale small images to fit the max bounding box of the preview area\n        imagePreviewUpscale: [false, Type.BOOLEAN],\n\n        // Max size of preview file that we allow to try to instant preview if createImageBitmap is not supported, else image is queued for loading\n        imagePreviewMaxInstantPreviewFileSize: [1000000, Type.INT],\n\n        // Style of the transparancy indicator used behind images\n        imagePreviewTransparencyIndicator: [null, Type.STRING],\n\n        // Enables or disables reading average image color\n        imagePreviewCalculateAverageImageColor: [false, Type.BOOLEAN],\n\n        // Enables or disables the previewing of markup\n        imagePreviewMarkupShow: [true, Type.BOOLEAN],\n\n        // Allows filtering of markup to only show certain shapes\n        imagePreviewMarkupFilter: [\n          function() {\n            return true;\n          },\n          Type.FUNCTION\n        ]\n      }\n    };\n  };\n\n  // fire pluginloaded event if running in browser, this allows registering the plugin when using async script tags\n  var isBrowser =\n    typeof window !== 'undefined' && typeof window.document !== 'undefined';\n  if (isBrowser) {\n    document.dispatchEvent(\n      new CustomEvent('FilePond:pluginloaded', { detail: plugin })\n    );\n  }\n\n  return plugin;\n});\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}